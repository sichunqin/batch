{
	"action":[
		{
			"code":"saveManuscriptitem",
			"name":"分配纸质底稿存放地",
			"property":[
				{
					"isHide":false,
					"name":"AuthorityRemark",
					"value":"分配纸质底稿存放地"
				},
				{
					"isHide":false,
					"name":"OnClick",
					"value":"openPanel"
				},
				{
					"isHide":false,
					"name":"JavaScript",
					"value":"var registerJavaScript = function () {

 


this.openPanel=function(){
console.log("k")
    var model =this.Top().DownForCode('alreadyArchiveQuery').GetSelections();
    if(model.length>0){
        var parameter = {};
        var url = "UIForm-Web-Schema.json";
        parameter.schemaType = "Panel";
        parameter.schemaCode = "ArchiveAddressPanel";
        Framework.OpenForm(me, url, parameter, function (form) {
            form.archive = model.mid;
            if (form.Load) form.Load(me.selected);
        })
    }else{
        Framework.Message("请选择数据")
    }
}

 

};"
				}
			],
			"sort":0
		}
	],
	"authority":[
		
	],
	"children":[
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"code",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"档案号",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"IsRenderLink",
							"value":"true"
						},
						{
							"isHide":false,
							"name":"Width",
							"value":"160"
						}
					],
					"sort":3
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"bookNumber",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"总盒数",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"60"
						},
						{
							"isHide":false,
							"name":"halign",
							"value":"center"
						},
						{
							"isHide":false,
							"name":"align",
							"value":"right"
						}
					],
					"sort":4
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"boxNumber",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"总册数",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"60"
						},
						{
							"isHide":false,
							"name":"align",
							"value":"right"
						},
						{
							"isHide":false,
							"name":"halign",
							"value":"center"
						}
					],
					"sort":5
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"deptname",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"部门",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"160"
						}
					],
					"sort":6
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"archiveDate",
					"control":"Date",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"归档时间",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"120"
						}
					],
					"sort":7
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"depositAddress",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"纸质底稿存放地",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"140"
						}
					],
					"sort":8
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"compostionCode",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"项目编号",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"160"
						}
					],
					"sort":9
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"compostionName",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"项目名称",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"400"
						},
						{
							"isHide":false,
							"name":"align",
							"value":"left"
						}
					],
					"sort":10
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"customerTypeValue",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"客户类型",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"300"
						},
						{
							"isHide":false,
							"name":"align",
							"value":"left"
						}
					],
					"sort":11
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"businessTypeValue",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"业务类型",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"160"
						}
					],
					"sort":12
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"auditStart",
					"control":"Date",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"审计开始日",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"100"
						}
					],
					"sort":13
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"auditEnd",
					"control":"Date",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"审计结束日",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"100"
						}
					],
					"sort":14
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"signingPartnerId",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"签字合伙人",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"100"
						}
					],
					"sort":15
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"signingAccountantId",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"签字会计师",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"100"
						}
					],
					"sort":16
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"signingAccountantOtherId",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"签字会计师(备选)",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"140"
						}
					],
					"sort":17
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"reportIssueValue",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"出具报告类型",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"120"
						}
					],
					"sort":18
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"mid",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"归档id",
					"otherChildren":[
						
					],
					"property":[
						
					],
					"sort":2
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"compostionCustomerId",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"被审计单位Id",
					"otherChildren":[
						
					],
					"property":[
						
					],
					"sort":1
				}
			],
			"code":"columnGroup",
			"control":"ColumnGroup",
			"dataPermission":[
				
			],
			"isReference":false,
			"javaScript":"",
			"name":"table",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":0
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"uuid",
			"control":"Hidden",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"uuid",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":1000
		}
	],
	"code":"alreadyArchiveQuery",
	"control":"GridPanel",
	"dataPermission":[
		{
			"authorityRemark":"已归档-单位管理范围",
			"code":"已归档-单位管理范围",
			"dataPermissionType":20,
			"entityAttribute":"deptId",
			"filterValueType":30,
			"isUserHide":false
		}
	],
	"isReference":false,
	"javaScript":"this.OpenLinkForm = function (row) {
        var parameter = {};
        var url = "UIForm-Web-Schema.json";
        parameter.schemaType = "FormPanel";
        parameter.schemaCode = "ManuscriptItemArchivesInfoShow";
        Framework.OpenForm(me, url, parameter, function (form) {
            if (form.Load) form.Load();
        })
    
};",
	"name":"已归档",
	"otherChildren":[
		
	],
	"property":[
		{
			"isHide":false,
			"name":"BaseCode",
			"value":"alreadyArchiveQuery"
		},
		{
			"isHide":false,
			"name":"Name",
			"value":"已归档"
		},
		{
			"isHide":false,
			"name":"IsReadOnly",
			"value":false
		},
		{
			"isHide":false,
			"name":"Description"
		},
		{
			"isHide":false,
			"name":"FormId",
			"value":342836
		},
		{
			"isHide":false,
			"name":"OrderBy"
		},
		{
			"isHide":false,
			"name":"IsSqlForm",
			"value":true
		},
		{
			"isHide":false,
			"name":"JavaScript",
			"value":"var registerJavaScript = function () {

 

this.OpenLinkForm = function (row) {
        var parameter = {};
        var url = "UIForm-Web-Schema.json";
        parameter.schemaType = "FormPanel";
        parameter.schemaCode = "ManuscriptItemArchivesInfoShow";
        Framework.OpenForm(me, url, parameter, function (form) {
            if (form.Load) form.Load();
        })
    
};

 

};"
		}
	],
	"sort":0,
	"sql":"
select m.id as mid,c.id as compostionCustomerId,m.code as code,m.bookNumber as bookNumber,m.boxNumber as
  boxNumber,d.name as deptname,
m.archiveDate as archiveDate,m.depositAddress as depositAddress,c.code as compostionCode,
c.showName as compostionName,c.customerTypeValue as customerTypeValue ,c.businessTypeValue as businessTypeValue,
c.auditStart as auditStart,c.auditEnd as auditEnd,
(select name from Base_User where id in(select top 1 SigningPartnerId from PM_Report where compositionCustomerId=c.id order by createdOn asc))as SigningPartnerId,
(select name from Base_User where id in(select top 1 SigningAccountantId from PM_Report where compositionCustomerId=c.id order by createdOn asc))as SigningAccountantId,
(select name from Base_User where id in(select top 1 SigningAccountantOtherId from PM_Report where compositionCustomerId=c.id order by createdOn asc))as SigningAccountantOtherId,

(select top 1 ReportIssueValue from PM_Report where compositionCustomerId=c.id order by createdOn asc) as ReportIssueValue

from Prj_ComprositionCustome as c 
inner join Prj_ManuScirptItemArchive m
on c.id = m.compostionCustomerId
inner join Prj_Project as p
on p.id=c.projectId
inner join Base_Department as d
on p.deptId=d.id


",
	"whereSql":"where 
c.projectId in(
select id from Prj_Project where deptId in (

\tselect id from Base_Department where archivistId=#AppContext.Profile.Id#
\tunion
\tselect id from Base_Department where parentId in 
\t(
\t\tselect id from Base_Department where archivistId=#AppContext.Profile.Id#
\t)
)
)  
and   p.docstate=70 and DATEADD(YY,10,m.archiveDate)>=GETDATE()"
}
{"action":[{"code":"saveManuscriptitem","name":"分配纸质底稿存放地","property":[{"isHide":false,"name":"AuthorityRemark","value":"分配纸质底稿存放地"},{"isHide":false,"name":"OnClick","value":"openPanel"},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\n\nthis.openPanel=function(){\nconsole.log(&quot;k&quot;)\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;model&nbsp;=this.Top().DownForCode('alreadyArchiveQuery').GetSelections();\n&nbsp;&nbsp;&nbsp;&nbsp;if(model.length&gt;0){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;UIForm-Web-Schema.json&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaType&nbsp;=&nbsp;&quot;Panel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaCode&nbsp;=&nbsp;&quot;ArchiveAddressPanel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.OpenForm(me,&nbsp;url,&nbsp;parameter,&nbsp;function&nbsp;(form)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.archive&nbsp;=&nbsp;model.mid;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(form.Load)&nbsp;form.Load(me.selected);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})\n&nbsp;&nbsp;&nbsp;&nbsp;}else{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;请选择数据&quot;)\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}\r\n \r\n};"}],"sort":0}],"authority":[],"children":[{"action":[],"authority":[],"children":[{"action":[],"authority":[],"children":[],"code":"code","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"档案号","otherChildren":[],"property":[{"isHide":false,"name":"IsRenderLink","value":"true"},{"isHide":false,"name":"Width","value":"160"}],"sort":3},{"action":[],"authority":[],"children":[],"code":"bookNumber","control":"Text","dataPermission":[],"isReference":false,"name":"总盒数","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"60"},{"isHide":false,"name":"halign","value":"center"},{"isHide":false,"name":"align","value":"right"}],"sort":4},{"action":[],"authority":[],"children":[],"code":"boxNumber","control":"Text","dataPermission":[],"isReference":false,"name":"总册数","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"60"},{"isHide":false,"name":"align","value":"right"},{"isHide":false,"name":"halign","value":"center"}],"sort":5},{"action":[],"authority":[],"children":[],"code":"deptname","control":"Text","dataPermission":[],"isReference":false,"name":"部门","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"160"}],"sort":6},{"action":[],"authority":[],"children":[],"code":"archiveDate","control":"Date","dataPermission":[],"isReference":false,"javaScript":"","name":"归档时间","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"120"}],"sort":7},{"action":[],"authority":[],"children":[],"code":"depositAddress","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"纸质底稿存放地","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"140"}],"sort":8},{"action":[],"authority":[],"children":[],"code":"compostionCode","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"项目编号","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"160"}],"sort":9},{"action":[],"authority":[],"children":[],"code":"compostionName","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"项目名称","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"400"},{"isHide":false,"name":"align","value":"left"}],"sort":10},{"action":[],"authority":[],"children":[],"code":"customerTypeValue","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"客户类型","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"300"},{"isHide":false,"name":"align","value":"left"}],"sort":11},{"action":[],"authority":[],"children":[],"code":"businessTypeValue","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"业务类型","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"160"}],"sort":12},{"action":[],"authority":[],"children":[],"code":"auditStart","control":"Date","dataPermission":[],"isReference":false,"javaScript":"","name":"审计开始日","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"100"}],"sort":13},{"action":[],"authority":[],"children":[],"code":"auditEnd","control":"Date","dataPermission":[],"isReference":false,"javaScript":"","name":"审计结束日","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"100"}],"sort":14},{"action":[],"authority":[],"children":[],"code":"signingPartnerId","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"签字合伙人","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"100"}],"sort":15},{"action":[],"authority":[],"children":[],"code":"signingAccountantId","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"签字会计师","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"100"}],"sort":16},{"action":[],"authority":[],"children":[],"code":"signingAccountantOtherId","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"签字会计师(备选)","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"140"}],"sort":17},{"action":[],"authority":[],"children":[],"code":"reportIssueValue","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"出具报告类型","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"120"}],"sort":18},{"action":[],"authority":[],"children":[],"code":"mid","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"归档id","otherChildren":[],"property":[],"sort":2},{"action":[],"authority":[],"children":[],"code":"compostionCustomerId","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"被审计单位Id","otherChildren":[],"property":[],"sort":1}],"code":"columnGroup","control":"ColumnGroup","dataPermission":[],"isReference":false,"javaScript":"","name":"table","otherChildren":[],"property":[],"sort":0},{"action":[],"authority":[],"children":[],"code":"uuid","control":"Hidden","dataPermission":[],"isReference":false,"name":"uuid","otherChildren":[],"property":[],"sort":1000}],"code":"alreadyArchiveQuery","control":"GridPanel","dataPermission":[{"authorityRemark":"已归档-单位管理范围","code":"已归档-单位管理范围","dataPermissionType":20,"entityAttribute":"deptId","filterValueType":30,"isUserHide":false}],"isReference":false,"javaScript":"this.OpenLinkForm&nbsp;=&nbsp;function&nbsp;(row)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;UIForm-Web-Schema.json&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaType&nbsp;=&nbsp;&quot;FormPanel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaCode&nbsp;=&nbsp;&quot;ManuscriptItemArchivesInfoShow&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.OpenForm(me,&nbsp;url,&nbsp;parameter,&nbsp;function&nbsp;(form)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(form.Load)&nbsp;form.Load();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})\n&nbsp;&nbsp;&nbsp;&nbsp;\n};","name":"已归档","otherChildren":[],"property":[{"isHide":false,"name":"BaseCode","value":"alreadyArchiveQuery"},{"isHide":false,"name":"Name","value":"已归档"},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"Description"},{"isHide":false,"name":"FormId","value":342836},{"isHide":false,"name":"OrderBy"},{"isHide":false,"name":"IsSqlForm","value":true},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.OpenLinkForm&nbsp;=&nbsp;function&nbsp;(row)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;UIForm-Web-Schema.json&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaType&nbsp;=&nbsp;&quot;FormPanel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaCode&nbsp;=&nbsp;&quot;ManuscriptItemArchivesInfoShow&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.OpenForm(me,&nbsp;url,&nbsp;parameter,&nbsp;function&nbsp;(form)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(form.Load)&nbsp;form.Load();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})\n&nbsp;&nbsp;&nbsp;&nbsp;\n};\r\n \r\n};"}],"sort":0,"sql":"\nselect&nbsp;m.id&nbsp;as&nbsp;mid,c.id&nbsp;as&nbsp;compostionCustomerId,m.code&nbsp;as&nbsp;code,m.bookNumber&nbsp;as&nbsp;bookNumber,m.boxNumber&nbsp;as\n&nbsp;&nbsp;boxNumber,d.name&nbsp;as&nbsp;deptname,\nm.archiveDate&nbsp;as&nbsp;archiveDate,m.depositAddress&nbsp;as&nbsp;depositAddress,c.code&nbsp;as&nbsp;compostionCode,\nc.showName&nbsp;as&nbsp;compostionName,c.customerTypeValue&nbsp;as&nbsp;customerTypeValue&nbsp;,c.businessTypeValue&nbsp;as&nbsp;businessTypeValue,\nc.auditStart&nbsp;as&nbsp;auditStart,c.auditEnd&nbsp;as&nbsp;auditEnd,\n(select&nbsp;name&nbsp;from&nbsp;Base_User&nbsp;where&nbsp;id&nbsp;in(select&nbsp;top&nbsp;1&nbsp;SigningPartnerId&nbsp;from&nbsp;PM_Report&nbsp;where&nbsp;compositionCustomerId=c.id&nbsp;order&nbsp;by&nbsp;createdOn&nbsp;asc))as&nbsp;SigningPartnerId,\n(select&nbsp;name&nbsp;from&nbsp;Base_User&nbsp;where&nbsp;id&nbsp;in(select&nbsp;top&nbsp;1&nbsp;SigningAccountantId&nbsp;from&nbsp;PM_Report&nbsp;where&nbsp;compositionCustomerId=c.id&nbsp;order&nbsp;by&nbsp;createdOn&nbsp;asc))as&nbsp;SigningAccountantId,\n(select&nbsp;name&nbsp;from&nbsp;Base_User&nbsp;where&nbsp;id&nbsp;in(select&nbsp;top&nbsp;1&nbsp;SigningAccountantOtherId&nbsp;from&nbsp;PM_Report&nbsp;where&nbsp;compositionCustomerId=c.id&nbsp;order&nbsp;by&nbsp;createdOn&nbsp;asc))as&nbsp;SigningAccountantOtherId,\n\n(select&nbsp;top&nbsp;1&nbsp;ReportIssueValue&nbsp;from&nbsp;PM_Report&nbsp;where&nbsp;compositionCustomerId=c.id&nbsp;order&nbsp;by&nbsp;createdOn&nbsp;asc)&nbsp;as&nbsp;ReportIssueValue\n\nfrom&nbsp;Prj_ComprositionCustome&nbsp;as&nbsp;c&nbsp;\ninner&nbsp;join&nbsp;Prj_ManuScirptItemArchive&nbsp;m\non&nbsp;c.id&nbsp;=&nbsp;m.compostionCustomerId\ninner&nbsp;join&nbsp;Prj_Project&nbsp;as&nbsp;p\non&nbsp;p.id=c.projectId\ninner&nbsp;join&nbsp;Base_Department&nbsp;as&nbsp;d\non&nbsp;p.deptId=d.id\n\n\n","whereSql":"where \nc.projectId in(\nselect id from Prj_Project where deptId in (\n\n\tselect id from Base_Department where archivistId=#AppContext.Profile.Id#\n\tunion\n\tselect id from Base_Department where parentId in \n\t(\n\t\tselect id from Base_Department where archivistId=#AppContext.Profile.Id#\n\t)\n)\n)  \nand   p.docstate=70 and DATEADD(YY,10,m.archiveDate)>=GETDATE()"}
2020-03-09 16:25:46