{
	"action":[
		{
			"code":"Export",
			"container":"GridPanel",
			"name":"导出",
			"property":[
				{
					"isHide":false,
					"name":"AuthorityRemark",
					"value":"业务报告列表导出"
				}
			],
			"sort":0
		}
	],
	"authority":[
		
	],
	"children":[
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"id",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"主键",
					"otherChildren":[
						
					],
					"property":[
						
					],
					"sort":1
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"timestamp",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"时间戳",
					"otherChildren":[
						
					],
					"property":[
						
					],
					"sort":2
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"code",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"项目编号",
					"otherChildren":[
						
					],
					"property":[
						
					],
					"sort":3
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"showName",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"项目名称",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"IsRenderLink",
							"value":"true"
						},
						{
							"isHide":false,
							"name":"SchemaCode",
							"value":"ProjectTreeReport"
						},
						{
							"container":"GridColumn",
							"isHide":false,
							"name":"Width",
							"value":"400"
						}
					],
					"sort":4
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"customerTypeValue",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"客户类型",
					"otherChildren":[
						
					],
					"property":[
						
					],
					"sort":5
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"businessTypeValue",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"业务类型",
					"otherChildren":[
						
					],
					"property":[
						
					],
					"sort":6
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"riskLevel",
					"control":"Combobox",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"风险等级",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"EnumType",
							"value":"RiskLevel"
						}
					],
					"sort":7
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"deptName",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"部门",
					"otherChildren":[
						
					],
					"property":[
						
					],
					"sort":8
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"partnerName",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"项目合伙人",
					"otherChildren":[
						
					],
					"property":[
						
					],
					"sort":9
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"managerName",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"项目经理",
					"otherChildren":[
						
					],
					"property":[
						
					],
					"sort":10
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"docState",
					"control":"Combobox",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"项目状态",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"EnumType",
							"value":"ProjectState"
						}
					],
					"sort":11
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"projectStatus",
					"control":"Combobox",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"类别",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"EnumType",
							"value":"ProjectStatus"
						}
					],
					"sort":12
				}
			],
			"code":"columnGroup",
			"control":"ColumnGroup",
			"dataPermission":[
				
			],
			"isReference":false,
			"javaScript":"",
			"name":"列集合",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":0
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"uuid",
			"control":"Hidden",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"uuid",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":1000
		}
	],
	"code":"reportProjectFromIndex",
	"control":"GridPanel",
	"dataPermission":[
		{
			"code":"项目经理业务报告",
			"dataPermissionType":10,
			"entityAttribute":"projectManagerId",
			"filterValueType":10,
			"isUserHide":false
		},
		{
			"authorityRemark":"业务报告-单位管理范围",
			"code":"业务报告单位管理范围",
			"dataPermissionType":20,
			"entityAttribute":"deptId",
			"filterValueType":30,
			"isUserHide":false
		}
	],
	"isReference":false,
	"javaScript":"this.OpenLinkForm = function (row) {
        var parameter = {};
        var url = "UIForm-Web-Schema.json";
        parameter.schemaType = "Panel";
        parameter.schemaCode = "ProjectTreeReport";
        parameter.modifyReadOnly = true;
        Framework.OpenForm(me, url, parameter, function (form) {
           if (form.Load) form.Load(me.selected);
        })



}
this.RenderColumnTextStyler = function (row, flied, value) {
    if (flied == "riskLevel") {
        if (value.id == 10)
            return '#e41303';
        if (value.id == 20)
            return '#ffbc1a';
        if (value.id == 30)
            return '#46aaff';

        if (value.id == 40)
            return '#5cdfb3';
    }
}",
	"name":"业务报告展示",
	"otherChildren":[
		
	],
	"property":[
		{
			"isHide":false,
			"name":"BaseCode",
			"value":"reportProjectFromIndex"
		},
		{
			"isHide":false,
			"name":"Name",
			"value":"业务报告展示"
		},
		{
			"isHide":false,
			"name":"IsReadOnly",
			"value":false
		},
		{
			"isHide":false,
			"name":"Description"
		},
		{
			"isHide":false,
			"name":"FormId",
			"value":342963
		},
		{
			"isHide":false,
			"name":"OrderBy",
			"value":"code desc"
		},
		{
			"isHide":false,
			"name":"IsSqlForm",
			"value":true
		},
		{
			"isHide":false,
			"name":"JavaScript",
			"value":"var registerJavaScript = function () {

 

this.OpenLinkForm = function (row) {
        var parameter = {};
        var url = "UIForm-Web-Schema.json";
        parameter.schemaType = "Panel";
        parameter.schemaCode = "ProjectTreeReport";
        parameter.modifyReadOnly = true;
        Framework.OpenForm(me, url, parameter, function (form) {
           if (form.Load) form.Load(me.selected);
        })



}
this.RenderColumnTextStyler = function (row, flied, value) {
    if (flied == "riskLevel") {
        if (value.id == 10)
            return '#e41303';
        if (value.id == 20)
            return '#ffbc1a';
        if (value.id == 30)
            return '#46aaff';

        if (value.id == 40)
            return '#5cdfb3';
    }
}

 

};"
		}
	],
	"sort":0,
	"sql":"select 
p.id,p.[timestamp],p.code,p.showName,p.customerTypeValue,p.businessTypeValue,p.riskLevel,d.treeName deptName,
u.name partnerName,u1.name managerName,
p.docstate,p.ProjectStatus from Prj_Project p
left join Base_Department d on d.id=p.deptId
left join Base_User u on p.ProjectPartnerId=u.id
left join Base_User u1 on p.projectManagerId=u1.id
where  p.docState=30",
	"whereSql":"and p.id in (select ProjectId from dbo.Prj_ProjectMembers pm inner join base_user u on u.id=pm.NameId where u.id='#AppContext.Profile.Id#' and pm.isenable!=20 group by ProjectId) "
}
{"action":[{"code":"Export","container":"GridPanel","name":"导出","property":[{"isHide":false,"name":"AuthorityRemark","value":"业务报告列表导出"}],"sort":0}],"authority":[],"children":[{"action":[],"authority":[],"children":[{"action":[],"authority":[],"children":[],"code":"id","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"主键","otherChildren":[],"property":[],"sort":1},{"action":[],"authority":[],"children":[],"code":"timestamp","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"时间戳","otherChildren":[],"property":[],"sort":2},{"action":[],"authority":[],"children":[],"code":"code","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"项目编号","otherChildren":[],"property":[],"sort":3},{"action":[],"authority":[],"children":[],"code":"showName","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"项目名称","otherChildren":[],"property":[{"isHide":false,"name":"IsRenderLink","value":"true"},{"isHide":false,"name":"SchemaCode","value":"ProjectTreeReport"},{"container":"GridColumn","isHide":false,"name":"Width","value":"400"}],"sort":4},{"action":[],"authority":[],"children":[],"code":"customerTypeValue","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"客户类型","otherChildren":[],"property":[],"sort":5},{"action":[],"authority":[],"children":[],"code":"businessTypeValue","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"业务类型","otherChildren":[],"property":[],"sort":6},{"action":[],"authority":[],"children":[],"code":"riskLevel","control":"Combobox","dataPermission":[],"isReference":false,"javaScript":"","name":"风险等级","otherChildren":[],"property":[{"isHide":false,"name":"EnumType","value":"RiskLevel"}],"sort":7},{"action":[],"authority":[],"children":[],"code":"deptName","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"部门","otherChildren":[],"property":[],"sort":8},{"action":[],"authority":[],"children":[],"code":"partnerName","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"项目合伙人","otherChildren":[],"property":[],"sort":9},{"action":[],"authority":[],"children":[],"code":"managerName","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"项目经理","otherChildren":[],"property":[],"sort":10},{"action":[],"authority":[],"children":[],"code":"docState","control":"Combobox","dataPermission":[],"isReference":false,"javaScript":"","name":"项目状态","otherChildren":[],"property":[{"isHide":false,"name":"EnumType","value":"ProjectState"}],"sort":11},{"action":[],"authority":[],"children":[],"code":"projectStatus","control":"Combobox","dataPermission":[],"isReference":false,"javaScript":"","name":"类别","otherChildren":[],"property":[{"isHide":false,"name":"EnumType","value":"ProjectStatus"}],"sort":12}],"code":"columnGroup","control":"ColumnGroup","dataPermission":[],"isReference":false,"javaScript":"","name":"列集合","otherChildren":[],"property":[],"sort":0},{"action":[],"authority":[],"children":[],"code":"uuid","control":"Hidden","dataPermission":[],"isReference":false,"name":"uuid","otherChildren":[],"property":[],"sort":1000}],"code":"reportProjectFromIndex","control":"GridPanel","dataPermission":[{"code":"项目经理业务报告","dataPermissionType":10,"entityAttribute":"projectManagerId","filterValueType":10,"isUserHide":false},{"authorityRemark":"业务报告-单位管理范围","code":"业务报告单位管理范围","dataPermissionType":20,"entityAttribute":"deptId","filterValueType":30,"isUserHide":false}],"isReference":false,"javaScript":"this.OpenLinkForm&nbsp;=&nbsp;function&nbsp;(row)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;UIForm-Web-Schema.json&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaType&nbsp;=&nbsp;&quot;Panel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaCode&nbsp;=&nbsp;&quot;ProjectTreeReport&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.modifyReadOnly&nbsp;=&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.OpenForm(me,&nbsp;url,&nbsp;parameter,&nbsp;function&nbsp;(form)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(form.Load)&nbsp;form.Load(me.selected);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})\n\n\n\n}\nthis.RenderColumnTextStyler&nbsp;=&nbsp;function&nbsp;(row,&nbsp;flied,&nbsp;value)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(flied&nbsp;==&nbsp;&quot;riskLevel&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;10)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#e41303';\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;20)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#ffbc1a';\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;30)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#46aaff';\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;40)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#5cdfb3';\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}","name":"业务报告展示","otherChildren":[],"property":[{"isHide":false,"name":"BaseCode","value":"reportProjectFromIndex"},{"isHide":false,"name":"Name","value":"业务报告展示"},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"Description"},{"isHide":false,"name":"FormId","value":342963},{"isHide":false,"name":"OrderBy","value":"code desc"},{"isHide":false,"name":"IsSqlForm","value":true},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.OpenLinkForm&nbsp;=&nbsp;function&nbsp;(row)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;UIForm-Web-Schema.json&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaType&nbsp;=&nbsp;&quot;Panel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaCode&nbsp;=&nbsp;&quot;ProjectTreeReport&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.modifyReadOnly&nbsp;=&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.OpenForm(me,&nbsp;url,&nbsp;parameter,&nbsp;function&nbsp;(form)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(form.Load)&nbsp;form.Load(me.selected);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;})\n\n\n\n}\nthis.RenderColumnTextStyler&nbsp;=&nbsp;function&nbsp;(row,&nbsp;flied,&nbsp;value)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(flied&nbsp;==&nbsp;&quot;riskLevel&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;10)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#e41303';\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;20)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#ffbc1a';\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;30)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#46aaff';\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;40)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#5cdfb3';\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}\r\n \r\n};"}],"sort":0,"sql":"select&nbsp;\np.id,p.[timestamp],p.code,p.showName,p.customerTypeValue,p.businessTypeValue,p.riskLevel,d.treeName&nbsp;deptName,\nu.name&nbsp;partnerName,u1.name&nbsp;managerName,\np.docstate,p.ProjectStatus&nbsp;from&nbsp;Prj_Project&nbsp;p\nleft&nbsp;join&nbsp;Base_Department&nbsp;d&nbsp;on&nbsp;d.id=p.deptId\nleft&nbsp;join&nbsp;Base_User&nbsp;u&nbsp;on&nbsp;p.ProjectPartnerId=u.id\nleft&nbsp;join&nbsp;Base_User&nbsp;u1&nbsp;on&nbsp;p.projectManagerId=u1.id\nwhere&nbsp;&nbsp;p.docState=30","whereSql":"and p.id in (select ProjectId from dbo.Prj_ProjectMembers pm inner join base_user u on u.id=pm.NameId where u.id='#AppContext.Profile.Id#' and pm.isenable!=20 group by ProjectId) "}
2020-03-09 16:25:59