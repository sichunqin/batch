{
	"action":[
		{
			"code":"Revision",
			"name":"修订情况",
			"property":[
				{
					"isHide":false,
					"name":"ReferenceId",
					"value":314500
				}
			],
			"sort":0
		},
		{
			"code":"Annex",
			"name":"附件",
			"property":[
				{
					"isHide":false,
					"name":"IconImg",
					"value":"paperclip.png"
				},
				{
					"isHide":false,
					"name":"IsRenderColumn",
					"value":"true"
				},
				{
					"isHide":false,
					"name":"LinkImg",
					"value":"/Styles/icons/index/icon_filepc.png"
				},
				{
					"isHide":false,
					"name":"ActionGroup",
					"value":"附件"
				},
				{
					"isHide":false,
					"name":"ReferenceId",
					"value":333380
				},
				{
					"isHide":false,
					"name":"JavaScript",
					"value":"var registerJavaScript = function () {

 

this.BeforeHandler = function () {
    console.log("BeforeHandler");

    var list = this.Up().Up();
    var dglist = list.DownForCode("manuscriptItems");
    var s = dglist.LinkSelectData;
    return    s.has>0;



};




 

};"
				}
			],
			"sort":1
		},
		{
			"code":"Look",
			"name":"查看",
			"property":[
				{
					"isHide":false,
					"name":"IsRenderColumn",
					"value":"true"
				},
				{
					"isHide":false,
					"name":"ActionGroup",
					"value":"上一版本"
				},
				{
					"isHide":false,
					"name":"OnClick",
					"value":"onClick"
				},
				{
					"isHide":false,
					"name":"JavaScript",
					"value":"var registerJavaScript = function () {

 

this.BeforeHandler = function () {
    console.log("BeforeHandler");

    var list = this.Up().Up();
    var dglist = list.DownForCode("manuscriptItems");
    var s = dglist.LinkSelectData;
    return    s.modifystatus == 20;

};

this.onClick = function () {
    console.log("BeforeHandler");

    var list = this.Up().Up();
    var dglist = list.DownForCode("manuscriptItems");
    var row = dglist.LinkSelectData;
    var prjpath = row.auditworkProjectID;
    var param = {};
    param.prjUUid = prjpath;
    if(row.modifystatus == 30)
    {
        param.type=10;
    }else {
        param.type=20;
    }
    var path;
    var ib = true;
    Framework.AjaxRequest(me, "ManuscriptItem-gaincsUploadPath-Query.do", 'get', param, false, function (result) {
        path = result;
    }, function (result) {

        ib = false;
    }, false);

    if (!ib) {
        return;
    }
    url = 'downloadFileManuscript.json';
    path= path+ '\\\\ManuscriptFile\\\\' + row.manuscriptFileRelativePath;
    Framework.DownLoad(null, row.manuscriptFile, path, null, null, url);

};

 

};"
				}
			],
			"sort":2
		}
	],
	"authority":[
		
	],
	"children":[
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"id",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"主键",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":16
						},
						{
							"isHide":false,
							"name":"Required",
							"value":true
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"Id",
					"sort":10
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"firstLevelReviewerSignTime",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"一级复核人签字日期",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":10
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"FirstLevelReviewerSignTime",
					"sort":11
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"firstLevelReviewerSignName",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"复核人",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":3000
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"align",
							"value":"left"
						},
						{
							"isHide":false,
							"name":"halign",
							"value":"left"
						},
						{
							"isHide":false,
							"name":"Width",
							"value":"80"
						}
					],
					"select":"FirstLevelReviewerSignName",
					"sort":9
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"firstLevelReviewerSignID",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"一级复核人签字ID",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":3000
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"FirstLevelReviewerSignID",
					"sort":12
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"compilingPersonSignTime",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"编制人签字日期",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":100
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"CompilingPersonSignTime",
					"sort":13
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"compilingPersonSignName",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"编制人",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":3000
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"halign",
							"value":"left"
						},
						{
							"isHide":false,
							"name":"align",
							"value":"left"
						},
						{
							"isHide":false,
							"name":"Width",
							"value":"80"
						}
					],
					"select":"CompilingPersonSignName",
					"sort":8
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"compilingPersonSignID",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"编制人签字ID",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":3000
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"CompilingPersonSignID",
					"sort":14
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"parentStructureCode",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"上级内部编号",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":3000
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"ParentStructureCode",
					"sort":15
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"structureCode",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"内部编号",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":3000
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"StructureCode",
					"sort":16
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"manuscriptDisplayName",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"工作底稿名称",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":3000
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsRenderLink",
							"value":"true"
						},
						{
							"isHide":false,
							"name":"align",
							"value":"left"
						},
						{
							"isHide":false,
							"name":"halign",
							"value":"left"
						},
						{
							"isHide":false,
							"name":"Width",
							"value":"600"
						}
					],
					"select":"ManuscriptDisplayName",
					"sort":7
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"manuscriptCode",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"底稿编号",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":3000
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"ManuscriptCode",
					"sort":17
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"sortNO",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"排序号",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":200
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"SortNO",
					"sort":18
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"fiscalYear",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"财务年度",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":200
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"FiscalYear",
					"sort":19
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"fiscalYearInforID",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"财年信息ID",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":200
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"FiscalYearInforID",
					"sort":20
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"auditworkProjectID",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"作业项目ID",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":3000
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"AuditworkProjectID",
					"sort":21
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"timestamp",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"时间戳",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":8
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"Timestamp",
					"sort":22
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"manuscriptFile",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"底稿文件打开保存名称",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":3000
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"ManuscriptFile",
					"sort":6
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"manuscriptFileRelativePath",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"底稿文件相对路径",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":3000
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"ManuscriptFileRelativePath",
					"sort":5
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"modifystatus",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"修改状态",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":200
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"Description",
							"value":"编辑状态"
						}
					],
					"select":"ModifyStatus",
					"sort":4
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"itemVersion",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"ItemVersion",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":16
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"ItemVersion",
					"sort":3
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"manuscriptItemId",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"manuscriptItemId ",
					"otherChildren":[
						
					],
					"property":[
						
					],
					"sort":2
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"has",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"Has",
					"otherChildren":[
						
					],
					"property":[
						
					],
					"sort":1
				}
			],
			"code":"columnGroup",
			"control":"ColumnGroup",
			"dataPermission":[
				
			],
			"isReference":false,
			"javaScript":"",
			"name":"列集合",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":0
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"uuid",
			"control":"Hidden",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"uuid",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":1000
		}
	],
	"code":"manuscriptItemGrid",
	"control":"GridPanel",
	"dataPermission":[
		
	],
	"isReference":false,
	"javaScript":"this.OpenLinkForm = function (row, field) {
    console.log("OpenLinkForm 底稿复核");
    var prjpath = row.auditworkProjectID;
    var param = {};
    param.prjUUid = prjpath;
    param.type=10;
    var path;
    var ib = true;
    Framework.AjaxRequest(me, "ManuscriptItem-gaincsUploadPath-Query.do", 'get', param, false, function (result) {
        path = result;
    }, function (result) {

        ib = false;
    }, false);

    if (!ib) {
        return;
    }

    url = 'downloadFileManuscript.json';
    path= path+ '\\\\ManuscriptFile\\\\' + row.manuscriptFileRelativePath;
    Framework.DownLoad(null, row.manuscriptFile, path, null, null, url);
    // var data={};
    // data.fileName = row.manuscriptFile;
    // data.fileId =row.manuscriptFile;
    // data.filePath=path;
    // data.readOnly=true;
    // data.fileType =row.manuscriptFile.substr(row.manuscriptFile.lastIndexOf('.'),100);
    // WebOffice.OpenWebOffice(this,data);

};


this.RenderColumnLinkColor= function (row, field, value) {//RenderColumnStyler 设置背景色 
//console.log("RenderColumnStyler  底稿复核");
    var t=this.Top();
    var frm=this.Top("[basecode='qualityReview']");
    if(Framework.IsNullOrEmpty(frm.curstate))
    {
        if (row.modifystatus == 10 && (field == 'manuscriptDisplayName'   )) {// 新增 红色 因为现在超链接字段设置前景色不起作用，暂时用别的字段代替，表示变色了，等调试好了再去掉
            return '#e41303';

        } else if (row.modifystatus == 20 && (field == 'manuscriptDisplayName')) {//修改 红色，都改成红色
            return '#e41303';
        }
    }else
    {
        if (row.modifystatus == 10 && (field == 'manuscriptDisplayName' ) && row.itemVersion ==frm.curstate) {// 新增 红色
            return '#e41303';

        } else if (row.modifystatus == 20 && (field == 'manuscriptDisplayName' ) && row.itemVersion ==frm.curstate) {//修改 红色
            return '#e41303';
        }
    }

};
this.BeforeLoad = function () {
    console.log("BeforeLoad ");
    if(Framework.IsNullOrEmpty(this.GetQueryParams().query_fiscalYear))
    {
        return false;
    }
};
this.SetActionColumnVisible = function (item, row) {
    console.log("控制查看按钮是否可见");
 if (item.code == "Annex" && row.has == 0 && item.name) {
        item.name = item.name.replace('icon_filepc.png', 'icon_filepc_h.png')
    }
    debugger;
    if (item.code == "Look") {
        if (Framework.IsNotNullOrEmpty(row.modifystatus ) &&row.modifystatus == 20) {
            return false;
        } else {
            return true;
        }
    }
};


",
	"name":"审计工作底稿",
	"otherChildren":[
		
	],
	"property":[
		{
			"isHide":false,
			"name":"BaseCode",
			"value":"manuscriptItemGrid"
		},
		{
			"isHide":false,
			"name":"Name",
			"value":"审计工作底稿"
		},
		{
			"isHide":false,
			"name":"IsReadOnly",
			"value":false
		},
		{
			"isHide":false,
			"name":"Description"
		},
		{
			"isHide":false,
			"name":"FormId",
			"value":23911
		},
		{
			"isHide":false,
			"name":"OrderBy",
			"value":"SortNO,FiscalYear"
		},
		{
			"isHide":false,
			"name":"IsSqlForm",
			"value":true
		},
		{
			"isHide":false,
			"name":"JavaScript",
			"value":"var registerJavaScript = function () {

 

this.OpenLinkForm = function (row, field) {
    console.log("OpenLinkForm 底稿复核");
    var prjpath = row.auditworkProjectID;
    var param = {};
    param.prjUUid = prjpath;
    param.type=10;
    var path;
    var ib = true;
    Framework.AjaxRequest(me, "ManuscriptItem-gaincsUploadPath-Query.do", 'get', param, false, function (result) {
        path = result;
    }, function (result) {

        ib = false;
    }, false);

    if (!ib) {
        return;
    }

    url = 'downloadFileManuscript.json';
    path= path+ '\\\\ManuscriptFile\\\\' + row.manuscriptFileRelativePath;
    Framework.DownLoad(null, row.manuscriptFile, path, null, null, url);
    // var data={};
    // data.fileName = row.manuscriptFile;
    // data.fileId =row.manuscriptFile;
    // data.filePath=path;
    // data.readOnly=true;
    // data.fileType =row.manuscriptFile.substr(row.manuscriptFile.lastIndexOf('.'),100);
    // WebOffice.OpenWebOffice(this,data);

};


this.RenderColumnLinkColor= function (row, field, value) {//RenderColumnStyler 设置背景色 
//console.log("RenderColumnStyler  底稿复核");
    var t=this.Top();
    var frm=this.Top("[basecode='qualityReview']");
    if(Framework.IsNullOrEmpty(frm.curstate))
    {
        if (row.modifystatus == 10 && (field == 'manuscriptDisplayName'   )) {// 新增 红色 因为现在超链接字段设置前景色不起作用，暂时用别的字段代替，表示变色了，等调试好了再去掉
            return '#e41303';

        } else if (row.modifystatus == 20 && (field == 'manuscriptDisplayName')) {//修改 红色，都改成红色
            return '#e41303';
        }
    }else
    {
        if (row.modifystatus == 10 && (field == 'manuscriptDisplayName' ) && row.itemVersion ==frm.curstate) {// 新增 红色
            return '#e41303';

        } else if (row.modifystatus == 20 && (field == 'manuscriptDisplayName' ) && row.itemVersion ==frm.curstate) {//修改 红色
            return '#e41303';
        }
    }

};
this.BeforeLoad = function () {
    console.log("BeforeLoad ");
    if(Framework.IsNullOrEmpty(this.GetQueryParams().query_fiscalYear))
    {
        return false;
    }
};
this.SetActionColumnVisible = function (item, row) {
    console.log("控制查看按钮是否可见");
 if (item.code == "Annex" && row.has == 0 && item.name) {
        item.name = item.name.replace('icon_filepc.png', 'icon_filepc_h.png')
    }
    debugger;
    if (item.code == "Look") {
        if (Framework.IsNotNullOrEmpty(row.modifystatus ) &&row.modifystatus == 20) {
            return false;
        } else {
            return true;
        }
    }
};




 

};"
		},
		{
			"isHide":false,
			"name":"EntityType",
			"value":"ManuscriptItem"
		},
		{
			"isHide":false,
			"name":"pagination",
			"value":"false"
		},
		{
			"isHide":false,
			"name":"striped",
			"value":"true"
		},
		{
			"isHide":false,
			"name":"rownumbers",
			"value":"false"
		}
	],
	"sort":0,
	"sql":"select ItemVersion,Modifystatus,ManuscriptFileRelativePath,ManuscriptFile,isnull(IndexNumber,'') + ManuscriptDisplayName as 'ManuscriptDisplayName'
,CompilingPersonSignName,FirstLevelReviewerSignName,Id,FirstLevelReviewerSignTime,FirstLevelReviewerSignID
,CompilingPersonSignTime,CompilingPersonSignID,ParentStructureCode,StructureCode,ManuscriptCode,SortNO
,FiscalYear,FiscalYearInforID,AuditworkProjectID,Timestamp,uuid as manuscriptItemId
,(select count(☆)from Prj_AuditFilesVSManuscript am,Prj_AuditFiles a
 where am.auditworkProjectID= b.auditworkProjectID
 and am.manuscriptitemID =b.uuid and am.auditworkProjectID = a.auditworkProjectID
 and am.auditFilesID =a.uuid ) as Has
from dbo.Prj_ManuscriptItem b 
where ({fiscalYear} =0 or ({fiscalYear}!=0 and FiscalYear = {fiscalYear}))
and AuditworkProjectID={auditworkProjectID} and IsGroup='0' and ParentStructureCode={parentStructureCode}
and IsSelected='1' and IsDisplay='1' and ModifyStatus !=30 and TheColor in ('Blue','Black')"
}
{"action":[{"code":"Revision","name":"修订情况","property":[{"isHide":false,"name":"ReferenceId","value":314500}],"sort":0},{"code":"Annex","name":"附件","property":[{"isHide":false,"name":"IconImg","value":"paperclip.png"},{"isHide":false,"name":"IsRenderColumn","value":"true"},{"isHide":false,"name":"LinkImg","value":"/Styles/icons/index/icon_filepc.png"},{"isHide":false,"name":"ActionGroup","value":"附件"},{"isHide":false,"name":"ReferenceId","value":333380},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.BeforeHandler&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;BeforeHandler&quot;);\n\n&nbsp;&nbsp;&nbsp;&nbsp;var list = this.Up().Up();\n&nbsp;&nbsp;&nbsp;&nbsp;var dglist = list.DownForCode(&quot;manuscriptItems&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var s = dglist.LinkSelectData;\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&nbsp;&nbsp;&nbsp;s.has&gt;0;\n\n\n\n};\n\n\n\r\n \r\n};"}],"sort":1},{"code":"Look","name":"查看","property":[{"isHide":false,"name":"IsRenderColumn","value":"true"},{"isHide":false,"name":"ActionGroup","value":"上一版本"},{"isHide":false,"name":"OnClick","value":"onClick"},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.BeforeHandler&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;BeforeHandler&quot;);\n\n&nbsp;&nbsp;&nbsp;&nbsp;var list = this.Up().Up();\n&nbsp;&nbsp;&nbsp;&nbsp;var dglist = list.DownForCode(&quot;manuscriptItems&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var s = dglist.LinkSelectData;\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;&nbsp;&nbsp;&nbsp;s.modifystatus&nbsp;==&nbsp;20;\n\n};\n\nthis.onClick&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;BeforeHandler&quot;);\n\n&nbsp;&nbsp;&nbsp;&nbsp;var list = this.Up().Up();\n&nbsp;&nbsp;&nbsp;&nbsp;var dglist = list.DownForCode(&quot;manuscriptItems&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var row = dglist.LinkSelectData;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;prjpath&nbsp;=&nbsp;row.auditworkProjectID;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;param&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;param.prjUUid&nbsp;=&nbsp;prjpath;\n&nbsp;&nbsp;&nbsp;&nbsp;if(row.modifystatus&nbsp;==&nbsp;30)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param.type=10;\n&nbsp;&nbsp;&nbsp;&nbsp;}else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param.type=20;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;path;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;ib&nbsp;=&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;ManuscriptItem-gaincsUploadPath-Query.do&quot;,&nbsp;'get',&nbsp;param,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;=&nbsp;result;\n&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;function&nbsp;(result)&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib&nbsp;=&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;false);\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!ib)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;'downloadFileManuscript.json';\n&nbsp;&nbsp;&nbsp;&nbsp;path=&nbsp;path+&nbsp;'\\\\ManuscriptFile\\\\'&nbsp;+&nbsp;row.manuscriptFileRelativePath;\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.DownLoad(null,&nbsp;row.manuscriptFile,&nbsp;path,&nbsp;null,&nbsp;null,&nbsp;url);\n\n};\r\n \r\n};"}],"sort":2}],"authority":[],"children":[{"action":[],"authority":[],"children":[{"action":[],"authority":[],"children":[],"code":"id","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"主键","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":16},{"isHide":false,"name":"Required","value":true},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"Id","sort":10},{"action":[],"authority":[],"children":[],"code":"firstLevelReviewerSignTime","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"一级复核人签字日期","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":10},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"FirstLevelReviewerSignTime","sort":11},{"action":[],"authority":[],"children":[],"code":"firstLevelReviewerSignName","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"复核人","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":3000},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"align","value":"left"},{"isHide":false,"name":"halign","value":"left"},{"isHide":false,"name":"Width","value":"80"}],"select":"FirstLevelReviewerSignName","sort":9},{"action":[],"authority":[],"children":[],"code":"firstLevelReviewerSignID","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"一级复核人签字ID","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":3000},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"FirstLevelReviewerSignID","sort":12},{"action":[],"authority":[],"children":[],"code":"compilingPersonSignTime","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"编制人签字日期","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":100},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"CompilingPersonSignTime","sort":13},{"action":[],"authority":[],"children":[],"code":"compilingPersonSignName","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"编制人","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":3000},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"halign","value":"left"},{"isHide":false,"name":"align","value":"left"},{"isHide":false,"name":"Width","value":"80"}],"select":"CompilingPersonSignName","sort":8},{"action":[],"authority":[],"children":[],"code":"compilingPersonSignID","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"编制人签字ID","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":3000},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"CompilingPersonSignID","sort":14},{"action":[],"authority":[],"children":[],"code":"parentStructureCode","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"上级内部编号","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":3000},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"ParentStructureCode","sort":15},{"action":[],"authority":[],"children":[],"code":"structureCode","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"内部编号","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":3000},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"StructureCode","sort":16},{"action":[],"authority":[],"children":[],"code":"manuscriptDisplayName","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"工作底稿名称","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":3000},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"IsRenderLink","value":"true"},{"isHide":false,"name":"align","value":"left"},{"isHide":false,"name":"halign","value":"left"},{"isHide":false,"name":"Width","value":"600"}],"select":"ManuscriptDisplayName","sort":7},{"action":[],"authority":[],"children":[],"code":"manuscriptCode","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"底稿编号","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":3000},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"ManuscriptCode","sort":17},{"action":[],"authority":[],"children":[],"code":"sortNO","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"排序号","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":200},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"SortNO","sort":18},{"action":[],"authority":[],"children":[],"code":"fiscalYear","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"财务年度","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":200},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"FiscalYear","sort":19},{"action":[],"authority":[],"children":[],"code":"fiscalYearInforID","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"财年信息ID","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":200},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"FiscalYearInforID","sort":20},{"action":[],"authority":[],"children":[],"code":"auditworkProjectID","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"作业项目ID","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":3000},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"AuditworkProjectID","sort":21},{"action":[],"authority":[],"children":[],"code":"timestamp","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"时间戳","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":8},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"Timestamp","sort":22},{"action":[],"authority":[],"children":[],"code":"manuscriptFile","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"底稿文件打开保存名称","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":3000},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"ManuscriptFile","sort":6},{"action":[],"authority":[],"children":[],"code":"manuscriptFileRelativePath","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"底稿文件相对路径","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":3000},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"ManuscriptFileRelativePath","sort":5},{"action":[],"authority":[],"children":[],"code":"modifystatus","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"修改状态","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":200},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"Description","value":"编辑状态"}],"select":"ModifyStatus","sort":4},{"action":[],"authority":[],"children":[],"code":"itemVersion","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"ItemVersion","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":16},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"ItemVersion","sort":3},{"action":[],"authority":[],"children":[],"code":"manuscriptItemId","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"manuscriptItemId ","otherChildren":[],"property":[],"sort":2},{"action":[],"authority":[],"children":[],"code":"has","control":"Hidden","dataPermission":[],"isReference":false,"name":"Has","otherChildren":[],"property":[],"sort":1}],"code":"columnGroup","control":"ColumnGroup","dataPermission":[],"isReference":false,"javaScript":"","name":"列集合","otherChildren":[],"property":[],"sort":0},{"action":[],"authority":[],"children":[],"code":"uuid","control":"Hidden","dataPermission":[],"isReference":false,"name":"uuid","otherChildren":[],"property":[],"sort":1000}],"code":"manuscriptItemGrid","control":"GridPanel","dataPermission":[],"isReference":false,"javaScript":"this.OpenLinkForm&nbsp;=&nbsp;function&nbsp;(row,&nbsp;field)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;OpenLinkForm&nbsp;底稿复核&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;prjpath&nbsp;=&nbsp;row.auditworkProjectID;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;param&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;param.prjUUid&nbsp;=&nbsp;prjpath;\n&nbsp;&nbsp;&nbsp;&nbsp;param.type=10;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;path;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;ib&nbsp;=&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;ManuscriptItem-gaincsUploadPath-Query.do&quot;,&nbsp;'get',&nbsp;param,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;=&nbsp;result;\n&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;function&nbsp;(result)&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib&nbsp;=&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;false);\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!ib)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;'downloadFileManuscript.json';\n&nbsp;&nbsp;&nbsp;&nbsp;path=&nbsp;path+&nbsp;'\\\\ManuscriptFile\\\\'&nbsp;+&nbsp;row.manuscriptFileRelativePath;\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.DownLoad(null,&nbsp;row.manuscriptFile,&nbsp;path,&nbsp;null,&nbsp;null,&nbsp;url);\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var&nbsp;data={};\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;data.fileName&nbsp;=&nbsp;row.manuscriptFile;\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;data.fileId&nbsp;=row.manuscriptFile;\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;data.filePath=path;\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;data.readOnly=true;\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;data.fileType&nbsp;=row.manuscriptFile.substr(row.manuscriptFile.lastIndexOf('.'),100);\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;WebOffice.OpenWebOffice(this,data);\n\n};\n\n\nthis.RenderColumnLinkColor=&nbsp;function&nbsp;(row,&nbsp;field,&nbsp;value)&nbsp;{//RenderColumnStyler&nbsp;设置背景色&nbsp;\n//console.log(&quot;RenderColumnStyler&nbsp;&nbsp;底稿复核&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;t=this.Top();\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;frm=this.Top(&quot;[basecode='qualityReview']&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if(Framework.IsNullOrEmpty(frm.curstate))\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(row.modifystatus&nbsp;==&nbsp;10&nbsp;&&&nbsp;(field&nbsp;==&nbsp;'manuscriptDisplayName'&nbsp;&nbsp;&nbsp;))&nbsp;{//&nbsp;新增&nbsp;红色&nbsp;因为现在超链接字段设置前景色不起作用，暂时用别的字段代替，表示变色了，等调试好了再去掉\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#e41303';\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(row.modifystatus&nbsp;==&nbsp;20&nbsp;&&&nbsp;(field&nbsp;==&nbsp;'manuscriptDisplayName'))&nbsp;{//修改&nbsp;红色，都改成红色\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#e41303';\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}else\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(row.modifystatus&nbsp;==&nbsp;10&nbsp;&&&nbsp;(field&nbsp;==&nbsp;'manuscriptDisplayName'&nbsp;)&nbsp;&&&nbsp;row.itemVersion&nbsp;==frm.curstate)&nbsp;{//&nbsp;新增&nbsp;红色\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#e41303';\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(row.modifystatus&nbsp;==&nbsp;20&nbsp;&&&nbsp;(field&nbsp;==&nbsp;'manuscriptDisplayName'&nbsp;)&nbsp;&&&nbsp;row.itemVersion&nbsp;==frm.curstate)&nbsp;{//修改&nbsp;红色\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#e41303';\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n};\nthis.BeforeLoad&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;BeforeLoad&nbsp;&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if(Framework.IsNullOrEmpty(this.GetQueryParams().query_fiscalYear))\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n};\nthis.SetActionColumnVisible&nbsp;=&nbsp;function&nbsp;(item,&nbsp;row)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;控制查看按钮是否可见&quot;);\n&nbsp;if&nbsp;(item.code&nbsp;==&nbsp;&quot;Annex&quot;&nbsp;&&&nbsp;row.has&nbsp;==&nbsp;0&nbsp;&&&nbsp;item.name)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item.name&nbsp;=&nbsp;item.name.replace('icon_filepc.png',&nbsp;'icon_filepc_h.png')\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;debugger;\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item.code&nbsp;==&nbsp;&quot;Look&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNotNullOrEmpty(row.modifystatus&nbsp;)&nbsp;&&row.modifystatus&nbsp;==&nbsp;20)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n};\n\n\n","name":"审计工作底稿","otherChildren":[],"property":[{"isHide":false,"name":"BaseCode","value":"manuscriptItemGrid"},{"isHide":false,"name":"Name","value":"审计工作底稿"},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"Description"},{"isHide":false,"name":"FormId","value":23911},{"isHide":false,"name":"OrderBy","value":"SortNO,FiscalYear"},{"isHide":false,"name":"IsSqlForm","value":true},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.OpenLinkForm&nbsp;=&nbsp;function&nbsp;(row,&nbsp;field)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;OpenLinkForm&nbsp;底稿复核&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;prjpath&nbsp;=&nbsp;row.auditworkProjectID;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;param&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;param.prjUUid&nbsp;=&nbsp;prjpath;\n&nbsp;&nbsp;&nbsp;&nbsp;param.type=10;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;path;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;ib&nbsp;=&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;ManuscriptItem-gaincsUploadPath-Query.do&quot;,&nbsp;'get',&nbsp;param,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;path&nbsp;=&nbsp;result;\n&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;function&nbsp;(result)&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ib&nbsp;=&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;false);\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!ib)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;url&nbsp;=&nbsp;'downloadFileManuscript.json';\n&nbsp;&nbsp;&nbsp;&nbsp;path=&nbsp;path+&nbsp;'\\\\ManuscriptFile\\\\'&nbsp;+&nbsp;row.manuscriptFileRelativePath;\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.DownLoad(null,&nbsp;row.manuscriptFile,&nbsp;path,&nbsp;null,&nbsp;null,&nbsp;url);\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var&nbsp;data={};\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;data.fileName&nbsp;=&nbsp;row.manuscriptFile;\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;data.fileId&nbsp;=row.manuscriptFile;\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;data.filePath=path;\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;data.readOnly=true;\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;data.fileType&nbsp;=row.manuscriptFile.substr(row.manuscriptFile.lastIndexOf('.'),100);\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;WebOffice.OpenWebOffice(this,data);\n\n};\n\n\nthis.RenderColumnLinkColor=&nbsp;function&nbsp;(row,&nbsp;field,&nbsp;value)&nbsp;{//RenderColumnStyler&nbsp;设置背景色&nbsp;\n//console.log(&quot;RenderColumnStyler&nbsp;&nbsp;底稿复核&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;t=this.Top();\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;frm=this.Top(&quot;[basecode='qualityReview']&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if(Framework.IsNullOrEmpty(frm.curstate))\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(row.modifystatus&nbsp;==&nbsp;10&nbsp;&&&nbsp;(field&nbsp;==&nbsp;'manuscriptDisplayName'&nbsp;&nbsp;&nbsp;))&nbsp;{//&nbsp;新增&nbsp;红色&nbsp;因为现在超链接字段设置前景色不起作用，暂时用别的字段代替，表示变色了，等调试好了再去掉\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#e41303';\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(row.modifystatus&nbsp;==&nbsp;20&nbsp;&&&nbsp;(field&nbsp;==&nbsp;'manuscriptDisplayName'))&nbsp;{//修改&nbsp;红色，都改成红色\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#e41303';\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}else\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(row.modifystatus&nbsp;==&nbsp;10&nbsp;&&&nbsp;(field&nbsp;==&nbsp;'manuscriptDisplayName'&nbsp;)&nbsp;&&&nbsp;row.itemVersion&nbsp;==frm.curstate)&nbsp;{//&nbsp;新增&nbsp;红色\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#e41303';\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(row.modifystatus&nbsp;==&nbsp;20&nbsp;&&&nbsp;(field&nbsp;==&nbsp;'manuscriptDisplayName'&nbsp;)&nbsp;&&&nbsp;row.itemVersion&nbsp;==frm.curstate)&nbsp;{//修改&nbsp;红色\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#e41303';\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n};\nthis.BeforeLoad&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;BeforeLoad&nbsp;&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if(Framework.IsNullOrEmpty(this.GetQueryParams().query_fiscalYear))\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n};\nthis.SetActionColumnVisible&nbsp;=&nbsp;function&nbsp;(item,&nbsp;row)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;控制查看按钮是否可见&quot;);\n&nbsp;if&nbsp;(item.code&nbsp;==&nbsp;&quot;Annex&quot;&nbsp;&&&nbsp;row.has&nbsp;==&nbsp;0&nbsp;&&&nbsp;item.name)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;item.name&nbsp;=&nbsp;item.name.replace('icon_filepc.png',&nbsp;'icon_filepc_h.png')\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;debugger;\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item.code&nbsp;==&nbsp;&quot;Look&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNotNullOrEmpty(row.modifystatus&nbsp;)&nbsp;&&row.modifystatus&nbsp;==&nbsp;20)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n};\n\n\n\r\n \r\n};"},{"isHide":false,"name":"EntityType","value":"ManuscriptItem"},{"isHide":false,"name":"pagination","value":"false"},{"isHide":false,"name":"striped","value":"true"},{"isHide":false,"name":"rownumbers","value":"false"}],"sort":0,"sql":"select&nbsp;ItemVersion,Modifystatus,ManuscriptFileRelativePath,ManuscriptFile,isnull(IndexNumber,'')&nbsp;+&nbsp;ManuscriptDisplayName&nbsp;as&nbsp;'ManuscriptDisplayName'\n,CompilingPersonSignName,FirstLevelReviewerSignName,Id,FirstLevelReviewerSignTime,FirstLevelReviewerSignID\n,CompilingPersonSignTime,CompilingPersonSignID,ParentStructureCode,StructureCode,ManuscriptCode,SortNO\n,FiscalYear,FiscalYearInforID,AuditworkProjectID,Timestamp,uuid&nbsp;as&nbsp;manuscriptItemId\n,(select&nbsp;count(*)from&nbsp;Prj_AuditFilesVSManuscript&nbsp;am,Prj_AuditFiles&nbsp;a\n&nbsp;where&nbsp;am.auditworkProjectID=&nbsp;b.auditworkProjectID\n&nbsp;and&nbsp;am.manuscriptitemID&nbsp;=b.uuid&nbsp;and&nbsp;am.auditworkProjectID&nbsp;=&nbsp;a.auditworkProjectID\n&nbsp;and&nbsp;am.auditFilesID&nbsp;=a.uuid&nbsp;)&nbsp;as&nbsp;Has\nfrom&nbsp;dbo.Prj_ManuscriptItem&nbsp;b&nbsp;\nwhere&nbsp;({fiscalYear}&nbsp;=0&nbsp;or&nbsp;({fiscalYear}!=0&nbsp;and&nbsp;FiscalYear&nbsp;=&nbsp;{fiscalYear}))\nand&nbsp;AuditworkProjectID={auditworkProjectID}&nbsp;and&nbsp;IsGroup='0'&nbsp;and&nbsp;ParentStructureCode={parentStructureCode}\nand&nbsp;IsSelected='1'&nbsp;and&nbsp;IsDisplay='1'&nbsp;and&nbsp;ModifyStatus&nbsp;!=30&nbsp;and&nbsp;TheColor&nbsp;in&nbsp;('Blue','Black')"}
2020-04-25 16:02:11