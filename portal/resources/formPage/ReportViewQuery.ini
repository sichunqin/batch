{
	"action":[
		{
			"code":"AddReport",
			"name":"添加",
			"property":[
				{
					"isHide":false,
					"name":"AuthorityRemark",
					"value":"业务报告-新增报告-按钮"
				},
				{
					"isHide":false,
					"name":"OnClick",
					"value":"AddReportOnClick"
				},
				{
					"isHide":false,
					"name":"JavaScript",
					"value":"var registerJavaScript = function () {

 

this.AddReportOnClick = function () {
    var me = this;
    if(!AppContext.Profile.departmentalAttributes){
      Framework.Message('职能部门,不允许维护报告');
      return false;
    }
    var url = "UIForm-Web-Schema.json";
    parameter = {};
    parameter.schemaType = "FormPanel";
    parameter.schemaCode = "ReportAdd";
    parameter.workFlowTypeId = "24616";
    var tops = this.Top();
    var tree = tops.DownForCode("compositionCustomer");
    var selected = tree ? tree.GetSelected() : {};
\tvar params = {};
\tparams.parentId = selected.parentId;
\tparams.managerId = selected.compositionCustomerId_projectManagerId;
\tparams.userId = AppContext.Profile.id;
\tvar flag = false;
\tFramework.AjaxRequest (me,"Report-addReportControl.do",'get',params,false,function(result){
\t\tflag = result;
\t});
    if(flag){
       Framework.Message("您没有权限新增报告，子分公司项目经理只能发起自己负责项目的报告!");
       return;
    }

    if (Framework.IsNullOrEmpty(selected) || Framework.IsNullOrEmpty(selected.id)) {
        Framework.Message("请选择被审计单位!");
        return false;
    }

    Framework.OpenForm(me.ParentNode, url, parameter, function (form) {
        form.TreeSelected = selected;
        form.IsAdd = true;
        form.IsManualReport = false;
        if (form.Load) form.Load();
    });
}

 

};"
				}
			],
			"sort":0
		},
		{
			"code":"Delete",
			"name":"删除",
			"property":[
				{
					"isHide":false,
					"name":"IsRenderColumn",
					"value":"true"
				},
				{
					"isHide":false,
					"name":"ActionGroup",
					"value":"操作"
				},
				{
					"isHide":false,
					"name":"AuthorityRemark",
					"value":"业务报告-删除报告-按钮"
				},
				{
					"isHide":false,
					"name":"LinkImg",
					"value":"/Styles/icons/index/icon_delete.png"
				},
				{
					"isHide":false,
					"name":"JavaScript",
					"value":"var registerJavaScript = function () {

 

this.BeforeHandler = function () {
    var me = this;
    if(!AppContext.Profile.departmentalAttributes){
      Framework.Message('职能部门,不允许维护报告');
      return false;
    }
    if (me.ParentNode && me.ParentNode.LinkSelectData && me.ParentNode.LinkSelectData.modificatioTimes > 0) {
        me.confirmmessage = "报告存在相关修改记录，是否确认删除？";
    }
}

 

};"
				}
			],
			"sort":3
		},
		{
			"code":"ManualReport",
			"name":"手动发号",
			"property":[
				{
					"isHide":false,
					"name":"AuthorityRemark",
					"value":"业务报告-手动放号"
				},
				{
					"isHide":false,
					"name":"OnClick",
					"value":"ManualReportOnClick"
				},
				{
					"isHide":false,
					"name":"JavaScript",
					"value":"var registerJavaScript = function () {

 

this.ManualReportOnClick= function () {
    var me = this;
    if(!AppContext.Profile.departmentalAttributes){
      Framework.Message('职能部门,不允许维护报告');
      return false;
    }
    var url = "UIForm-Web-Schema.json";
    parameter = {};
    parameter.schemaType = "FormPanel";
    parameter.schemaCode = "ReportAdd";
    parameter.workFlowTypeId = "24616";
    var tops = this.Top();
    var tree = tops.DownForCode("compositionCustomer");
    var selected = tree ? tree.GetSelected() : {};
    var params = {};
\tparams.parentId = selected.parentId;
\tparams.managerId = selected.compositionCustomerId_projectManagerId;
\tparams.userId = AppContext.Profile.id;
\tvar flag = false;
\tFramework.AjaxRequest (me,"Report-addReportControl.do",'get',params,false,function(result){
\t\tflag = result;
\t});
    if(flag){
       Framework.Message("您没有权限新增报告，子分公司项目经理只能发起自己负责项目的报告!");
       return;
    }
    if (Framework.IsNullOrEmpty(selected) || Framework.IsNullOrEmpty(selected.id)) {
        Framework.Message("请选择被审计单位!");
        return false;
    }

    Framework.OpenForm(me.ParentNode, url, parameter, function (form) {
        form.TreeSelected = selected;
        form.IsAdd = true;
        form.IsManualReport = true;
        if (form.Load) form.Load();
    });
}

 

};"
				}
			],
			"sort":2
		},
		{
			"code":"Back",
			"name":"Back",
			"property":[
				
			],
			"sort":1
		}
	],
	"authority":[
		
	],
	"children":[
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"id",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"主键",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":16
						},
						{
							"isHide":false,
							"name":"Required",
							"value":true
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"Id",
					"sort":2
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"reportIssueValue",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"总/分所出具报告",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":50
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"width",
							"value":"220"
						}
					],
					"select":"ReportIssueValue",
					"sort":10
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"reportCode",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"报告文号",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":200
						},
						{
							"isHide":false,
							"name":"Required",
							"value":true
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsRenderLink",
							"value":"true"
						},
						{
							"isHide":false,
							"name":"SchemaCode",
							"value":"ReportAdd"
						},
						{
							"isHide":false,
							"name":"width",
							"value":"300"
						}
					],
					"select":"ReportCode",
					"sort":6
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"reportTypeId",
					"control":"GridCombobox",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"报告类型",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":200
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"EntityConfig",
							"value":"[Entity(ReportType|Code(Code)#Name(Name))]"
						},
						{
							"isHide":false,
							"name":"EntityCode",
							"value":"ReportType"
						},
						{
							"isHide":false,
							"name":"width",
							"value":"160"
						}
					],
					"select":"ReportTypeId[Entity(ReportType|Code(Code)#Name(Name))]",
					"sort":7
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"auditOpinion",
					"control":"Combobox",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"审计意见",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":4
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"EnumType",
							"value":"AuditOpinion"
						},
						{
							"isHide":false,
							"name":"EntityConfig",
							"value":"[Enum(AuditOpinion)]"
						},
						{
							"isHide":false,
							"name":"width",
							"value":"300"
						}
					],
					"select":"AuditOpinion[Enum(AuditOpinion)]",
					"sort":9
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"remarks",
					"control":"TextArea",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"备注",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":500
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"width",
							"value":"200"
						},
						{
							"isHide":false,
							"name":"halign",
							"value":"center"
						},
						{
							"isHide":false,
							"name":"align",
							"value":"left"
						}
					],
					"select":"Remarks",
					"sort":11
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"timestamp",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"时间戳",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":8
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"Timestamp",
					"sort":3
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"compositionCustomerId_riskLevel",
					"control":"Combobox",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"风险等级",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"EnumType",
							"value":"RiskLevel"
						},
						{
							"isHide":false,
							"name":"width",
							"value":"80"
						}
					],
					"sort":8
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"docState",
					"control":"Combobox",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"报告状态",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":16
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":true
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"EnumType",
							"value":"ReportDocStatus"
						},
						{
							"isHide":false,
							"name":"EntityConfig",
							"value":"[Enum(ReportDocStatus)]"
						},
						{
							"isHide":false,
							"name":"width",
							"value":"120"
						}
					],
					"select":"DocState[Enum(ReportDocStatus)]",
					"sort":5
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"compositionCustomerId",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"被审计单位",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":16
						},
						{
							"isHide":false,
							"name":"Required",
							"value":true
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"EntityCode",
							"value":"CompositionCustomer"
						}
					],
					"select":"CompositionCustomerId",
					"sort":4
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"modificatioTimes",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"修改次数",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":5
						},
						{
							"isHide":false,
							"name":"Required",
							"value":true
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"ModificatioTimes",
					"sort":12
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"businessSubclasses",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"业务子类",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":4
						},
						{
							"isHide":false,
							"name":"Required",
							"value":true
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"BusinessSubclasses",
					"sort":13
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"deptId",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"部门",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":16
						},
						{
							"isHide":false,
							"name":"Required",
							"value":true
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"EntityConfig",
							"value":"[Entity(Department|Code(Code)#Name(Name))]"
						},
						{
							"isHide":false,
							"name":"EntityCode",
							"value":"Department"
						}
					],
					"select":"DeptId[Entity(Department|Code(Code)#Name(Name))]",
					"sort":14
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"deptId_masterId",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"部门经理",
					"otherChildren":[
						
					],
					"property":[
						
					],
					"sort":15
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"createdById",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"创建人id",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":16
						},
						{
							"isHide":false,
							"name":"Required",
							"value":true
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"EntityConfig",
							"value":"[Entity(User|Code(Code)#Name(Name))]"
						},
						{
							"isHide":false,
							"name":"EntityCode",
							"value":"User"
						}
					],
					"select":"CreatedById[Entity(User|Code(Code)#Name(Name))]",
					"sort":1
				}
			],
			"code":"columnGroup",
			"control":"ColumnGroup",
			"dataPermission":[
				
			],
			"isReference":false,
			"javaScript":"",
			"name":"列集合",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":0
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"uuid",
			"control":"Hidden",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"uuid",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":1000
		}
	],
	"code":"reportViewQuery",
	"control":"GridPanel",
	"dataPermission":[
		
	],
	"isReference":false,
	"javaScript":"this.OpenLinkForm = function (row,feild,schemacode) {
    var me = this;
   console.log("123");
    var url = "UIForm-Web-Schema.json";
    parameter = {};
    parameter.schemaType = "FormPanel";
    parameter.schemaCode = schemacode;
    parameter.workFlowTypeId = "24616";
    parameter.modifyReadOnly = true;
    Framework.OpenForm(me, url, parameter, function (form) {
        form.IsAdd = false;
        if (form.Load) form.Load(row);
    });
}

this.SetActionColumnVisible = function (item, row) {
    if (item.code == "Delete" && row.docState.id != 10 && row.docState.id != 100)
        return true;

    var profile = AppContext.Profile

    if (item.code == "Delete" && !profile.isSuperAdmin) {//是管理员都有删除按钮
         /☆if ((row.docState.id == 10 || row.docState.id == 100) && row.businessSubclasses >= 1000)
             return true;
           if ((row.docState.id == 10 || row.docState.id == 100) && row.businessSubclasses < 1000 && !(Framework.IsNotNullOrEmpty(row.deptId_masterId) && row.deptId_masterId.id == profile.id) && row.createdById.id != profile.id)
            return true;☆/
        if ((row.docState.id == 10 || row.docState.id == 100) && row.businessSubclasses == 1000)
             return true;
        if ((row.docState.id == 10 || row.docState.id == 100) && (row.businessSubclasses < 1000 || row.businessSubclasses == 1001) && !(Framework.IsNotNullOrEmpty(row.deptId_masterId) && row.deptId_masterId.id == profile.id) && row.createdById.id != profile.id)
            return true;
    }
}
this.RenderColumnTextStyler = function (row, flied, value) {
console.log('xyp', 123)
    if (flied == "compositionCustomerId_riskLevel") {
        if (value.id == 10)
            return '#e41303';
        if (value.id == 20)
            return '#ffbc1a';
        if (value.id == 30)
            return '#46aaff';

        if (value.id == 40)
            return '#5cdfb3';
    }
}


 

this.BeforeLoad = function () {
    var me = this;

    console.log("dBeforeLoad 业务报告");
    var tree = this.Top().DownForCode("compositionCustomerTreeQuery");
    var params = {};
    params.param = "CompositionCustomerId";
    params.value =  tree.GetSelected().id;
    this.params = JSON.stringify(params);
};

this.OpenLinkForm = function (row) {
    var me = this;
    var url = "UIForm-Web-Schema.json";
    parameter = {};
    parameter.schemaType = "FormPanel";
    parameter.schemaCode = "ReportAdd";
    parameter.ReadOnly = true;
    me.OpenEmbedForm(me, url, parameter, function (form) {
        form.IsAdd = false;
        if (form.Load) form.Load(row);
    });
}",
	"name":"业务报告查看",
	"otherChildren":[
		
	],
	"property":[
		{
			"isHide":false,
			"name":"BaseCode",
			"value":"reportView"
		},
		{
			"isHide":false,
			"name":"Name",
			"value":"业务报告查看"
		},
		{
			"isHide":false,
			"name":"IsReadOnly",
			"value":true
		},
		{
			"isHide":false,
			"name":"Description"
		},
		{
			"isHide":false,
			"name":"FormId",
			"value":343096
		},
		{
			"isHide":false,
			"name":"OrderBy"
		},
		{
			"isHide":false,
			"name":"IsSqlForm",
			"value":false
		},
		{
			"isHide":false,
			"name":"JavaScript",
			"value":"var registerJavaScript = function () {

 

this.OpenLinkForm = function (row,feild,schemacode) {
    var me = this;
   console.log("123");
    var url = "UIForm-Web-Schema.json";
    parameter = {};
    parameter.schemaType = "FormPanel";
    parameter.schemaCode = schemacode;
    parameter.workFlowTypeId = "24616";
    parameter.modifyReadOnly = true;
    Framework.OpenForm(me, url, parameter, function (form) {
        form.IsAdd = false;
        if (form.Load) form.Load(row);
    });
}

this.SetActionColumnVisible = function (item, row) {
    if (item.code == "Delete" && row.docState.id != 10 && row.docState.id != 100)
        return true;

    var profile = AppContext.Profile

    if (item.code == "Delete" && !profile.isSuperAdmin) {//是管理员都有删除按钮
         /☆if ((row.docState.id == 10 || row.docState.id == 100) && row.businessSubclasses >= 1000)
             return true;
           if ((row.docState.id == 10 || row.docState.id == 100) && row.businessSubclasses < 1000 && !(Framework.IsNotNullOrEmpty(row.deptId_masterId) && row.deptId_masterId.id == profile.id) && row.createdById.id != profile.id)
            return true;☆/
        if ((row.docState.id == 10 || row.docState.id == 100) && row.businessSubclasses == 1000)
             return true;
        if ((row.docState.id == 10 || row.docState.id == 100) && (row.businessSubclasses < 1000 || row.businessSubclasses == 1001) && !(Framework.IsNotNullOrEmpty(row.deptId_masterId) && row.deptId_masterId.id == profile.id) && row.createdById.id != profile.id)
            return true;
    }
}
this.RenderColumnTextStyler = function (row, flied, value) {
console.log('xyp', 123)
    if (flied == "compositionCustomerId_riskLevel") {
        if (value.id == 10)
            return '#e41303';
        if (value.id == 20)
            return '#ffbc1a';
        if (value.id == 30)
            return '#46aaff';

        if (value.id == 40)
            return '#5cdfb3';
    }
}


 

this.BeforeLoad = function () {
    var me = this;

    console.log("dBeforeLoad 业务报告");
    var tree = this.Top().DownForCode("compositionCustomerTreeQuery");
    var params = {};
    params.param = "CompositionCustomerId";
    params.value =  tree.GetSelected().id;
    this.params = JSON.stringify(params);
};

this.OpenLinkForm = function (row) {
    var me = this;
    var url = "UIForm-Web-Schema.json";
    parameter = {};
    parameter.schemaType = "FormPanel";
    parameter.schemaCode = "ReportAdd";
    parameter.ReadOnly = true;
    me.OpenEmbedForm(me, url, parameter, function (form) {
        form.IsAdd = false;
        if (form.Load) form.Load(row);
    });
}

 

};"
		},
		{
			"isHide":false,
			"name":"EntityType",
			"value":"Report"
		},
		{
			"isHide":false,
			"name":"WorkFlowForm",
			"value":"true"
		}
	],
	"sort":0
}
{"action":[{"code":"AddReport","name":"添加","property":[{"isHide":false,"name":"AuthorityRemark","value":"业务报告-新增报告-按钮"},{"isHide":false,"name":"OnClick","value":"AddReportOnClick"},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.AddReportOnClick&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;if(!AppContext.Profile.departmentalAttributes){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message('职能部门,不允许维护报告');\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;UIForm-Web-Schema.json&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaType&nbsp;=&nbsp;&quot;FormPanel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaCode&nbsp;=&nbsp;&quot;ReportAdd&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.workFlowTypeId&nbsp;=&nbsp;&quot;24616&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tops&nbsp;=&nbsp;this.Top();\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tree&nbsp;=&nbsp;tops.DownForCode(&quot;compositionCustomer&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;selected&nbsp;=&nbsp;tree&nbsp;?&nbsp;tree.GetSelected()&nbsp;:&nbsp;{};\n\tvar&nbsp;params&nbsp;=&nbsp;{};\n\tparams.parentId&nbsp;=&nbsp;selected.parentId;\n\tparams.managerId&nbsp;=&nbsp;selected.compositionCustomerId_projectManagerId;\n\tparams.userId&nbsp;=&nbsp;AppContext.Profile.id;\n\tvar&nbsp;flag&nbsp;=&nbsp;false;\n\tFramework.AjaxRequest&nbsp;(me,&quot;Report-addReportControl.do&quot;,'get',params,false,function(result){\n\t\tflag&nbsp;=&nbsp;result;\n\t});\n&nbsp;&nbsp;&nbsp;&nbsp;if(flag){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;您没有权限新增报告，子分公司项目经理只能发起自己负责项目的报告!&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(selected)&nbsp;||&nbsp;Framework.IsNullOrEmpty(selected.id))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;请选择被审计单位!&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.OpenForm(me.ParentNode,&nbsp;url,&nbsp;parameter,&nbsp;function&nbsp;(form)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.TreeSelected&nbsp;=&nbsp;selected;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.IsAdd&nbsp;=&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.IsManualReport&nbsp;=&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(form.Load)&nbsp;form.Load();\n&nbsp;&nbsp;&nbsp;&nbsp;});\n}\r\n \r\n};"}],"sort":0},{"code":"Delete","name":"删除","property":[{"isHide":false,"name":"IsRenderColumn","value":"true"},{"isHide":false,"name":"ActionGroup","value":"操作"},{"isHide":false,"name":"AuthorityRemark","value":"业务报告-删除报告-按钮"},{"isHide":false,"name":"LinkImg","value":"/Styles/icons/index/icon_delete.png"},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.BeforeHandler&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;if(!AppContext.Profile.departmentalAttributes){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message('职能部门,不允许维护报告');\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(me.ParentNode&nbsp;&&&nbsp;me.ParentNode.LinkSelectData&nbsp;&&&nbsp;me.ParentNode.LinkSelectData.modificatioTimes&nbsp;&gt;&nbsp;0)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;me.confirmmessage&nbsp;=&nbsp;&quot;报告存在相关修改记录，是否确认删除？&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}\r\n \r\n};"}],"sort":3},{"code":"ManualReport","name":"手动发号","property":[{"isHide":false,"name":"AuthorityRemark","value":"业务报告-手动放号"},{"isHide":false,"name":"OnClick","value":"ManualReportOnClick"},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.ManualReportOnClick=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;if(!AppContext.Profile.departmentalAttributes){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message('职能部门,不允许维护报告');\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;UIForm-Web-Schema.json&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaType&nbsp;=&nbsp;&quot;FormPanel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaCode&nbsp;=&nbsp;&quot;ReportAdd&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.workFlowTypeId&nbsp;=&nbsp;&quot;24616&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tops&nbsp;=&nbsp;this.Top();\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tree&nbsp;=&nbsp;tops.DownForCode(&quot;compositionCustomer&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;selected&nbsp;=&nbsp;tree&nbsp;?&nbsp;tree.GetSelected()&nbsp;:&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;{};\n\tparams.parentId&nbsp;=&nbsp;selected.parentId;\n\tparams.managerId&nbsp;=&nbsp;selected.compositionCustomerId_projectManagerId;\n\tparams.userId&nbsp;=&nbsp;AppContext.Profile.id;\n\tvar&nbsp;flag&nbsp;=&nbsp;false;\n\tFramework.AjaxRequest&nbsp;(me,&quot;Report-addReportControl.do&quot;,'get',params,false,function(result){\n\t\tflag&nbsp;=&nbsp;result;\n\t});\n&nbsp;&nbsp;&nbsp;&nbsp;if(flag){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;您没有权限新增报告，子分公司项目经理只能发起自己负责项目的报告!&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(selected)&nbsp;||&nbsp;Framework.IsNullOrEmpty(selected.id))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;请选择被审计单位!&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.OpenForm(me.ParentNode,&nbsp;url,&nbsp;parameter,&nbsp;function&nbsp;(form)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.TreeSelected&nbsp;=&nbsp;selected;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.IsAdd&nbsp;=&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.IsManualReport&nbsp;=&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(form.Load)&nbsp;form.Load();\n&nbsp;&nbsp;&nbsp;&nbsp;});\n}\r\n \r\n};"}],"sort":2},{"code":"Back","name":"Back","property":[],"sort":1}],"authority":[],"children":[{"action":[],"authority":[],"children":[{"action":[],"authority":[],"children":[],"code":"id","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"主键","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":16},{"isHide":false,"name":"Required","value":true},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"Id","sort":2},{"action":[],"authority":[],"children":[],"code":"reportIssueValue","control":"Text","dataPermission":[],"isReference":false,"name":"总/分所出具报告","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":50},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"width","value":"220"}],"select":"ReportIssueValue","sort":10},{"action":[],"authority":[],"children":[],"code":"reportCode","control":"Text","dataPermission":[],"isReference":false,"name":"报告文号","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":200},{"isHide":false,"name":"Required","value":true},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"IsRenderLink","value":"true"},{"isHide":false,"name":"SchemaCode","value":"ReportAdd"},{"isHide":false,"name":"width","value":"300"}],"select":"ReportCode","sort":6},{"action":[],"authority":[],"children":[],"code":"reportTypeId","control":"GridCombobox","dataPermission":[],"isReference":false,"name":"报告类型","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":200},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"EntityConfig","value":"[Entity(ReportType|Code(Code)#Name(Name))]"},{"isHide":false,"name":"EntityCode","value":"ReportType"},{"isHide":false,"name":"width","value":"160"}],"select":"ReportTypeId[Entity(ReportType|Code(Code)#Name(Name))]","sort":7},{"action":[],"authority":[],"children":[],"code":"auditOpinion","control":"Combobox","dataPermission":[],"isReference":false,"name":"审计意见","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":4},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"EnumType","value":"AuditOpinion"},{"isHide":false,"name":"EntityConfig","value":"[Enum(AuditOpinion)]"},{"isHide":false,"name":"width","value":"300"}],"select":"AuditOpinion[Enum(AuditOpinion)]","sort":9},{"action":[],"authority":[],"children":[],"code":"remarks","control":"TextArea","dataPermission":[],"isReference":false,"name":"备注","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":500},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"width","value":"200"},{"isHide":false,"name":"halign","value":"center"},{"isHide":false,"name":"align","value":"left"}],"select":"Remarks","sort":11},{"action":[],"authority":[],"children":[],"code":"timestamp","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"时间戳","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":8},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"Timestamp","sort":3},{"action":[],"authority":[],"children":[],"code":"compositionCustomerId_riskLevel","control":"Combobox","dataPermission":[],"isReference":false,"name":"风险等级","otherChildren":[],"property":[{"isHide":false,"name":"EnumType","value":"RiskLevel"},{"isHide":false,"name":"width","value":"80"}],"sort":8},{"action":[],"authority":[],"children":[],"code":"docState","control":"Combobox","dataPermission":[],"isReference":false,"name":"报告状态","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":16},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":true},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"EnumType","value":"ReportDocStatus"},{"isHide":false,"name":"EntityConfig","value":"[Enum(ReportDocStatus)]"},{"isHide":false,"name":"width","value":"120"}],"select":"DocState[Enum(ReportDocStatus)]","sort":5},{"action":[],"authority":[],"children":[],"code":"compositionCustomerId","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"被审计单位","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":16},{"isHide":false,"name":"Required","value":true},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"EntityCode","value":"CompositionCustomer"}],"select":"CompositionCustomerId","sort":4},{"action":[],"authority":[],"children":[],"code":"modificatioTimes","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"修改次数","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":5},{"isHide":false,"name":"Required","value":true},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"ModificatioTimes","sort":12},{"action":[],"authority":[],"children":[],"code":"businessSubclasses","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"业务子类","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":4},{"isHide":false,"name":"Required","value":true},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"BusinessSubclasses","sort":13},{"action":[],"authority":[],"children":[],"code":"deptId","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"部门","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":16},{"isHide":false,"name":"Required","value":true},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"EntityConfig","value":"[Entity(Department|Code(Code)#Name(Name))]"},{"isHide":false,"name":"EntityCode","value":"Department"}],"select":"DeptId[Entity(Department|Code(Code)#Name(Name))]","sort":14},{"action":[],"authority":[],"children":[],"code":"deptId_masterId","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"部门经理","otherChildren":[],"property":[],"sort":15},{"action":[],"authority":[],"children":[],"code":"createdById","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"创建人id","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":16},{"isHide":false,"name":"Required","value":true},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"EntityConfig","value":"[Entity(User|Code(Code)#Name(Name))]"},{"isHide":false,"name":"EntityCode","value":"User"}],"select":"CreatedById[Entity(User|Code(Code)#Name(Name))]","sort":1}],"code":"columnGroup","control":"ColumnGroup","dataPermission":[],"isReference":false,"javaScript":"","name":"列集合","otherChildren":[],"property":[],"sort":0},{"action":[],"authority":[],"children":[],"code":"uuid","control":"Hidden","dataPermission":[],"isReference":false,"name":"uuid","otherChildren":[],"property":[],"sort":1000}],"code":"reportViewQuery","control":"GridPanel","dataPermission":[],"isReference":false,"javaScript":"this.OpenLinkForm&nbsp;=&nbsp;function&nbsp;(row,feild,schemacode)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;console.log(&quot;123&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;UIForm-Web-Schema.json&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaType&nbsp;=&nbsp;&quot;FormPanel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaCode&nbsp;=&nbsp;schemacode;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.workFlowTypeId&nbsp;=&nbsp;&quot;24616&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.modifyReadOnly&nbsp;=&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.OpenForm(me,&nbsp;url,&nbsp;parameter,&nbsp;function&nbsp;(form)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.IsAdd&nbsp;=&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(form.Load)&nbsp;form.Load(row);\n&nbsp;&nbsp;&nbsp;&nbsp;});\n}\n\nthis.SetActionColumnVisible&nbsp;=&nbsp;function&nbsp;(item,&nbsp;row)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item.code&nbsp;==&nbsp;&quot;Delete&quot;&nbsp;&&&nbsp;row.docState.id&nbsp;!=&nbsp;10&nbsp;&&&nbsp;row.docState.id&nbsp;!=&nbsp;100)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;profile&nbsp;=&nbsp;AppContext.Profile\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item.code&nbsp;==&nbsp;&quot;Delete&quot;&nbsp;&&&nbsp;!profile.isSuperAdmin)&nbsp;{//是管理员都有删除按钮\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*if&nbsp;((row.docState.id&nbsp;==&nbsp;10&nbsp;||&nbsp;row.docState.id&nbsp;==&nbsp;100)&nbsp;&&&nbsp;row.businessSubclasses&nbsp;&gt;=&nbsp;1000)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((row.docState.id&nbsp;==&nbsp;10&nbsp;||&nbsp;row.docState.id&nbsp;==&nbsp;100)&nbsp;&&&nbsp;row.businessSubclasses&nbsp;&lt;&nbsp;1000&nbsp;&&&nbsp;!(Framework.IsNotNullOrEmpty(row.deptId_masterId)&nbsp;&&&nbsp;row.deptId_masterId.id&nbsp;==&nbsp;profile.id)&nbsp;&&&nbsp;row.createdById.id&nbsp;!=&nbsp;profile.id)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;*/\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((row.docState.id&nbsp;==&nbsp;10&nbsp;||&nbsp;row.docState.id&nbsp;==&nbsp;100)&nbsp;&&&nbsp;row.businessSubclasses&nbsp;==&nbsp;1000)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((row.docState.id&nbsp;==&nbsp;10&nbsp;||&nbsp;row.docState.id&nbsp;==&nbsp;100)&nbsp;&&&nbsp;(row.businessSubclasses&nbsp;&lt;&nbsp;1000&nbsp;||&nbsp;row.businessSubclasses&nbsp;==&nbsp;1001)&nbsp;&&&nbsp;!(Framework.IsNotNullOrEmpty(row.deptId_masterId)&nbsp;&&&nbsp;row.deptId_masterId.id&nbsp;==&nbsp;profile.id)&nbsp;&&&nbsp;row.createdById.id&nbsp;!=&nbsp;profile.id)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}\nthis.RenderColumnTextStyler&nbsp;=&nbsp;function&nbsp;(row,&nbsp;flied,&nbsp;value)&nbsp;{\nconsole.log('xyp',&nbsp;123)\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(flied&nbsp;==&nbsp;&quot;compositionCustomerId_riskLevel&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;10)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#e41303';\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;20)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#ffbc1a';\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;30)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#46aaff';\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;40)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#5cdfb3';\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}\n\r\n \r\nthis.BeforeLoad&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;dBeforeLoad 业务报告&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tree&nbsp;=&nbsp;this.Top().DownForCode(&quot;compositionCustomerTreeQuery&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;params.param&nbsp;=&nbsp;&quot;CompositionCustomerId&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;params.value&nbsp;=&nbsp;&nbsp;tree.GetSelected().id;\n&nbsp;&nbsp;&nbsp;&nbsp;this.params&nbsp;=&nbsp;JSON.stringify(params);\n};\n\nthis.OpenLinkForm&nbsp;=&nbsp;function&nbsp;(row)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;UIForm-Web-Schema.json&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaType&nbsp;=&nbsp;&quot;FormPanel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaCode&nbsp;=&nbsp;&quot;ReportAdd&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.ReadOnly&nbsp;=&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;me.OpenEmbedForm(me,&nbsp;url,&nbsp;parameter,&nbsp;function&nbsp;(form)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.IsAdd&nbsp;=&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(form.Load)&nbsp;form.Load(row);\n&nbsp;&nbsp;&nbsp;&nbsp;});\n}","name":"业务报告查看","otherChildren":[],"property":[{"isHide":false,"name":"BaseCode","value":"reportView"},{"isHide":false,"name":"Name","value":"业务报告查看"},{"isHide":false,"name":"IsReadOnly","value":true},{"isHide":false,"name":"Description"},{"isHide":false,"name":"FormId","value":343096},{"isHide":false,"name":"OrderBy"},{"isHide":false,"name":"IsSqlForm","value":false},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.OpenLinkForm&nbsp;=&nbsp;function&nbsp;(row,feild,schemacode)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;console.log(&quot;123&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;UIForm-Web-Schema.json&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaType&nbsp;=&nbsp;&quot;FormPanel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaCode&nbsp;=&nbsp;schemacode;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.workFlowTypeId&nbsp;=&nbsp;&quot;24616&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.modifyReadOnly&nbsp;=&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.OpenForm(me,&nbsp;url,&nbsp;parameter,&nbsp;function&nbsp;(form)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.IsAdd&nbsp;=&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(form.Load)&nbsp;form.Load(row);\n&nbsp;&nbsp;&nbsp;&nbsp;});\n}\n\nthis.SetActionColumnVisible&nbsp;=&nbsp;function&nbsp;(item,&nbsp;row)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item.code&nbsp;==&nbsp;&quot;Delete&quot;&nbsp;&&&nbsp;row.docState.id&nbsp;!=&nbsp;10&nbsp;&&&nbsp;row.docState.id&nbsp;!=&nbsp;100)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;profile&nbsp;=&nbsp;AppContext.Profile\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(item.code&nbsp;==&nbsp;&quot;Delete&quot;&nbsp;&&&nbsp;!profile.isSuperAdmin)&nbsp;{//是管理员都有删除按钮\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/*if&nbsp;((row.docState.id&nbsp;==&nbsp;10&nbsp;||&nbsp;row.docState.id&nbsp;==&nbsp;100)&nbsp;&&&nbsp;row.businessSubclasses&nbsp;&gt;=&nbsp;1000)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((row.docState.id&nbsp;==&nbsp;10&nbsp;||&nbsp;row.docState.id&nbsp;==&nbsp;100)&nbsp;&&&nbsp;row.businessSubclasses&nbsp;&lt;&nbsp;1000&nbsp;&&&nbsp;!(Framework.IsNotNullOrEmpty(row.deptId_masterId)&nbsp;&&&nbsp;row.deptId_masterId.id&nbsp;==&nbsp;profile.id)&nbsp;&&&nbsp;row.createdById.id&nbsp;!=&nbsp;profile.id)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;*/\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((row.docState.id&nbsp;==&nbsp;10&nbsp;||&nbsp;row.docState.id&nbsp;==&nbsp;100)&nbsp;&&&nbsp;row.businessSubclasses&nbsp;==&nbsp;1000)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((row.docState.id&nbsp;==&nbsp;10&nbsp;||&nbsp;row.docState.id&nbsp;==&nbsp;100)&nbsp;&&&nbsp;(row.businessSubclasses&nbsp;&lt;&nbsp;1000&nbsp;||&nbsp;row.businessSubclasses&nbsp;==&nbsp;1001)&nbsp;&&&nbsp;!(Framework.IsNotNullOrEmpty(row.deptId_masterId)&nbsp;&&&nbsp;row.deptId_masterId.id&nbsp;==&nbsp;profile.id)&nbsp;&&&nbsp;row.createdById.id&nbsp;!=&nbsp;profile.id)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}\nthis.RenderColumnTextStyler&nbsp;=&nbsp;function&nbsp;(row,&nbsp;flied,&nbsp;value)&nbsp;{\nconsole.log('xyp',&nbsp;123)\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(flied&nbsp;==&nbsp;&quot;compositionCustomerId_riskLevel&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;10)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#e41303';\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;20)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#ffbc1a';\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;30)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#46aaff';\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;40)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#5cdfb3';\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}\n\r\n \r\nthis.BeforeLoad&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;dBeforeLoad 业务报告&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tree&nbsp;=&nbsp;this.Top().DownForCode(&quot;compositionCustomerTreeQuery&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;params.param&nbsp;=&nbsp;&quot;CompositionCustomerId&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;params.value&nbsp;=&nbsp;&nbsp;tree.GetSelected().id;\n&nbsp;&nbsp;&nbsp;&nbsp;this.params&nbsp;=&nbsp;JSON.stringify(params);\n};\n\nthis.OpenLinkForm&nbsp;=&nbsp;function&nbsp;(row)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;UIForm-Web-Schema.json&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaType&nbsp;=&nbsp;&quot;FormPanel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaCode&nbsp;=&nbsp;&quot;ReportAdd&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.ReadOnly&nbsp;=&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;me.OpenEmbedForm(me,&nbsp;url,&nbsp;parameter,&nbsp;function&nbsp;(form)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.IsAdd&nbsp;=&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(form.Load)&nbsp;form.Load(row);\n&nbsp;&nbsp;&nbsp;&nbsp;});\n}\r\n \r\n};"},{"isHide":false,"name":"EntityType","value":"Report"},{"isHide":false,"name":"WorkFlowForm","value":"true"}],"sort":0}
2020-04-02 21:41:54