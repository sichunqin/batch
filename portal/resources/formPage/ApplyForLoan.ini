{
	"action":[
		
	],
	"authority":[
		
	],
	"children":[
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"id",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"主键",
					"otherChildren":[
						
					],
					"property":[
						
					],
					"sort":6
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"numberOfBorrowings",
					"control":"Number",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"借阅次数",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"80"
						}
					],
					"sort":5
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"bookNumber",
					"control":"Number",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"纸质底稿总册数",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"140"
						}
					],
					"sort":4
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"boxNumber",
					"control":"Number",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"纸质底稿总盒数",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"140"
						}
					],
					"sort":3
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"showName",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"项目名称",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"IsRenderLink",
							"value":"true"
						},
						{
							"isHide":false,
							"name":"SchemaCode",
							"value":"ApplyForLoanForm"
						},
						{
							"isHide":false,
							"name":"WorkFlowTypeId",
							"value":"24619"
						},
						{
							"isHide":false,
							"name":"Width",
							"value":"400"
						},
						{
							"isHide":false,
							"name":"align",
							"value":"left"
						}
					],
					"sort":8
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"deptIdName",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"部门",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"160"
						}
					],
					"sort":12
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"businessTypeValue",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"业务类型",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"160"
						}
					],
					"sort":11
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"customerTypeValue",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"客户类型",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"300"
						},
						{
							"isHide":false,
							"name":"align",
							"value":"left"
						}
					],
					"sort":10
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"riskLevel",
					"control":"Combobox",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"风险等级",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"EnumType",
							"value":"RiskLevel"
						},
						{
							"isHide":false,
							"name":"Width",
							"value":"80"
						}
					],
					"sort":9
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"code",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"项目编号",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"160"
						}
					],
					"sort":7
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"auditEnd",
					"control":"Date",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"审计期间结束日",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"140"
						}
					],
					"sort":15
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"auditStart",
					"control":"Date",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"审计期间开始日",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"140"
						}
					],
					"sort":14
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"deptId",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"DeptId",
					"otherChildren":[
						
					],
					"property":[
						
					],
					"sort":2
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"maCode",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"档案号",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"160"
						}
					],
					"sort":1
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"archiveDate",
					"control":"Date",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"归档日期",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"120"
						}
					],
					"sort":13
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"signingPartnerId",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"签字合伙人",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"120"
						}
					],
					"sort":16
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"signingAccountantId",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"签字CPA",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"80"
						}
					],
					"sort":17
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"signingAccountantOtherId",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"签字CPA",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"80"
						}
					],
					"sort":18
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"reportIssue",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"出具报告类型",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Width",
							"value":"160"
						}
					],
					"sort":19
				}
			],
			"code":"columnGroup",
			"control":"ColumnGroup",
			"dataPermission":[
				
			],
			"isReference":false,
			"javaScript":"",
			"name":"列集合",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":0
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"uuid",
			"control":"Hidden",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"uuid",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":1000
		}
	],
	"code":"applyForLoan",
	"control":"GridPanel",
	"dataPermission":[
		
	],
	"isReference":false,
	"javaScript":"//this.BeforeLoad=function(){
//   console.log("BeforeLoadsssss");
//   var frm = this;

//   var params = [];
 //  params.push({param: 'deptId', value: AppContext.Profile.deptId});
//   params.push({param: 'docState', value: 70});//已归档
//   frm.params = JSON.stringify(params);

//};
this.RenderColumnTextStyler = function (row, flied, value) {
    if (flied == "riskLevel") {
        if (value.id == 10)
            return '#e41303';
    }
    if (flied == "riskLevel") {
        if (value.id == 20)
            return '#ffbc1a';
    }
    if (flied == "riskLevel") {
        if (value.id == 30)
            return '#46aaff';
    }
    if (flied == "riskLevel") {
        if (value.id == 40)
            return '#5cdfb3';
    }
}",
	"name":"申请借阅",
	"otherChildren":[
		
	],
	"property":[
		{
			"isHide":false,
			"name":"BaseCode",
			"value":"applyForLoan"
		},
		{
			"isHide":false,
			"name":"Name",
			"value":"申请借阅"
		},
		{
			"isHide":false,
			"name":"IsReadOnly",
			"value":false
		},
		{
			"isHide":false,
			"name":"Description"
		},
		{
			"isHide":false,
			"name":"FormId",
			"value":341647
		},
		{
			"isHide":false,
			"name":"OrderBy",
			"value":"ArchiveDate desc"
		},
		{
			"isHide":false,
			"name":"IsSqlForm",
			"value":true
		},
		{
			"isHide":false,
			"name":"JavaScript",
			"value":"var registerJavaScript = function () {

 

//this.BeforeLoad=function(){
//   console.log("BeforeLoadsssss");
//   var frm = this;

//   var params = [];
 //  params.push({param: 'deptId', value: AppContext.Profile.deptId});
//   params.push({param: 'docState', value: 70});//已归档
//   frm.params = JSON.stringify(params);

//};
this.RenderColumnTextStyler = function (row, flied, value) {
    if (flied == "riskLevel") {
        if (value.id == 10)
            return '#e41303';
    }
    if (flied == "riskLevel") {
        if (value.id == 20)
            return '#ffbc1a';
    }
    if (flied == "riskLevel") {
        if (value.id == 30)
            return '#46aaff';
    }
    if (flied == "riskLevel") {
        if (value.id == 40)
            return '#5cdfb3';
    }
}

 

};"
		}
	],
	"sort":0,
	"sql":"select p.DeptId,p.BoxNumber,p.BookNumber,p.NumberOfBorrowings,p.Id,p.Code,p.ShowName,p.RiskLevel,p.CustomerTypeValue,p.BusinessTypeValue,
isnull(d.treeName,d.name) as 'DeptIdName',p.AuditStart,p.AuditEnd,ma.Code as 'MaCode',ma.ArchiveDate ,
(select top 1 u.name
from PM_Report r
inner join base_user u on r.SigningPartnerId =u.id
 where  r.SigningPartnerId is not null and r.SigningAccountantId is not null and r.CompositionCustomerId=c.id
order by r.createdOn
)  SigningPartnerId,
(select top 1 u.name
from PM_Report r 
inner join base_user u on r.SigningAccountantId =u.id
where  r.SigningPartnerId is not null and r.SigningAccountantId is not null and r.CompositionCustomerId=c.id
order by r.createdOn
)  SigningAccountantId
,
(select top 1 u.name
from PM_Report r 
inner join base_user u on r.SigningAccountantOtherId =u.id
where  r.SigningPartnerId is not null and r.SigningAccountantId is not null and r.CompositionCustomerId=c.id
order by r.createdOn
)  SigningAccountantOtherId,
(select top 1 case ReportIssue when 20 then '以总部名义出具报告' else '以分所名义出具报告' end 
from PM_Report r 
where  r.CompositionCustomerId=c.id -- r.SigningPartnerId is not null and r.SigningAccountantId is not null and
order by r.createdOn
)  ReportIssue

from Prj_Project p 
inner join dbo.Base_Department  d on p.DeptId = d.id
inner join  Prj_ComprositionCustome c on c.Projectid = p.id and c.parentid is null
left join Prj_ManuScirptItemArchive ma on ma.CompostionCustomerId =c.id

where p.docstate=70"
}
{"action":[],"authority":[],"children":[{"action":[],"authority":[],"children":[{"action":[],"authority":[],"children":[],"code":"id","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"主键","otherChildren":[],"property":[],"sort":6},{"action":[],"authority":[],"children":[],"code":"numberOfBorrowings","control":"Number","dataPermission":[],"isReference":false,"javaScript":"","name":"借阅次数","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"80"}],"sort":5},{"action":[],"authority":[],"children":[],"code":"bookNumber","control":"Number","dataPermission":[],"isReference":false,"javaScript":"","name":"纸质底稿总册数","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"140"}],"sort":4},{"action":[],"authority":[],"children":[],"code":"boxNumber","control":"Number","dataPermission":[],"isReference":false,"javaScript":"","name":"纸质底稿总盒数","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"140"}],"sort":3},{"action":[],"authority":[],"children":[],"code":"showName","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"项目名称","otherChildren":[],"property":[{"isHide":false,"name":"IsRenderLink","value":"true"},{"isHide":false,"name":"SchemaCode","value":"ApplyForLoanForm"},{"isHide":false,"name":"WorkFlowTypeId","value":"24619"},{"isHide":false,"name":"Width","value":"400"},{"isHide":false,"name":"align","value":"left"}],"sort":8},{"action":[],"authority":[],"children":[],"code":"deptIdName","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"部门","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"160"}],"sort":12},{"action":[],"authority":[],"children":[],"code":"businessTypeValue","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"业务类型","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"160"}],"sort":11},{"action":[],"authority":[],"children":[],"code":"customerTypeValue","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"客户类型","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"300"},{"isHide":false,"name":"align","value":"left"}],"sort":10},{"action":[],"authority":[],"children":[],"code":"riskLevel","control":"Combobox","dataPermission":[],"isReference":false,"javaScript":"","name":"风险等级","otherChildren":[],"property":[{"isHide":false,"name":"EnumType","value":"RiskLevel"},{"isHide":false,"name":"Width","value":"80"}],"sort":9},{"action":[],"authority":[],"children":[],"code":"code","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"项目编号","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"160"}],"sort":7},{"action":[],"authority":[],"children":[],"code":"auditEnd","control":"Date","dataPermission":[],"isReference":false,"javaScript":"","name":"审计期间结束日","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"140"}],"sort":15},{"action":[],"authority":[],"children":[],"code":"auditStart","control":"Date","dataPermission":[],"isReference":false,"javaScript":"","name":"审计期间开始日","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"140"}],"sort":14},{"action":[],"authority":[],"children":[],"code":"deptId","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"DeptId","otherChildren":[],"property":[],"sort":2},{"action":[],"authority":[],"children":[],"code":"maCode","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"档案号","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"160"}],"sort":1},{"action":[],"authority":[],"children":[],"code":"archiveDate","control":"Date","dataPermission":[],"isReference":false,"javaScript":"","name":"归档日期","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"120"}],"sort":13},{"action":[],"authority":[],"children":[],"code":"signingPartnerId","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"签字合伙人","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"120"}],"sort":16},{"action":[],"authority":[],"children":[],"code":"signingAccountantId","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"签字CPA","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"80"}],"sort":17},{"action":[],"authority":[],"children":[],"code":"signingAccountantOtherId","control":"Text","dataPermission":[],"isReference":false,"javaScript":"","name":"签字CPA","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"80"}],"sort":18},{"action":[],"authority":[],"children":[],"code":"reportIssue","control":"Text","dataPermission":[],"isReference":false,"name":"出具报告类型","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"160"}],"sort":19}],"code":"columnGroup","control":"ColumnGroup","dataPermission":[],"isReference":false,"javaScript":"","name":"列集合","otherChildren":[],"property":[],"sort":0},{"action":[],"authority":[],"children":[],"code":"uuid","control":"Hidden","dataPermission":[],"isReference":false,"name":"uuid","otherChildren":[],"property":[],"sort":1000}],"code":"applyForLoan","control":"GridPanel","dataPermission":[],"isReference":false,"javaScript":"//this.BeforeLoad=function(){\n//&nbsp;&nbsp;&nbsp;console.log(&quot;BeforeLoadsssss&quot;);\n//&nbsp;&nbsp;&nbsp;var&nbsp;frm&nbsp;=&nbsp;this;\n\n//&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;[];\n&nbsp;//&nbsp;&nbsp;params.push({param:&nbsp;'deptId',&nbsp;value:&nbsp;AppContext.Profile.deptId});\n//&nbsp;&nbsp;&nbsp;params.push({param:&nbsp;'docState',&nbsp;value:&nbsp;70});//已归档\n//&nbsp;&nbsp;&nbsp;frm.params&nbsp;=&nbsp;JSON.stringify(params);\n\n//};\nthis.RenderColumnTextStyler&nbsp;=&nbsp;function&nbsp;(row,&nbsp;flied,&nbsp;value)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(flied&nbsp;==&nbsp;&quot;riskLevel&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;10)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#e41303';\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(flied&nbsp;==&nbsp;&quot;riskLevel&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;20)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#ffbc1a';\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(flied&nbsp;==&nbsp;&quot;riskLevel&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;30)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#46aaff';\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(flied&nbsp;==&nbsp;&quot;riskLevel&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;40)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#5cdfb3';\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}","name":"申请借阅","otherChildren":[],"property":[{"isHide":false,"name":"BaseCode","value":"applyForLoan"},{"isHide":false,"name":"Name","value":"申请借阅"},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"Description"},{"isHide":false,"name":"FormId","value":341647},{"isHide":false,"name":"OrderBy","value":"ArchiveDate desc"},{"isHide":false,"name":"IsSqlForm","value":true},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\n//this.BeforeLoad=function(){\n//&nbsp;&nbsp;&nbsp;console.log(&quot;BeforeLoadsssss&quot;);\n//&nbsp;&nbsp;&nbsp;var&nbsp;frm&nbsp;=&nbsp;this;\n\n//&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;[];\n&nbsp;//&nbsp;&nbsp;params.push({param:&nbsp;'deptId',&nbsp;value:&nbsp;AppContext.Profile.deptId});\n//&nbsp;&nbsp;&nbsp;params.push({param:&nbsp;'docState',&nbsp;value:&nbsp;70});//已归档\n//&nbsp;&nbsp;&nbsp;frm.params&nbsp;=&nbsp;JSON.stringify(params);\n\n//};\nthis.RenderColumnTextStyler&nbsp;=&nbsp;function&nbsp;(row,&nbsp;flied,&nbsp;value)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(flied&nbsp;==&nbsp;&quot;riskLevel&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;10)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#e41303';\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(flied&nbsp;==&nbsp;&quot;riskLevel&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;20)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#ffbc1a';\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(flied&nbsp;==&nbsp;&quot;riskLevel&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;30)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#46aaff';\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(flied&nbsp;==&nbsp;&quot;riskLevel&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value.id&nbsp;==&nbsp;40)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;'#5cdfb3';\n&nbsp;&nbsp;&nbsp;&nbsp;}\n}\r\n \r\n};"}],"sort":0,"sql":"select&nbsp;p.DeptId,p.BoxNumber,p.BookNumber,p.NumberOfBorrowings,p.Id,p.Code,p.ShowName,p.RiskLevel,p.CustomerTypeValue,p.BusinessTypeValue,\nisnull(d.treeName,d.name)&nbsp;as&nbsp;'DeptIdName',p.AuditStart,p.AuditEnd,ma.Code&nbsp;as&nbsp;'MaCode',ma.ArchiveDate&nbsp;,\n(select&nbsp;top&nbsp;1&nbsp;u.name\nfrom&nbsp;PM_Report&nbsp;r\ninner&nbsp;join&nbsp;base_user&nbsp;u&nbsp;on&nbsp;r.SigningPartnerId&nbsp;=u.id\n&nbsp;where&nbsp;&nbsp;r.SigningPartnerId&nbsp;is&nbsp;not&nbsp;null&nbsp;and&nbsp;r.SigningAccountantId&nbsp;is&nbsp;not&nbsp;null&nbsp;and&nbsp;r.CompositionCustomerId=c.id\norder&nbsp;by&nbsp;r.createdOn\n)&nbsp;&nbsp;SigningPartnerId,\n(select&nbsp;top&nbsp;1&nbsp;u.name\nfrom&nbsp;PM_Report&nbsp;r&nbsp;\ninner&nbsp;join&nbsp;base_user&nbsp;u&nbsp;on&nbsp;r.SigningAccountantId&nbsp;=u.id\nwhere&nbsp;&nbsp;r.SigningPartnerId&nbsp;is&nbsp;not&nbsp;null&nbsp;and&nbsp;r.SigningAccountantId&nbsp;is&nbsp;not&nbsp;null&nbsp;and&nbsp;r.CompositionCustomerId=c.id\norder&nbsp;by&nbsp;r.createdOn\n)&nbsp;&nbsp;SigningAccountantId\n,\n(select&nbsp;top&nbsp;1&nbsp;u.name\nfrom&nbsp;PM_Report&nbsp;r&nbsp;\ninner&nbsp;join&nbsp;base_user&nbsp;u&nbsp;on&nbsp;r.SigningAccountantOtherId&nbsp;=u.id\nwhere&nbsp;&nbsp;r.SigningPartnerId&nbsp;is&nbsp;not&nbsp;null&nbsp;and&nbsp;r.SigningAccountantId&nbsp;is&nbsp;not&nbsp;null&nbsp;and&nbsp;r.CompositionCustomerId=c.id\norder&nbsp;by&nbsp;r.createdOn\n)&nbsp;&nbsp;SigningAccountantOtherId,\n(select&nbsp;top&nbsp;1&nbsp;case&nbsp;ReportIssue&nbsp;when&nbsp;20&nbsp;then&nbsp;'以总部名义出具报告'&nbsp;else&nbsp;'以分所名义出具报告'&nbsp;end&nbsp;\nfrom&nbsp;PM_Report&nbsp;r&nbsp;\nwhere&nbsp;&nbsp;r.CompositionCustomerId=c.id&nbsp;--&nbsp;r.SigningPartnerId&nbsp;is&nbsp;not&nbsp;null&nbsp;and&nbsp;r.SigningAccountantId&nbsp;is&nbsp;not&nbsp;null&nbsp;and\norder&nbsp;by&nbsp;r.createdOn\n)&nbsp;&nbsp;ReportIssue\n\nfrom&nbsp;Prj_Project&nbsp;p&nbsp;\ninner&nbsp;join&nbsp;dbo.Base_Department&nbsp;&nbsp;d&nbsp;on&nbsp;p.DeptId&nbsp;=&nbsp;d.id\ninner&nbsp;join&nbsp;&nbsp;Prj_ComprositionCustome&nbsp;c&nbsp;on&nbsp;c.Projectid&nbsp;=&nbsp;p.id&nbsp;and&nbsp;c.parentid&nbsp;is&nbsp;null\nleft&nbsp;join&nbsp;Prj_ManuScirptItemArchive&nbsp;ma&nbsp;on&nbsp;ma.CompostionCustomerId&nbsp;=c.id\n\nwhere&nbsp;p.docstate=70"}
2020-03-09 16:25:42