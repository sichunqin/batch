{
	"action":[
		{
			"code":"Back",
			"name":"Back",
			"property":[
				
			],
			"sort":0
		}
	],
	"authority":[
		
	],
	"children":[
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"dateOfSubmission",
			"control":"Date",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"提交日期",
			"otherChildren":[
				
			],
			"property":[
				{
					"isHide":false,
					"name":"Width",
					"value":"120"
				}
			],
			"sort":0
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"actor_id",
			"control":"Hidden",
			"dataPermission":[
				
			],
			"isReference":false,
			"javaScript":"",
			"name":"Actor_id",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":2
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"entityId",
			"control":"Hidden",
			"dataPermission":[
				
			],
			"isReference":false,
			"javaScript":"",
			"name":"EntityId",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":3
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"workitem_Id",
			"control":"Hidden",
			"dataPermission":[
				
			],
			"isReference":false,
			"javaScript":"",
			"name":"Workitem_Id",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":4
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"uiFormCode",
			"control":"Hidden",
			"dataPermission":[
				
			],
			"isReference":false,
			"javaScript":"",
			"name":"UiFormCode",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":5
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"department",
			"control":"Text",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"部门",
			"otherChildren":[
				
			],
			"property":[
				{
					"isHide":false,
					"name":"Width",
					"value":"160"
				}
			],
			"sort":6
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"projectManager",
			"control":"Text",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"项目经理",
			"otherChildren":[
				
			],
			"property":[
				{
					"isHide":false,
					"name":"Width",
					"value":"120"
				}
			],
			"sort":7
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"contactTelephone",
			"control":"Text",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"联系人电话",
			"otherChildren":[
				
			],
			"property":[
				{
					"isHide":false,
					"name":"Width",
					"value":"130"
				}
			],
			"sort":8
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"name",
			"control":"Text",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"项目名称",
			"otherChildren":[
				
			],
			"property":[
				{
					"isHide":false,
					"name":"IsRenderLink",
					"value":"true"
				},
				{
					"isHide":false,
					"name":"SchemaCode",
					"value":"QualityReview"
				},
				{
					"isHide":false,
					"name":"Width",
					"value":"400"
				},
				{
					"isHide":false,
					"name":"align",
					"value":"left"
				},
				{
					"isHide":false,
					"name":"halign",
					"value":"center"
				}
			],
			"sort":9
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"riskLevel",
			"control":"Text",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"风险等级",
			"otherChildren":[
				
			],
			"property":[
				{
					"isHide":false,
					"name":"Width",
					"value":"80"
				}
			],
			"sort":10
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"customerType",
			"control":"Text",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"客户类型",
			"otherChildren":[
				
			],
			"property":[
				{
					"isHide":false,
					"name":"Width",
					"value":"400"
				},
				{
					"isHide":false,
					"name":"halign",
					"value":"center"
				},
				{
					"isHide":false,
					"name":"align",
					"value":"left"
				}
			],
			"sort":11
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"businessType",
			"control":"Text",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"业务类型",
			"otherChildren":[
				
			],
			"property":[
				{
					"isHide":false,
					"name":"Width",
					"value":"120"
				}
			],
			"sort":12
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"actor_name",
			"control":"Text",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"独立复核人",
			"otherChildren":[
				
			],
			"property":[
				{
					"isHide":false,
					"name":"Width",
					"value":"120"
				}
			],
			"sort":13
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"reviewStatus",
			"control":"Hidden",
			"dataPermission":[
				
			],
			"isReference":false,
			"javaScript":"",
			"name":"复核状态",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":14
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"prjId",
			"control":"Hidden",
			"dataPermission":[
				
			],
			"isReference":false,
			"javaScript":"",
			"name":"prjId",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":1
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"uuid",
			"control":"Hidden",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"uuid",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":1000
		}
	],
	"code":"theGeneralInstituteHasBeenCompletedIndependent",
	"control":"GridPanel",
	"dataPermission":[
		
	],
	"isReference":false,
	"name":"底稿独立复核（已完成）",
	"otherChildren":[
		
	],
	"property":[
		{
			"isHide":false,
			"name":"BaseCode",
			"value":"theGeneralInstituteHasBeenCompletedIndependent"
		},
		{
			"isHide":false,
			"name":"Name",
			"value":"底稿独立复核（已完成）"
		},
		{
			"isHide":false,
			"name":"IsReadOnly",
			"value":false
		},
		{
			"isHide":false,
			"name":"Description"
		},
		{
			"isHide":false,
			"name":"FormId",
			"value":342971
		},
		{
			"isHide":false,
			"name":"OrderBy"
		},
		{
			"isHide":false,
			"name":"IsSqlForm",
			"value":true
		}
	],
	"sort":0,
	"sql":"select 'QualityReview' as uiFormCode,workitem_Id,processinstance_id,
entityId,entitytype,
process_id,activity_dispalyname,
creator_name,actor_id,
(select top 1 left(stulist,len(stulist)-1) as actor_name from (
select (select u1.name+',' from base_user u1 where u1.id in (select userid  from qr_reviewallocation ra,qr_draftreviewbatch db where db.id=ra.draftreviewbatchid and db.projectid=4 group by ra.userid,db.projectid) for xml path('')) as stulist from   base_user u2 where u2.id in (select userid  from qr_reviewallocation ra,qr_draftreviewbatch db where db.id=ra.draftreviewbatchid and db.projectid=4 group by ra.userid,db.projectid) ) b) as actor_name,post,workitem_state,
created_time as 'dateOfSubmission',comments,taskinstance_name,
step_number,tododescription,formurl,
batchapproval,flowcode   ,
(select u.name from base_user u where u.id = p.projectmanagerid) as 'projectManager',
(select u.name from base_user u where u.id = p.projectpartnerid) as 'projectPartnerId',
(select isnull(d.treename,d.name) from Base_Department d where d.id = p.deptid) as 'department',
(select  staff.MobilePhone from base_user u left join HR_Staff staff on u.staffid = staff.id where u.id = t.actor_id) as 'contactTelephone',
(select v.name from sys_enumvalue v,sys_enumtype t where v.enumtypeid=t.id and t.code='risklevel' and v.value=p.risklevel)as riskLevel,
p.businesstypevalue as 'businessType'
,p.customertypevalue as 'customerType',
(select v.name from sys_enumvalue v,sys_enumtype et where v.enumtypeid=et.id and et.code='ManuscriptReviewStateType' and v.value=t.entityStatus)as 'reviewStatus' ,

p.code,p.ShowName as 'name',p.id as 'prjId'
from wf_todolog t
inner join  qr_draftreviewbatch b  on t.entityid=b.id
inner join prj_project p on b.projectid=p.id

where  t.workitem_state in (60,100) and t.flowcode is not  null  
and exists (select code from Base_WorkFlowConfig where workflowtypeid =24615 and flowcode =code) 
and t.entityStatus in ('60','50')

 and (t.ACTOR_ID =#AppContext.Profile.Id#

 )

"
}
{"action":[{"code":"Back","name":"Back","property":[],"sort":0}],"authority":[],"children":[{"action":[],"authority":[],"children":[],"code":"dateOfSubmission","control":"Date","dataPermission":[],"isReference":false,"name":"提交日期","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"120"}],"sort":0},{"action":[],"authority":[],"children":[],"code":"actor_id","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"Actor_id","otherChildren":[],"property":[],"sort":2},{"action":[],"authority":[],"children":[],"code":"entityId","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"EntityId","otherChildren":[],"property":[],"sort":3},{"action":[],"authority":[],"children":[],"code":"workitem_Id","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"Workitem_Id","otherChildren":[],"property":[],"sort":4},{"action":[],"authority":[],"children":[],"code":"uiFormCode","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"UiFormCode","otherChildren":[],"property":[],"sort":5},{"action":[],"authority":[],"children":[],"code":"department","control":"Text","dataPermission":[],"isReference":false,"name":"部门","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"160"}],"sort":6},{"action":[],"authority":[],"children":[],"code":"projectManager","control":"Text","dataPermission":[],"isReference":false,"name":"项目经理","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"120"}],"sort":7},{"action":[],"authority":[],"children":[],"code":"contactTelephone","control":"Text","dataPermission":[],"isReference":false,"name":"联系人电话","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"130"}],"sort":8},{"action":[],"authority":[],"children":[],"code":"name","control":"Text","dataPermission":[],"isReference":false,"name":"项目名称","otherChildren":[],"property":[{"isHide":false,"name":"IsRenderLink","value":"true"},{"isHide":false,"name":"SchemaCode","value":"QualityReview"},{"isHide":false,"name":"Width","value":"400"},{"isHide":false,"name":"align","value":"left"},{"isHide":false,"name":"halign","value":"center"}],"sort":9},{"action":[],"authority":[],"children":[],"code":"riskLevel","control":"Text","dataPermission":[],"isReference":false,"name":"风险等级","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"80"}],"sort":10},{"action":[],"authority":[],"children":[],"code":"customerType","control":"Text","dataPermission":[],"isReference":false,"name":"客户类型","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"400"},{"isHide":false,"name":"halign","value":"center"},{"isHide":false,"name":"align","value":"left"}],"sort":11},{"action":[],"authority":[],"children":[],"code":"businessType","control":"Text","dataPermission":[],"isReference":false,"name":"业务类型","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"120"}],"sort":12},{"action":[],"authority":[],"children":[],"code":"actor_name","control":"Text","dataPermission":[],"isReference":false,"name":"独立复核人","otherChildren":[],"property":[{"isHide":false,"name":"Width","value":"120"}],"sort":13},{"action":[],"authority":[],"children":[],"code":"reviewStatus","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"复核状态","otherChildren":[],"property":[],"sort":14},{"action":[],"authority":[],"children":[],"code":"prjId","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"prjId","otherChildren":[],"property":[],"sort":1},{"action":[],"authority":[],"children":[],"code":"uuid","control":"Hidden","dataPermission":[],"isReference":false,"name":"uuid","otherChildren":[],"property":[],"sort":1000}],"code":"theGeneralInstituteHasBeenCompletedIndependent","control":"GridPanel","dataPermission":[],"isReference":false,"name":"底稿独立复核（已完成）","otherChildren":[],"property":[{"isHide":false,"name":"BaseCode","value":"theGeneralInstituteHasBeenCompletedIndependent"},{"isHide":false,"name":"Name","value":"底稿独立复核（已完成）"},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"Description"},{"isHide":false,"name":"FormId","value":342971},{"isHide":false,"name":"OrderBy"},{"isHide":false,"name":"IsSqlForm","value":true}],"sort":0,"sql":"select&nbsp;'QualityReview'&nbsp;as&nbsp;uiFormCode,workitem_Id,processinstance_id,\nentityId,entitytype,\nprocess_id,activity_dispalyname,\ncreator_name,actor_id,\n(select&nbsp;top&nbsp;1&nbsp;left(stulist,len(stulist)-1)&nbsp;as&nbsp;actor_name&nbsp;from&nbsp;(\nselect&nbsp;(select&nbsp;u1.name+','&nbsp;from&nbsp;base_user&nbsp;u1&nbsp;where&nbsp;u1.id&nbsp;in&nbsp;(select&nbsp;userid&nbsp;&nbsp;from&nbsp;qr_reviewallocation&nbsp;ra,qr_draftreviewbatch&nbsp;db&nbsp;where&nbsp;db.id=ra.draftreviewbatchid&nbsp;and&nbsp;db.projectid=4&nbsp;group&nbsp;by&nbsp;ra.userid,db.projectid)&nbsp;for&nbsp;xml&nbsp;path(''))&nbsp;as&nbsp;stulist&nbsp;from&nbsp;&nbsp;&nbsp;base_user&nbsp;u2&nbsp;where&nbsp;u2.id&nbsp;in&nbsp;(select&nbsp;userid&nbsp;&nbsp;from&nbsp;qr_reviewallocation&nbsp;ra,qr_draftreviewbatch&nbsp;db&nbsp;where&nbsp;db.id=ra.draftreviewbatchid&nbsp;and&nbsp;db.projectid=4&nbsp;group&nbsp;by&nbsp;ra.userid,db.projectid)&nbsp;)&nbsp;b)&nbsp;as&nbsp;actor_name,post,workitem_state,\ncreated_time&nbsp;as&nbsp;'dateOfSubmission',comments,taskinstance_name,\nstep_number,tododescription,formurl,\nbatchapproval,flowcode&nbsp;&nbsp;&nbsp;,\n(select&nbsp;u.name&nbsp;from&nbsp;base_user&nbsp;u&nbsp;where&nbsp;u.id&nbsp;=&nbsp;p.projectmanagerid)&nbsp;as&nbsp;'projectManager',\n(select&nbsp;u.name&nbsp;from&nbsp;base_user&nbsp;u&nbsp;where&nbsp;u.id&nbsp;=&nbsp;p.projectpartnerid)&nbsp;as&nbsp;'projectPartnerId',\n(select&nbsp;isnull(d.treename,d.name)&nbsp;from&nbsp;Base_Department&nbsp;d&nbsp;where&nbsp;d.id&nbsp;=&nbsp;p.deptid)&nbsp;as&nbsp;'department',\n(select&nbsp;&nbsp;staff.MobilePhone&nbsp;from&nbsp;base_user&nbsp;u&nbsp;left&nbsp;join&nbsp;HR_Staff&nbsp;staff&nbsp;on&nbsp;u.staffid&nbsp;=&nbsp;staff.id&nbsp;where&nbsp;u.id&nbsp;=&nbsp;t.actor_id)&nbsp;as&nbsp;'contactTelephone',\n(select&nbsp;v.name&nbsp;from&nbsp;sys_enumvalue&nbsp;v,sys_enumtype&nbsp;t&nbsp;where&nbsp;v.enumtypeid=t.id&nbsp;and&nbsp;t.code='risklevel'&nbsp;and&nbsp;v.value=p.risklevel)as&nbsp;riskLevel,\np.businesstypevalue&nbsp;as&nbsp;'businessType'\n,p.customertypevalue&nbsp;as&nbsp;'customerType',\n(select&nbsp;v.name&nbsp;from&nbsp;sys_enumvalue&nbsp;v,sys_enumtype&nbsp;et&nbsp;where&nbsp;v.enumtypeid=et.id&nbsp;and&nbsp;et.code='ManuscriptReviewStateType'&nbsp;and&nbsp;v.value=t.entityStatus)as&nbsp;'reviewStatus'&nbsp;,\n\np.code,p.ShowName&nbsp;as&nbsp;'name',p.id&nbsp;as&nbsp;'prjId'\nfrom&nbsp;wf_todolog&nbsp;t\ninner&nbsp;join&nbsp;&nbsp;qr_draftreviewbatch&nbsp;b&nbsp;&nbsp;on&nbsp;t.entityid=b.id\ninner&nbsp;join&nbsp;prj_project&nbsp;p&nbsp;on&nbsp;b.projectid=p.id\n\nwhere&nbsp;&nbsp;t.workitem_state&nbsp;in&nbsp;(60,100)&nbsp;and&nbsp;t.flowcode&nbsp;is&nbsp;not&nbsp;&nbsp;null&nbsp;&nbsp;\nand&nbsp;exists&nbsp;(select&nbsp;code&nbsp;from&nbsp;Base_WorkFlowConfig&nbsp;where&nbsp;workflowtypeid&nbsp;=24615&nbsp;and&nbsp;flowcode&nbsp;=code)&nbsp;\nand&nbsp;t.entityStatus&nbsp;in&nbsp;('60','50')\n\n&nbsp;and&nbsp;(t.ACTOR_ID&nbsp;=#AppContext.Profile.Id#\n\n&nbsp;)\n\n"}
2020-04-08 19:57:16