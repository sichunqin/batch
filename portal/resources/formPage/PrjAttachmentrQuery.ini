{
	"action":[
		{
			"code":"Delete",
			"name":"删除",
			"property":[
				{
					"isHide":false,
					"name":"IsRenderColumn",
					"value":"true"
				}
			],
			"sort":0
		},
		{
			"code":"UpLoadFile",
			"name":"上传",
			"property":[
				
			],
			"sort":1
		}
	],
	"authority":[
		
	],
	"children":[
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"id",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"主键",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":16
						},
						{
							"isHide":false,
							"name":"Required",
							"value":true
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"Id",
					"sort":2
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"flag",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"类型",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":16
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"EnumType",
							"value":"AttFlagType"
						},
						{
							"isHide":false,
							"name":"EntityConfig",
							"value":"[Enum(AttFlagType)]"
						}
					],
					"select":"Flag[Enum(AttFlagType)]",
					"sort":3
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"attachmentId",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"附件名称",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":16
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"EntityConfig",
							"value":"Entity(Attachment|Code(Name)#Name(Name))]"
						},
						{
							"isHide":false,
							"name":"EntityCode",
							"value":"Attachment"
						},
						{
							"isHide":false,
							"name":"IsRenderLink",
							"value":"true"
						},
						{
							"isHide":false,
							"name":"Width",
							"value":"600"
						}
					],
					"select":"AttachmentIdEntity(Attachment|Code(Name)#Name(Name))]",
					"sort":4
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"timestamp",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"时间戳",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":8
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						}
					],
					"select":"Timestamp",
					"sort":5
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"engagementId",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"被引用的约定书",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":16
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"EntityConfig",
							"value":"[Entity(Engagement|Code(Code)#Name(Code))]"
						},
						{
							"isHide":false,
							"name":"EntityCode",
							"value":"Engagement"
						}
					],
					"select":"EngagementId[Entity(Engagement|Code(Code)#Name(Code))]",
					"sort":6
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"projectId",
					"control":"Hidden",
					"dataPermission":[
						
					],
					"isReference":false,
					"javaScript":"",
					"name":"项目",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"Length",
							"value":30
						},
						{
							"isHide":false,
							"name":"Required",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsReadOnly",
							"value":false
						},
						{
							"isHide":false,
							"name":"IsTransient",
							"value":false
						},
						{
							"isHide":false,
							"name":"EntityConfig",
							"value":"[Entity(Project|Code(Code)#Name(Name))]"
						},
						{
							"isHide":false,
							"name":"EntityCode",
							"value":"Project"
						}
					],
					"select":"ProjectId[Entity(Project|Code(Code)#Name(Name))]",
					"sort":7
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						
					],
					"code":"attachmentId_Name",
					"control":"Text",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"附件名称",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"IsRenderLink",
							"value":"true"
						},
						{
							"isHide":false,
							"name":"Width",
							"value":"600"
						}
					],
					"sort":1
				}
			],
			"code":"columnGroup",
			"control":"ColumnGroup",
			"dataPermission":[
				
			],
			"isReference":false,
			"javaScript":"",
			"name":"列集合",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":0
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"uuid",
			"control":"Hidden",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"uuid",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":1000
		}
	],
	"code":"prjAttachmentrQuery",
	"control":"GridPanel",
	"dataPermission":[
		
	],
	"isReference":false,
	"javaScript":"this.UploadCompleteCallBack = function (files) {
    var me = this;
    var fileId = [];
    for (var i = 0; i < files.length; i++) {
        fileId.push(files[i].id);
    }
    var params = {};
    var paramsget = {};

    params.filesId = JSON.stringify(fileId);
    var prjAtt;

    var m = this.Up();
    if (m.code == "businessFinanceTab") {
        prjAtt = this.Up().DownForCode("prjAttachments")
        params.flag = 20;
        paramsget.flag = 20;

    } else if (m.code == "financeSurveyTab") {
        prjAtt = this.Up().DownForCode("prjAttachments")
        params.flag = 30;
        paramsget.flag = 30;
    } else {
        m = m.Up();
        if (m.code == "engagement") {
            prjAtt = this;
            params.flag = 10;
            paramsget.flag = 10;
        }
    }
    if (m.code == "businessFinanceTab" || m.code == "financeSurveyTab") {
        var m = this.Up();
        var mu = m.Up();
        var muu = mu.Up();
        var muuu = muu.Up();
        var form = muuu.DownForCode("projectTab").Down("[controltype='FormPanel']").First;
        if (Framework.IsNullOrEmpty(form)) return false;
        var id = form.DownForCode("id");
        params.PrjId = id.GetValue();
        params.engagId = null;
        if (Framework.IsNullOrEmpty(id) || Framework.IsNullOrEmpty(id.GetValue())) return false;
        paramsget.PrjId = id.GetValue();
        paramsget.engagId = null;
    } else if (m.code == "engagement") {
        var mp = m.DownForCode("compositionCustomerId");
        var id = mp.GetValue().id;
        params.PrjId = null;
        paramsget.PrjId = null;
        params.engagId = null;
        paramsget.engagId = null;

    }
    paramsget.formId = prjAtt.formid;

    Framework.AjaxRequest(me, "PrjAttachment-savePrjAttachment.do", 'get', params, false, function (result) {

    });
    Framework.AjaxRequest(me, "PrjAttachment-getPrjAttachment.do", 'get', paramsget, false, function (result) {
        prjAtt.SetValue(result);
    });
};

this.BeforeLoad = function () {
    var me = this;
    var pid = Framework.GetUrlParam("projectGuid");
if(Framework.IsNullOrEmpty(pid))
    {
        var tab = this.Up('[controltype="Tab"]');
       // if(tab.OnSelect) tab.OnSelect();
        return true;
    }
    var prjAtt = this;
    var paramsprjAtt = {};
    paramsprjAtt.PrjId = null;
    paramsprjAtt.flag = 30;
    paramsprjAtt.formId = prjAtt.formid;
    paramsprjAtt.engagId = null;
    paramsprjAtt.sPrjId = pid;
    Framework.AjaxRequest(me, "PrjAttachment-getPrjAttachment-Query.do", 'get', paramsprjAtt, false, function (result) {
        prjAtt.SetValue(result);

    });
};
this.OpenLinkForm = function (row, field) {
    console.log("OpenLinkForm");
    if(field =='attachmentId_Name')
    {
        var attId = row.attachmentId.id;
        Framework.DownLoad(attId);
    }
};

 

this.BeforeLoad = function () {
    var me = this;

    console.log("BeforeLoad");
    if(Framework.IsNotNullOrEmpty(this.Top('[basecode="projectQuery"]').OpenSelectRow))
    {
        var paramsprjAtt = {};
        if(Framework.IsNotNullOrEmpty(this.Top('[basecode="projectQuery"]').OpenSelectRow.projectId))
        {
            paramsprjAtt.PrjId = this.Top('[basecode="projectQuery"]').OpenSelectRow.projectId.id;
        }else{
            paramsprjAtt.PrjId = this.Top('[basecode="projectQuery"]').OpenSelectRow.id;
        }
        
        paramsprjAtt.flag = 30;
        paramsprjAtt.formId = this.formid;
        paramsprjAtt.engagId = null;

        Framework.AjaxRequest(me, "PrjAttachment-getPrjAttachment-Query.do", 'get', paramsprjAtt, true, function (result) {
            me.SetValue(result);
        });

        var businessActivity = me.UpForCode("BusinessActivity");
        if (Framework.IsNotNullOrEmpty(businessActivity) && businessActivity.ShowLinkButton)
            businessActivity.ShowLinkButton();
    }
    return false;
};",
	"name":"项目附件财务尽职调查报告",
	"otherChildren":[
		
	],
	"property":[
		{
			"isHide":false,
			"name":"BaseCode",
			"value":"prjAttachmentr"
		},
		{
			"isHide":false,
			"name":"Name",
			"value":"项目附件财务尽职调查报告"
		},
		{
			"isHide":false,
			"name":"IsReadOnly",
			"value":true
		},
		{
			"isHide":false,
			"name":"Description"
		},
		{
			"isHide":false,
			"name":"FormId",
			"value":343087
		},
		{
			"isHide":false,
			"name":"OrderBy"
		},
		{
			"isHide":false,
			"name":"IsSqlForm",
			"value":false
		},
		{
			"isHide":false,
			"name":"JavaScript",
			"value":"var registerJavaScript = function () {

 

this.UploadCompleteCallBack = function (files) {
    var me = this;
    var fileId = [];
    for (var i = 0; i < files.length; i++) {
        fileId.push(files[i].id);
    }
    var params = {};
    var paramsget = {};

    params.filesId = JSON.stringify(fileId);
    var prjAtt;

    var m = this.Up();
    if (m.code == "businessFinanceTab") {
        prjAtt = this.Up().DownForCode("prjAttachments")
        params.flag = 20;
        paramsget.flag = 20;

    } else if (m.code == "financeSurveyTab") {
        prjAtt = this.Up().DownForCode("prjAttachments")
        params.flag = 30;
        paramsget.flag = 30;
    } else {
        m = m.Up();
        if (m.code == "engagement") {
            prjAtt = this;
            params.flag = 10;
            paramsget.flag = 10;
        }
    }
    if (m.code == "businessFinanceTab" || m.code == "financeSurveyTab") {
        var m = this.Up();
        var mu = m.Up();
        var muu = mu.Up();
        var muuu = muu.Up();
        var form = muuu.DownForCode("projectTab").Down("[controltype='FormPanel']").First;
        if (Framework.IsNullOrEmpty(form)) return false;
        var id = form.DownForCode("id");
        params.PrjId = id.GetValue();
        params.engagId = null;
        if (Framework.IsNullOrEmpty(id) || Framework.IsNullOrEmpty(id.GetValue())) return false;
        paramsget.PrjId = id.GetValue();
        paramsget.engagId = null;
    } else if (m.code == "engagement") {
        var mp = m.DownForCode("compositionCustomerId");
        var id = mp.GetValue().id;
        params.PrjId = null;
        paramsget.PrjId = null;
        params.engagId = null;
        paramsget.engagId = null;

    }
    paramsget.formId = prjAtt.formid;

    Framework.AjaxRequest(me, "PrjAttachment-savePrjAttachment.do", 'get', params, false, function (result) {

    });
    Framework.AjaxRequest(me, "PrjAttachment-getPrjAttachment.do", 'get', paramsget, false, function (result) {
        prjAtt.SetValue(result);
    });
};

this.BeforeLoad = function () {
    var me = this;
    var pid = Framework.GetUrlParam("projectGuid");
if(Framework.IsNullOrEmpty(pid))
    {
        var tab = this.Up('[controltype="Tab"]');
       // if(tab.OnSelect) tab.OnSelect();
        return true;
    }
    var prjAtt = this;
    var paramsprjAtt = {};
    paramsprjAtt.PrjId = null;
    paramsprjAtt.flag = 30;
    paramsprjAtt.formId = prjAtt.formid;
    paramsprjAtt.engagId = null;
    paramsprjAtt.sPrjId = pid;
    Framework.AjaxRequest(me, "PrjAttachment-getPrjAttachment-Query.do", 'get', paramsprjAtt, false, function (result) {
        prjAtt.SetValue(result);

    });
};
this.OpenLinkForm = function (row, field) {
    console.log("OpenLinkForm");
    if(field =='attachmentId_Name')
    {
        var attId = row.attachmentId.id;
        Framework.DownLoad(attId);
    }
};

 

this.BeforeLoad = function () {
    var me = this;

    console.log("BeforeLoad");
    if(Framework.IsNotNullOrEmpty(this.Top('[basecode="projectQuery"]').OpenSelectRow))
    {
        var paramsprjAtt = {};
        if(Framework.IsNotNullOrEmpty(this.Top('[basecode="projectQuery"]').OpenSelectRow.projectId))
        {
            paramsprjAtt.PrjId = this.Top('[basecode="projectQuery"]').OpenSelectRow.projectId.id;
        }else{
            paramsprjAtt.PrjId = this.Top('[basecode="projectQuery"]').OpenSelectRow.id;
        }
        
        paramsprjAtt.flag = 30;
        paramsprjAtt.formId = this.formid;
        paramsprjAtt.engagId = null;

        Framework.AjaxRequest(me, "PrjAttachment-getPrjAttachment-Query.do", 'get', paramsprjAtt, true, function (result) {
            me.SetValue(result);
        });

        var businessActivity = me.UpForCode("BusinessActivity");
        if (Framework.IsNotNullOrEmpty(businessActivity) && businessActivity.ShowLinkButton)
            businessActivity.ShowLinkButton();
    }
    return false;
};

 

};"
		},
		{
			"isHide":false,
			"name":"EntityType",
			"value":"PrjAttachment"
		},
		{
			"isHide":false,
			"name":"pagination",
			"value":"false"
		}
	],
	"sort":0
}
{"action":[{"code":"Delete","name":"删除","property":[{"isHide":false,"name":"IsRenderColumn","value":"true"}],"sort":0},{"code":"UpLoadFile","name":"上传","property":[],"sort":1}],"authority":[],"children":[{"action":[],"authority":[],"children":[{"action":[],"authority":[],"children":[],"code":"id","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"主键","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":16},{"isHide":false,"name":"Required","value":true},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"Id","sort":2},{"action":[],"authority":[],"children":[],"code":"flag","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"类型","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":16},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"EnumType","value":"AttFlagType"},{"isHide":false,"name":"EntityConfig","value":"[Enum(AttFlagType)]"}],"select":"Flag[Enum(AttFlagType)]","sort":3},{"action":[],"authority":[],"children":[],"code":"attachmentId","control":"Hidden","dataPermission":[],"isReference":false,"name":"附件名称","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":16},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"EntityConfig","value":"Entity(Attachment|Code(Name)#Name(Name))]"},{"isHide":false,"name":"EntityCode","value":"Attachment"},{"isHide":false,"name":"IsRenderLink","value":"true"},{"isHide":false,"name":"Width","value":"600"}],"select":"AttachmentIdEntity(Attachment|Code(Name)#Name(Name))]","sort":4},{"action":[],"authority":[],"children":[],"code":"timestamp","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"时间戳","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":8},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"Timestamp","sort":5},{"action":[],"authority":[],"children":[],"code":"engagementId","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"被引用的约定书","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":16},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"EntityConfig","value":"[Entity(Engagement|Code(Code)#Name(Code))]"},{"isHide":false,"name":"EntityCode","value":"Engagement"}],"select":"EngagementId[Entity(Engagement|Code(Code)#Name(Code))]","sort":6},{"action":[],"authority":[],"children":[],"code":"projectId","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"项目","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":30},{"isHide":false,"name":"Required","value":false},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false},{"isHide":false,"name":"EntityConfig","value":"[Entity(Project|Code(Code)#Name(Name))]"},{"isHide":false,"name":"EntityCode","value":"Project"}],"select":"ProjectId[Entity(Project|Code(Code)#Name(Name))]","sort":7},{"action":[],"authority":[],"children":[],"code":"attachmentId_Name","control":"Text","dataPermission":[],"isReference":false,"name":"附件名称","otherChildren":[],"property":[{"isHide":false,"name":"IsRenderLink","value":"true"},{"isHide":false,"name":"Width","value":"600"}],"sort":1}],"code":"columnGroup","control":"ColumnGroup","dataPermission":[],"isReference":false,"javaScript":"","name":"列集合","otherChildren":[],"property":[],"sort":0},{"action":[],"authority":[],"children":[],"code":"uuid","control":"Hidden","dataPermission":[],"isReference":false,"name":"uuid","otherChildren":[],"property":[],"sort":1000}],"code":"prjAttachmentrQuery","control":"GridPanel","dataPermission":[],"isReference":false,"javaScript":"this.UploadCompleteCallBack&nbsp;=&nbsp;function&nbsp;(files)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;fileId&nbsp;=&nbsp;[];\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;files.length;&nbsp;i++)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileId.push(files[i].id);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;paramsget&nbsp;=&nbsp;{};\n\n&nbsp;&nbsp;&nbsp;&nbsp;params.filesId&nbsp;=&nbsp;JSON.stringify(fileId);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;prjAtt;\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;m&nbsp;=&nbsp;this.Up();\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(m.code&nbsp;==&nbsp;&quot;businessFinanceTab&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prjAtt&nbsp;=&nbsp;this.Up().DownForCode(&quot;prjAttachments&quot;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.flag&nbsp;=&nbsp;20;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsget.flag&nbsp;=&nbsp;20;\n\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(m.code&nbsp;==&nbsp;&quot;financeSurveyTab&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prjAtt&nbsp;=&nbsp;this.Up().DownForCode(&quot;prjAttachments&quot;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.flag&nbsp;=&nbsp;30;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsget.flag&nbsp;=&nbsp;30;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;=&nbsp;m.Up();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(m.code&nbsp;==&nbsp;&quot;engagement&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prjAtt&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.flag&nbsp;=&nbsp;10;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsget.flag&nbsp;=&nbsp;10;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(m.code&nbsp;==&nbsp;&quot;businessFinanceTab&quot;&nbsp;||&nbsp;m.code&nbsp;==&nbsp;&quot;financeSurveyTab&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;m&nbsp;=&nbsp;this.Up();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;mu&nbsp;=&nbsp;m.Up();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;muu&nbsp;=&nbsp;mu.Up();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;muuu&nbsp;=&nbsp;muu.Up();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;form&nbsp;=&nbsp;muuu.DownForCode(&quot;projectTab&quot;).Down(&quot;[controltype='FormPanel']&quot;).First;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(form))&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;id&nbsp;=&nbsp;form.DownForCode(&quot;id&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.PrjId&nbsp;=&nbsp;id.GetValue();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.engagId&nbsp;=&nbsp;null;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(id)&nbsp;||&nbsp;Framework.IsNullOrEmpty(id.GetValue()))&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsget.PrjId&nbsp;=&nbsp;id.GetValue();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsget.engagId&nbsp;=&nbsp;null;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(m.code&nbsp;==&nbsp;&quot;engagement&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;mp&nbsp;=&nbsp;m.DownForCode(&quot;compositionCustomerId&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;id&nbsp;=&nbsp;mp.GetValue().id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.PrjId&nbsp;=&nbsp;null;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsget.PrjId&nbsp;=&nbsp;null;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.engagId&nbsp;=&nbsp;null;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsget.engagId&nbsp;=&nbsp;null;\n\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;paramsget.formId&nbsp;=&nbsp;prjAtt.formid;\n\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;PrjAttachment-savePrjAttachment.do&quot;,&nbsp;'get',&nbsp;params,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;});\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;PrjAttachment-getPrjAttachment.do&quot;,&nbsp;'get',&nbsp;paramsget,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prjAtt.SetValue(result);\n&nbsp;&nbsp;&nbsp;&nbsp;});\n};\n\nthis.BeforeLoad&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;pid&nbsp;=&nbsp;Framework.GetUrlParam(&quot;projectGuid&quot;);\nif(Framework.IsNullOrEmpty(pid))\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tab&nbsp;=&nbsp;this.Up('[controltype=&quot;Tab&quot;]');\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if(tab.OnSelect)&nbsp;tab.OnSelect();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;prjAtt&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;paramsprjAtt&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.PrjId&nbsp;=&nbsp;null;\n&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.flag&nbsp;=&nbsp;30;\n&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.formId&nbsp;=&nbsp;prjAtt.formid;\n&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.engagId&nbsp;=&nbsp;null;\n&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.sPrjId&nbsp;=&nbsp;pid;\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;PrjAttachment-getPrjAttachment-Query.do&quot;,&nbsp;'get',&nbsp;paramsprjAtt,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prjAtt.SetValue(result);\n\n&nbsp;&nbsp;&nbsp;&nbsp;});\n};\nthis.OpenLinkForm&nbsp;=&nbsp;function&nbsp;(row,&nbsp;field)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;OpenLinkForm&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if(field&nbsp;=='attachmentId_Name')\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;attId&nbsp;=&nbsp;row.attachmentId.id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.DownLoad(attId);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n};\r\n \r\nthis.BeforeLoad = function () {\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;BeforeLoad&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if(Framework.IsNotNullOrEmpty(this.Top('[basecode=&quot;projectQuery&quot;]').OpenSelectRow))\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;paramsprjAtt&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(Framework.IsNotNullOrEmpty(this.Top('[basecode=&quot;projectQuery&quot;]').OpenSelectRow.projectId))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.PrjId&nbsp;=&nbsp;this.Top('[basecode=&quot;projectQuery&quot;]').OpenSelectRow.projectId.id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.PrjId&nbsp;=&nbsp;this.Top('[basecode=&quot;projectQuery&quot;]').OpenSelectRow.id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.flag&nbsp;=&nbsp;30;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.formId&nbsp;=&nbsp;this.formid;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.engagId&nbsp;=&nbsp;null;\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;PrjAttachment-getPrjAttachment-Query.do&quot;,&nbsp;'get',&nbsp;paramsprjAtt,&nbsp;true,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;me.SetValue(result);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;businessActivity&nbsp;=&nbsp;me.UpForCode(&quot;BusinessActivity&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNotNullOrEmpty(businessActivity)&nbsp;&&&nbsp;businessActivity.ShowLinkButton)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;businessActivity.ShowLinkButton();\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n};","name":"项目附件财务尽职调查报告","otherChildren":[],"property":[{"isHide":false,"name":"BaseCode","value":"prjAttachmentr"},{"isHide":false,"name":"Name","value":"项目附件财务尽职调查报告"},{"isHide":false,"name":"IsReadOnly","value":true},{"isHide":false,"name":"Description"},{"isHide":false,"name":"FormId","value":343087},{"isHide":false,"name":"OrderBy"},{"isHide":false,"name":"IsSqlForm","value":false},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.UploadCompleteCallBack&nbsp;=&nbsp;function&nbsp;(files)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;fileId&nbsp;=&nbsp;[];\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;files.length;&nbsp;i++)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fileId.push(files[i].id);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;paramsget&nbsp;=&nbsp;{};\n\n&nbsp;&nbsp;&nbsp;&nbsp;params.filesId&nbsp;=&nbsp;JSON.stringify(fileId);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;prjAtt;\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;m&nbsp;=&nbsp;this.Up();\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(m.code&nbsp;==&nbsp;&quot;businessFinanceTab&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prjAtt&nbsp;=&nbsp;this.Up().DownForCode(&quot;prjAttachments&quot;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.flag&nbsp;=&nbsp;20;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsget.flag&nbsp;=&nbsp;20;\n\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(m.code&nbsp;==&nbsp;&quot;financeSurveyTab&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prjAtt&nbsp;=&nbsp;this.Up().DownForCode(&quot;prjAttachments&quot;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.flag&nbsp;=&nbsp;30;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsget.flag&nbsp;=&nbsp;30;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;m&nbsp;=&nbsp;m.Up();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(m.code&nbsp;==&nbsp;&quot;engagement&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prjAtt&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.flag&nbsp;=&nbsp;10;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsget.flag&nbsp;=&nbsp;10;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(m.code&nbsp;==&nbsp;&quot;businessFinanceTab&quot;&nbsp;||&nbsp;m.code&nbsp;==&nbsp;&quot;financeSurveyTab&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;m&nbsp;=&nbsp;this.Up();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;mu&nbsp;=&nbsp;m.Up();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;muu&nbsp;=&nbsp;mu.Up();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;muuu&nbsp;=&nbsp;muu.Up();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;form&nbsp;=&nbsp;muuu.DownForCode(&quot;projectTab&quot;).Down(&quot;[controltype='FormPanel']&quot;).First;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(form))&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;id&nbsp;=&nbsp;form.DownForCode(&quot;id&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.PrjId&nbsp;=&nbsp;id.GetValue();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.engagId&nbsp;=&nbsp;null;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(id)&nbsp;||&nbsp;Framework.IsNullOrEmpty(id.GetValue()))&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsget.PrjId&nbsp;=&nbsp;id.GetValue();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsget.engagId&nbsp;=&nbsp;null;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(m.code&nbsp;==&nbsp;&quot;engagement&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;mp&nbsp;=&nbsp;m.DownForCode(&quot;compositionCustomerId&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;id&nbsp;=&nbsp;mp.GetValue().id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.PrjId&nbsp;=&nbsp;null;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsget.PrjId&nbsp;=&nbsp;null;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.engagId&nbsp;=&nbsp;null;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsget.engagId&nbsp;=&nbsp;null;\n\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;paramsget.formId&nbsp;=&nbsp;prjAtt.formid;\n\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;PrjAttachment-savePrjAttachment.do&quot;,&nbsp;'get',&nbsp;params,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;});\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;PrjAttachment-getPrjAttachment.do&quot;,&nbsp;'get',&nbsp;paramsget,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prjAtt.SetValue(result);\n&nbsp;&nbsp;&nbsp;&nbsp;});\n};\n\nthis.BeforeLoad&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;pid&nbsp;=&nbsp;Framework.GetUrlParam(&quot;projectGuid&quot;);\nif(Framework.IsNullOrEmpty(pid))\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tab&nbsp;=&nbsp;this.Up('[controltype=&quot;Tab&quot;]');\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if(tab.OnSelect)&nbsp;tab.OnSelect();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;prjAtt&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;paramsprjAtt&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.PrjId&nbsp;=&nbsp;null;\n&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.flag&nbsp;=&nbsp;30;\n&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.formId&nbsp;=&nbsp;prjAtt.formid;\n&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.engagId&nbsp;=&nbsp;null;\n&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.sPrjId&nbsp;=&nbsp;pid;\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;PrjAttachment-getPrjAttachment-Query.do&quot;,&nbsp;'get',&nbsp;paramsprjAtt,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;prjAtt.SetValue(result);\n\n&nbsp;&nbsp;&nbsp;&nbsp;});\n};\nthis.OpenLinkForm&nbsp;=&nbsp;function&nbsp;(row,&nbsp;field)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;OpenLinkForm&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if(field&nbsp;=='attachmentId_Name')\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;attId&nbsp;=&nbsp;row.attachmentId.id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.DownLoad(attId);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n};\r\n \r\nthis.BeforeLoad = function () {\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;BeforeLoad&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if(Framework.IsNotNullOrEmpty(this.Top('[basecode=&quot;projectQuery&quot;]').OpenSelectRow))\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;paramsprjAtt&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if(Framework.IsNotNullOrEmpty(this.Top('[basecode=&quot;projectQuery&quot;]').OpenSelectRow.projectId))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.PrjId&nbsp;=&nbsp;this.Top('[basecode=&quot;projectQuery&quot;]').OpenSelectRow.projectId.id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.PrjId&nbsp;=&nbsp;this.Top('[basecode=&quot;projectQuery&quot;]').OpenSelectRow.id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.flag&nbsp;=&nbsp;30;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.formId&nbsp;=&nbsp;this.formid;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;paramsprjAtt.engagId&nbsp;=&nbsp;null;\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;PrjAttachment-getPrjAttachment-Query.do&quot;,&nbsp;'get',&nbsp;paramsprjAtt,&nbsp;true,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;me.SetValue(result);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;businessActivity&nbsp;=&nbsp;me.UpForCode(&quot;BusinessActivity&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNotNullOrEmpty(businessActivity)&nbsp;&&&nbsp;businessActivity.ShowLinkButton)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;businessActivity.ShowLinkButton();\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n};\r\n \r\n};"},{"isHide":false,"name":"EntityType","value":"PrjAttachment"},{"isHide":false,"name":"pagination","value":"false"}],"sort":0}
2020-03-09 16:26:14