{
	"action":[
		{
			"code":"ReviewComments",
			"name":"复核意见",
			"property":[
				{
					"isHide":false,
					"name":"IconImg",
					"value":"paperclip.png"
				},
				{
					"isHide":false,
					"name":"AuthorityRemark",
					"value":"复核意见查看"
				},
				{
					"isHide":false,
					"name":"SchemaCode",
					"value":"ReviewCommentsLiNew"
				},
				{
					"isHide":false,
					"name":"IsWindowOpen",
					"value":"true"
				},
				{
					"isHide":false,
					"name":"OnClick",
					"value":"OperatingFun"
				},
				{
					"isHide":false,
					"name":"JavaScript",
					"value":"var registerJavaScript = function () {

 

this.OperatingFun = function () {
    var me = this;
    console.log("OperatingFun ");
    var frm = me.UpForCode("draftReviewBatch");
    var tabCode;
    if (frm.curstate == 30) {
        tabCode = "二级复核"
    } else if (frm.curstate == 40) {
        tabCode = "项目合伙人复核"
    } else if (frm.curstate == 50) {
        tabCode = "分所独立复核"
    } else if (frm.curstate == 60) {
        tabCode = "总所独立复核"
    } else {
        if (!frm.isReview) {
            if (frm.OpenSelectRow.reviewOpinionState30 && frm.OpenSelectRow.reviewOpinionState30.id && frm.OpenSelectRow.reviewOpinionState30.id == 20) {
                tabCode = "二级复核"
            } else if (frm.OpenSelectRow.reviewOpinionState40 && frm.OpenSelectRow.reviewOpinionState40.id && frm.OpenSelectRow.reviewOpinionState40.id == 20) {
                tabCode = "项目合伙人复核"
            } else if (frm.OpenSelectRow.reviewOpinionState50 && frm.OpenSelectRow.reviewOpinionState50.id && frm.OpenSelectRow.reviewOpinionState50.id == 20) {
                tabCode = "分所独立复核"
            } else if (frm.OpenSelectRow.reviewOpinionState60 && frm.OpenSelectRow.reviewOpinionState60.id && frm.OpenSelectRow.reviewOpinionState60.id == 20) {
                tabCode = "总所独立复核"
            }
        }

    }
    var comtree = frm.DownForCode("compositionCustomer");

    //控制复核意见标签页的显示
    var params = {};
    var p = this.UpForCode("draftReviewBatch");
    if (Framework.IsNullOrEmpty(p.projectId.prjId)) {
        if (Framework.IsNullOrEmpty(p.projectId.id)) {
            params.projectId = p.projectId;
        } else {
            params.projectId = p.id;
        }

    } else {
        params.projectId = p.projectId.prjId;
    }

    Framework.AjaxRequest(opener, "DraftReviewBatch-gainManuscriptReviewState.do", 'get', params, false, function (result) {
        if (result.indexOf("30/") == -1 && result.indexOf("40/") == -1 && result.indexOf("50/") == -1 && result.indexOf("60/") == -1) {//二级复核 隐藏
            Framework.Message("复核流程未提交，无法查看复核意见！");
        } else {
            // var url = "UIForm-Web-Schema.json";
            // var parameter = {};
            // parameter.schemaType = "Panel";
            // parameter.schemaCode = me.schemacode;
            // parameter.openTabCode1=tabCode;
            // Framework.OpenForm(me, url, parameter, function (form) {
            //     form.dosstates = result;
            //     form.openTabCode = tabCode;
            //     form.treeselected = comtree.GetSelected()
            //     if (Framework.IsNotNullOrEmpty(frm.isHaveOper)) {
            //         form.haveOper = frm.isHaveOper;
            //     }
            //
            //     if (form.Load) form.Load();
            // });
            var parameter = {};
            parameter.dosstates = result;
            parameter.openTabCode = tabCode;
            parameter.treeselected = comtree.GetSelected();
            if (Framework.IsNotNullOrEmpty(frm.isHaveOper)) {
                parameter.haveOper = frm.isHaveOper;
            }

            var url = "Web-Page.html?schemaCode=" + me.schemacode + "&schemaType=Panel&tag=" + Math.random();
            Framework.WindowOpen(url, me, parameter);
        }
    });
};

 

};"
				}
			],
			"sort":0
		},
		{
			"code":"SubmitResponse",
			"name":"提交回复",
			"property":[
				{
					"isHide":false,
					"name":"AuthorityRemark",
					"value":"提交回复复核意见"
				},
				{
					"isHide":false,
					"name":"OnClick",
					"value":"OnClicka"
				},
				{
					"isHide":false,
					"name":"JavaScript",
					"value":"var registerJavaScript = function () {

 

this.OnClicka = function () {
    console.log("OnClicka");
    var qr = this.UpForCode("draftReviewBatch");
    var p;
    if (Framework.IsNullOrEmpty(qr.projectId.prjId)) {
        p = qr.projectId;
    } else {
        p = qr.projectId.prjId;
    }

    var params = {};

    params.priId = p;
    params.reviewOpinionState = 30;//已回复
    params.manuscriptReviewState = qr.curstate;
    params.reviewer = qr.OpenSelectRow.actor_id;

    Framework.AjaxRequest(me, "ReviewComments-checkAComment.do", 'post', params, false, function (result) {
        if (result) {
            Framework.AjaxRequest(me, "ReviewComments-sendAComment.do", 'post', params, false, function (result) {
                Framework.Message("提交回复成功！")
            }, function (result) {
                Framework.Message("提交回复失败，失败原因：" + result);

            }, false);
        } else {
            Framework.Message("有复核意见还没有填写回复意见！")
        }

    }, function (result) {
        Framework.Message("校验是否有回复信息失败，失败原因：" + result);

    }, false);
};

 

};"
				}
			],
			"sort":2
		},
		{
			"code":"ProjectInfo",
			"name":"项目信息",
			"property":[
				{
					"isHide":false,
					"name":"AuthorityRemark",
					"value":"查看项目信息"
				},
				{
					"isHide":false,
					"name":"OnClick",
					"value":"ProjectInfoOnClick"
				},
				{
					"isHide":false,
					"name":"JavaScript",
					"value":"var registerJavaScript = function () {

 

this.ProjectInfoOnClick = function () {
    var me = this;
    console.log('项目信息')
    var qr = me.UpForCode("draftReviewBatch");

    if (Framework.IsNullOrEmpty(qr.projectId)) return;

    var p = Framework.IsNullOrEmpty(qr.projectId.prjId) ? qr.projectId : qr.projectId.prjId;

    var params = {};
    params.prjId = p;

    var financialReportProject;

    Framework.AjaxRequest(me, "Project-gainFinancialReportProject-Query.do", 'get', params, false, function (result) {
        financialReportProject = result;
    }, function (result) {
        financialReportProject = 10;
    }, false);

    var url = "UIForm-Web-Schema.json";
    var parameter = {};
    parameter.schemaType = "Panel";
    if (financialReportProject == 10) {
        parameter.schemaCode = "ProjectManage";
    } else {
        parameter.schemaCode = "NonReportProjectManage";
    }

    parameter.readOnly = true;

    Framework.OpenForm(me, url, parameter, function (form) {
        form.FinancialReportProject = financialReportProject;
        form.Draft = true;
        //form.Pid=p;
        form.projectId = p;
        if (form.Load) form.Load();//p
    });
};

 

};"
				}
			],
			"sort":4
		},
		{
			"code":"SendaComment",
			"name":"下发意见",
			"property":[
				{
					"isHide":false,
					"name":"AuthorityRemark",
					"value":"下发复核意见"
				},
				{
					"isHide":false,
					"name":"OnClick",
					"value":"OnClicka"
				},
				{
					"isHide":false,
					"name":"JavaScript",
					"value":"var registerJavaScript = function () {

 

this.OnClicka = function () {
    console.log("OnClicka");

    var t = this.Top();
    var qr = t.DownForCode("draftReviewBatch");
    var p;
    if (Framework.IsNullOrEmpty(qr.projectId.prjId)) {
        p = qr.projectId;
    } else {
        p = qr.projectId.prjId;
    }
    var btn = this;
    var params = {};
    params.priId = p;
    params.reviewOpinionState = 20;//待回复
    params.manuscriptReviewState = qr.curstate;
    params.reviewer = qr.OpenSelectRow.actor_id;

    Framework.AjaxRequest(me, "ReviewComments-checkAComment.do", 'get', params, false, function (result) {
        if (result) {
            if (Framework.IsNotNullOrEmpty(qr.OpenSelectRow.allocations) && qr.OpenSelectRow.allocations > 1) {
                Framework.Confirm("当前项目存在多位复核人复核，下发后将不能添加复核意见，是否确认下发？", function () {
                    Framework.Confirm("下发意见后，只有意见回复之后才能再次下发，确定要下发吗？", function () {
                        Framework.AjaxRequest(me, "ReviewComments-sendAComment.do", 'get', params, false, function (result) {
                            if (result == 0) {
                                Framework.Message("请先添加复核意见！");
                            } else {
                                btn.SetVisible(true);
                                Framework.Message("下发意见成功！");
                            //    t.Close();
                            }

                        }, function (result) {
                            Framework.Message("下发意见失败，失败原因：" + result);
                        }, false);
                    });
                });
            } else {
                Framework.Confirm("下发意见后，只有意见回复之后才能再次下发，确定要下发吗？", function () {
                    Framework.AjaxRequest(me, "ReviewComments-sendAComment.do", 'get', params, false, function (result) {
                        if (result == 0) {
                            Framework.Message("请先添加复核意见！");
                        } else {
                            btn.SetVisible(true);
                            Framework.Message("下发意见成功！");
                    //        t.Close();
                        }

                    }, function (result) {
                        Framework.Message("下发意见失败，失败原因：" + result);
                    }, false);
                });
            }

        } else {
            Framework.Message("请先添加复核意见！")
        }

    }, function (result) {
        Framework.Message("校验失败，失败原因：" + result);

    }, false);
};

 

};"
				}
			],
			"sort":3
		},
		{
			"code":"Back",
			"name":"Back",
			"property":[
				
			],
			"sort":1
		},
		{
			"code":"Refresh",
			"name":"刷新",
			"property":[
				{
					"isHide":false,
					"name":"OnClick",
					"value":"OnClicka"
				},
				{
					"isHide":false,
					"name":"JavaScript",
					"value":"var registerJavaScript = function () {

 

this.OnClicka = function () {
    console.log("刷新OnClicka");
    var panel = this.Top("[container='FormPanel']");
    if (Framework.IsNullOrEmpty(panel)) return;
    var itemTree = panel.DownForCode('manuscriptItem');

    if (Framework.IsNullOrEmpty(itemTree)) return;
    if (!itemTree.Load) return;
    var node =itemTree.GetSelected();
    if(Framework.IsNotNullOrEmpty(node)){
        itemTree.refresh=true;
        itemTree.defaultid = node.id;
    }

    itemTree.Load();

};

 

};"
				}
			],
			"sort":5
		}
	],
	"authority":[
		
	],
	"children":[
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						{
							"action":[
								
							],
							"authority":[
								
							],
							"children":[
								
							],
							"dataPermission":[
								
							],
							"isReference":false,
							"otherChildren":[
								
							],
							"property":[
								{
									"isHide":true,
									"name":"referenceFormId",
									"value":23827
								}
							],
							"sort":0
						}
					],
					"code":"west",
					"control":"West",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"项目架构",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"width",
							"value":"305"
						},
						{
							"isHide":false,
							"name":"style:border-radius",
							"value":"0"
						},
						{
							"isHide":false,
							"name":"isTitle",
							"value":"false"
						}
					],
					"sort":7
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						{
							"action":[
								
							],
							"authority":[
								
							],
							"children":[
								
							],
							"code":"centerTitle",
							"control":"PanelTitle",
							"dataPermission":[
								
							],
							"isReference":false,
							"name":"|  底稿目录",
							"otherChildren":[
								
							],
							"property":[
								{
									"isHide":false,
									"name":"style:color",
									"value":"#1f95d3"
								},
								{
									"isHide":false,
									"name":"style:margin-left",
									"value":"25px"
								},
								{
									"isHide":false,
									"name":"style:font-weight",
									"value":"normal"
								},
								{
									"isHide":false,
									"name":"style:margin-top",
									"value":"10px"
								}
							],
							"sort":2
						},
						{
							"action":[
								
							],
							"authority":[
								
							],
							"children":[
								{
									"action":[
										
									],
									"authority":[
										
									],
									"children":[
										
									],
									"dataPermission":[
										
									],
									"isReference":false,
									"otherChildren":[
										
									],
									"property":[
										{
											"isHide":true,
											"name":"referenceFormId",
											"value":23614
										}
									],
									"sort":0
								}
							],
							"code":"centerPanel",
							"control":"Panel",
							"dataPermission":[
								
							],
							"isReference":false,
							"javaScript":"",
							"name":"树容器",
							"otherChildren":[
								
							],
							"property":[
								{
									"isHide":false,
									"name":"Height",
									"value":"95%"
								}
							],
							"sort":3
						}
					],
					"code":"center",
					"control":"Center",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"| 底稿目录",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"isTitle",
							"value":"false"
						},
						{
							"isHide":false,
							"name":"style:border-radius",
							"value":"0"
						},
						{
							"isHide":false,
							"name":"style:margin-top",
							"value":"0"
						}
					],
					"sort":9
				},
				{
					"action":[
						
					],
					"authority":[
						
					],
					"children":[
						{
							"action":[
								
							],
							"authority":[
								
							],
							"children":[
								
							],
							"code":"workingPapers",
							"control":"PanelTitle",
							"dataPermission":[
								
							],
							"isReference":false,
							"name":"|  工作底稿",
							"otherChildren":[
								
							],
							"property":[
								{
									"isHide":false,
									"name":"style:margin",
									"value":"10px 0 0 35px"
								},
								{
									"isHide":false,
									"name":"style:color",
									"value":"#1f95d3"
								},
								{
									"isHide":false,
									"name":"style:font-weight",
									"value":"normal"
								}
							],
							"sort":4
						},
						{
							"action":[
								
							],
							"authority":[
								
							],
							"children":[
								{
									"action":[
										
									],
									"authority":[
										
									],
									"children":[
										
									],
									"dataPermission":[
										
									],
									"isReference":false,
									"otherChildren":[
										
									],
									"property":[
										{
											"isHide":true,
											"name":"referenceFormId",
											"value":23911
										}
									],
									"sort":0
								}
							],
							"code":"gridPanel",
							"control":"Panel",
							"dataPermission":[
								
							],
							"isReference":false,
							"javaScript":"",
							"name":"表格容器",
							"otherChildren":[
								
							],
							"property":[
								{
									"isHide":false,
									"name":"Height",
									"value":"95%"
								}
							],
							"sort":6
						},
						{
							"action":[
								
							],
							"authority":[
								
							],
							"children":[
								
							],
							"code":"btn_revision",
							"control":"LinkButton",
							"dataPermission":[
								
							],
							"isReference":false,
							"javaScript":"this.BeforeHandler = function () {
    var me = this;
    console.log("sdadasd");
    //debugger;
    var t=this.Top();
    var tree=t.DownForCode("manuscriptItemTree");
    var node =tree.GetSelected();
    if(node && node.delete)
    {
        var rightGrid = this.UpForCode("rightGrid");
        var Revision=rightGrid.DownForCode("Revision");
        Revision.OnClick();
    }

    return false;
};",
							"name":"已删除底稿",
							"otherChildren":[
								
							],
							"property":[
								{
									"isHide":false,
									"name":"IsLinkstyle",
									"value":"true"
								},
								{
									"isHide":false,
									"name":"class",
									"value":"papersBtn"
								},
								{
									"isHide":false,
									"name":"JavaScript",
									"value":"var registerJavaScript = function () {

 

this.BeforeHandler = function () {
    var me = this;
    console.log("sdadasd");
    //debugger;
    var t=this.Top();
    var tree=t.DownForCode("manuscriptItemTree");
    var node =tree.GetSelected();
    if(node && node.delete)
    {
        var rightGrid = this.UpForCode("rightGrid");
        var Revision=rightGrid.DownForCode("Revision");
        Revision.OnClick();
    }

    return false;
};

 

};"
								}
							],
							"sort":5
						}
					],
					"code":"rightGrid",
					"control":"East",
					"dataPermission":[
						
					],
					"isReference":false,
					"name":"审计工作底稿",
					"otherChildren":[
						
					],
					"property":[
						{
							"isHide":false,
							"name":"isTitle",
							"value":"false"
						},
						{
							"isHide":false,
							"name":"style:border-left",
							"value":"1px solid rgba(232,235,243,0.7)"
						},
						{
							"isHide":false,
							"name":"width",
							"value":"55%"
						}
					],
					"sort":11
				}
			],
			"code":"mainPanel",
			"control":"Alyout",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"主Panel",
			"otherChildren":[
				
			],
			"property":[
				{
					"isHide":false,
					"name":"class",
					"value":"easyui-layout layout easyui-fluid dx_layout dx_review dx_notitle"
				},
				{
					"isHide":false,
					"name":"style:border-radius",
					"value":"0"
				}
			],
			"sort":1
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"id",
			"control":"Hidden",
			"dataPermission":[
				
			],
			"isReference":false,
			"javaScript":"",
			"name":"Id",
			"otherChildren":[
				
			],
			"property":[
				{
					"isHide":false,
					"name":"Length",
					"value":16
				},
				{
					"isHide":false,
					"name":"Required",
					"value":true
				},
				{
					"isHide":false,
					"name":"IsReadOnly",
					"value":false
				},
				{
					"isHide":false,
					"name":"IsTransient",
					"value":false
				}
			],
			"select":"Id",
			"sort":0
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"rightBuoy",
			"control":"RightBuoy",
			"dataPermission":[
				
			],
			"isReference":false,
			"javaScript":"this.OnClick = function () {
    var me = this;
    var frm = me.UpForCode("draftReviewBatch");
    var tabCode;
    if (frm.curstate == 30) {
        tabCode = "二级复核";
    } else if (frm.curstate == 40) {
        tabCode = "项目合伙人复核";
    } else if (frm.curstate == 50) {
        tabCode = "分所独立复核";
    } else if (frm.curstate == 60) {
        tabCode = "总所独立复核";
    } else {
        if (!frm.isReview) {
            if (
                frm.OpenSelectRow.reviewOpinionState30 &&
                frm.OpenSelectRow.reviewOpinionState30.id &&
                frm.OpenSelectRow.reviewOpinionState30.id == 20
            ) {
                tabCode = "二级复核";
            } else if (
                frm.OpenSelectRow.reviewOpinionState40 &&
                frm.OpenSelectRow.reviewOpinionState40.id &&
                frm.OpenSelectRow.reviewOpinionState40.id == 20
            ) {
                tabCode = "项目合伙人复核";
            } else if (
                frm.OpenSelectRow.reviewOpinionState50 &&
                frm.OpenSelectRow.reviewOpinionState50.id &&
                frm.OpenSelectRow.reviewOpinionState50.id == 20
            ) {
                tabCode = "分所独立复核";
            } else if (
                frm.OpenSelectRow.reviewOpinionState60 &&
                frm.OpenSelectRow.reviewOpinionState60.id &&
                frm.OpenSelectRow.reviewOpinionState60.id == 20
            ) {
                tabCode = "总所独立复核";
            }
        }
    }

    var comtree = frm.DownForCode("compositionCustomer");
    //控制复核意见标签页的显示
    var params = {};
    var p = this.UpForCode("draftReviewBatch");
    if (Framework.IsNullOrEmpty(p.projectId.prjId)) {
        if (Framework.IsNullOrEmpty(p.projectId.id)) {
            params.projectId = p.projectId;
        } else {
            params.projectId = p.id;
        }
    } else {
        params.projectId = p.projectId.prjId;
    }
    var url = 'DraftReviewBatch-gainManuscriptReviewState.do'
    Framework.AjaxRequest(opener, url, "get", params, false, function (result) {
        if (result.indexOf("30/") == -1) {
            //二级复核 隐藏
            Framework.Message("复核流程未提交，无法查看复核意见！");
        } else {
            // var url = "UIForm-Web-Schema.json";
            // var parameter = {};
            // parameter.schemaType = "Panel";
            // parameter.schemaCode = me.schemacode;
            // // parameter.openTabCode1=tabCode;
            // Framework.OpenForm(me, url, parameter, function (form) {
            //     form.dosstates = result;
            //     form.openTabCode = tabCode;
            //     form.treeselected = comtree.GetSelected();
            //     if (Framework.IsNotNullOrEmpty(frm.isHaveOper)) {
            //         form.haveOper = frm.isHaveOper;
            //     }
            //     if (form.Load) form.Load();
            // });
            var parameter = {};
            parameter.dosstates = result;
            parameter.openTabCode = tabCode;
            parameter.treeselected = comtree.GetSelected();
            if (Framework.IsNotNullOrEmpty(frm.isHaveOper)) {
                parameter.haveOper = frm.isHaveOper;
            }

            var url = "Web-Page.html?schemaCode=" + me.schemacode + "&schemaType=Panel&tag=" + Math.random();
            Framework.WindowOpen(url, me, parameter);
        }
    });
}",
			"name":"复核意见",
			"otherChildren":[
				
			],
			"property":[
				{
					"isHide":false,
					"name":"value",
					"value":"复核意见"
				},
				{
					"isHide":false,
					"name":"SchemaCode",
					"value":"ReviewCommentsLiNew"
				},
				{
					"isHide":false,
					"name":"AuthorityRemark",
					"value":"复核按钮悬浮"
				},
				{
					"isHide":false,
					"name":"IsWindowOpen",
					"value":"true"
				},
				{
					"isHide":false,
					"name":"JavaScript",
					"value":"var registerJavaScript = function () {

 

this.OnClick = function () {
    var me = this;
    var frm = me.UpForCode("draftReviewBatch");
    var tabCode;
    if (frm.curstate == 30) {
        tabCode = "二级复核";
    } else if (frm.curstate == 40) {
        tabCode = "项目合伙人复核";
    } else if (frm.curstate == 50) {
        tabCode = "分所独立复核";
    } else if (frm.curstate == 60) {
        tabCode = "总所独立复核";
    } else {
        if (!frm.isReview) {
            if (
                frm.OpenSelectRow.reviewOpinionState30 &&
                frm.OpenSelectRow.reviewOpinionState30.id &&
                frm.OpenSelectRow.reviewOpinionState30.id == 20
            ) {
                tabCode = "二级复核";
            } else if (
                frm.OpenSelectRow.reviewOpinionState40 &&
                frm.OpenSelectRow.reviewOpinionState40.id &&
                frm.OpenSelectRow.reviewOpinionState40.id == 20
            ) {
                tabCode = "项目合伙人复核";
            } else if (
                frm.OpenSelectRow.reviewOpinionState50 &&
                frm.OpenSelectRow.reviewOpinionState50.id &&
                frm.OpenSelectRow.reviewOpinionState50.id == 20
            ) {
                tabCode = "分所独立复核";
            } else if (
                frm.OpenSelectRow.reviewOpinionState60 &&
                frm.OpenSelectRow.reviewOpinionState60.id &&
                frm.OpenSelectRow.reviewOpinionState60.id == 20
            ) {
                tabCode = "总所独立复核";
            }
        }
    }

    var comtree = frm.DownForCode("compositionCustomer");
    //控制复核意见标签页的显示
    var params = {};
    var p = this.UpForCode("draftReviewBatch");
    if (Framework.IsNullOrEmpty(p.projectId.prjId)) {
        if (Framework.IsNullOrEmpty(p.projectId.id)) {
            params.projectId = p.projectId;
        } else {
            params.projectId = p.id;
        }
    } else {
        params.projectId = p.projectId.prjId;
    }
    var url = 'DraftReviewBatch-gainManuscriptReviewState.do'
    Framework.AjaxRequest(opener, url, "get", params, false, function (result) {
        if (result.indexOf("30/") == -1) {
            //二级复核 隐藏
            Framework.Message("复核流程未提交，无法查看复核意见！");
        } else {
            // var url = "UIForm-Web-Schema.json";
            // var parameter = {};
            // parameter.schemaType = "Panel";
            // parameter.schemaCode = me.schemacode;
            // // parameter.openTabCode1=tabCode;
            // Framework.OpenForm(me, url, parameter, function (form) {
            //     form.dosstates = result;
            //     form.openTabCode = tabCode;
            //     form.treeselected = comtree.GetSelected();
            //     if (Framework.IsNotNullOrEmpty(frm.isHaveOper)) {
            //         form.haveOper = frm.isHaveOper;
            //     }
            //     if (form.Load) form.Load();
            // });
            var parameter = {};
            parameter.dosstates = result;
            parameter.openTabCode = tabCode;
            parameter.treeselected = comtree.GetSelected();
            if (Framework.IsNotNullOrEmpty(frm.isHaveOper)) {
                parameter.haveOper = frm.isHaveOper;
            }

            var url = "Web-Page.html?schemaCode=" + me.schemacode + "&schemaType=Panel&tag=" + Math.random();
            Framework.WindowOpen(url, me, parameter);
        }
    });
}

 

};"
				}
			],
			"sort":13
		},
		{
			"action":[
				
			],
			"authority":[
				
			],
			"children":[
				
			],
			"code":"uuid",
			"control":"Hidden",
			"dataPermission":[
				
			],
			"isReference":false,
			"name":"uuid",
			"otherChildren":[
				
			],
			"property":[
				
			],
			"sort":1000
		}
	],
	"code":"qualityReview",
	"control":"FormPanel",
	"dataPermission":[
		
	],
	"isReference":false,
	"javaScript":"this.BeforeLoad = function () {
    console.log("BeforeLoad 底稿复核");

    var thisfrm = this;
    var WorkFlowPassbtn = this.DownForCode("WorkFlowPass");
    var WorkFlowNotPassbtn = this.DownForCode("WorkFlowNotPass");
    var btn = this.DownForCode("WorkFlowSubmit");
    var SendaCommentbtn = this.DownForCode("SendaComment");
    var WorkFlowRemarksle = this.DownForCode("WorkFlowRemark");
    var Revision = this.DownForCode("Revision");
    Revision.SetVisible(true);

    if (WorkFlowPassbtn) WorkFlowPassbtn.SetTextValue("通过");
    if (WorkFlowNotPassbtn) WorkFlowNotPassbtn.SetTextValue("退回");
    if (btn) {
        btn.SetTextValue("提交复核")
    }
    var SubmitResponsebtn = this.DownForCode("SubmitResponse");

    var frm = this.DownForCode("compositionCustomer");
    var params = {};
    params.param = "projectId";

    var o = this.Opener;
    var pid;

    this.item = this.Opener.item;

    if (Framework.IsNullOrEmpty(this.item)) {
        var top1 = o.Top();
        if (top1.code == "approval5Independent") {
            this.item = top1.item;
        } else {
            if (top1.DownForCode) {
                var frm2 = top1.DownForCode("approval5Independent");
                if (frm2) {
                    this.item = frm2.item;
                }
            }
        }


    }

    if (Framework.IsNullOrEmpty(this.item) || !this.item.review) {//我的项目
        if (Framework.IsNullOrEmpty(this.item) || this.item.code == 5)// 已完成 当前项目所处于的审核状态  0表示没有处于审核中的
        {
            if ((o.GetSelected().manuscriptReviewState.id > 10 && o.GetSelected().manuscriptReviewState.id < 70 || this.OpenSelectRow.zReview > 0)) {
                thisfrm.prjState = 1;
            } else {
                if (o.GetSelected().manuscriptReviewState.id == 70) {
                    if (btn) btn.SetVisible(true);
                    if (SubmitResponsebtn) SubmitResponsebtn.SetVisible(true);
                    this.isHaveOper = "F";
                }


                thisfrm.prjState = 0;
            }

        } else {
            thisfrm.prjState = 1;
        }

        pid = o.GetSelected().prjId;
        if (Framework.IsNullOrEmpty(pid)) {
            pid = o.GetSelected().id;
        }
        this.projectId = o.GetSelected();
        var btnsac = this.DownForCode("SendaComment"); //下发意见 隐藏
        if (Framework.IsNotNullOrEmpty(btnsac))
            btnsac.SetVisible(true); //AfterRender 方法中获取不到this.Opener
        this.isReview = false; //不是从代办复核界面进入的

        if (this.OpenSelectRow.projectManagerId != AppContext.Profile.id || this.OpenSelectRow.zReview > 0) //大项目经理可见 提交复核 提交回复 按钮
        {
            if (btn) btn.SetVisible(true);
            if (this.OpenSelectRow.projectManagerId != AppContext.Profile.id) {
                if (SubmitResponsebtn) SubmitResponsebtn.SetVisible(true);
            }
        }


    } else {
        var s = this.OpenSelectRow;
        pid = s.prjId;
        this.curstate = s.wfstate;
        this.projectId = pid;
        this.isReview = true; //从代办复核界面进入的
        
        if (o.code == "manuscriptToReview1" || o.code == "manuscriptToReview11" || o.code == "theManuscriptBranchHasBeenCompleted" || o.code == "theGeneralInstituteHasBeenCompleted" || o.code == "theGeneralInstituteHasBeenCompletedIndependent") { //已完成
            // this.DownForCode("ReviewComments").SetVisible(true);

            
            if (SubmitResponsebtn)
                SubmitResponsebtn.SetVisible(true);

            // this.DownForCode("SubmitResponse").SetVisible(true);
            if (WorkFlowPassbtn) {
                WorkFlowPassbtn.SetVisible(true);
            }

            if (SendaCommentbtn)
                 SendaCommentbtn.SetVisible(true);

            if (WorkFlowNotPassbtn) {
                WorkFlowNotPassbtn.SetVisible(true);
            }
        }else{
            if (SubmitResponsebtn)
                SubmitResponsebtn.SetVisible(true); //代办进来 提交回复隐藏 隐藏
//从代办进来，下发过复核意见 就隐藏下发复核意见按钮
            var SendaCommentb = this.DownForCode("SendaComment");
            if (Framework.IsNullOrEmpty(s.xfstate) || s.xfstate == 10) {
                if (SendaCommentb)
                    SendaCommentb.SetVisible(false); //下发意见 显示
            } else {
                var reviewOpinionStateid = Framework.IsNullOrEmpty(s.reviewOpinionState.id) ? s.reviewOpinionState : s.reviewOpinionState.id;
                if (reviewOpinionStateid == 30 && s.whetherShow) {
                    if (SendaCommentb)
                        SendaCommentb.SetVisible(false);
                } else {
                    if (SendaCommentb)
                        SendaCommentb.SetVisible(true);
                }
            }
            
        }
        
        if (AppContext.Profile.id != s.actor_id) {//当前登录人 没有 复核权限
            if (WorkFlowPassbtn) {
                WorkFlowPassbtn.readonlyshow = false;
                WorkFlowPassbtn.SetVisible(true);
            }

            if (WorkFlowNotPassbtn) {
                WorkFlowNotPassbtn.readonlyshow = false;
                WorkFlowNotPassbtn.SetVisible(true);
            }
            // if (SendaCommentbtn)
            //     SendaCommentbtn.SetVisible(true);

            if (WorkFlowRemarksle)
                WorkFlowRemarksle.SetVisible(true);
        }
    }
    params.value = pid;

    if (thisfrm.prjState == 0) {


    } else {
        if (btn) {
            btn.SetVisible(true);
        }
    }

    var paraList = [];
    paraList.push(params);
    paraList.push({'param': "isReview", "value": this.isReview})//是否通过复核页面进来的
    frm.params = JSON.stringify(paraList);
    frm.Load();

};

this.GetWorkFlowParameter = function (parameter, action) {
    console.log("GetWorkFlowParameter ");
    var methis =this;

    //调用插入批次接口返回批次id,时间戳，entityType
    var c = this.DownForCode("compositionCustomer");
    var id = this.DownForCode("id");

    var s = c.GetCheckedNode();
    //    if (s.length == 0) {
    //       Framework.Message("至少选择一条数据操作！");
    //       return ;
    //  }

    var param = [];

    for (var i = 0; i < s.length; i++) {
        param.push(s[i].id);
    }

    var params = {};

    var pid;
    if (Framework.IsNullOrEmpty(this.projectId.id)) {
        pid = this.projectId;
    } else {
        pid = this.projectId.id;
    }

    params.projectId = pid;
    params.compositionCustomerId = JSON.stringify(param);

    Framework.AjaxRequest(methis, "DraftReviewBatch-saveDraftReviewBatch.do", 'get', params, false, function (result) {
        parameter.entityId = result.id;
        id.SetValue(result.id);
        parameter.timestamp = result.timestamp;
        parameter.entityType = result.entityType;
        if (Framework.IsFunction(action)) action(parameter);
    });
};

this.BeforeWorkFlowSubmit = function () {

    console.log("BeforeWorkFlowSubmit ");
    var param = {};
    if (Framework.IsNullOrEmpty(this.projectId.id)) {
        param.prjId = this.projectId;
    } else {
        param.prjId = this.projectId.id;
    }

    var c = this.DownForCode("compositionCustomer");

    var s = c.GetCheckedNode();
    if (s.length == 0) {
        Framework.Message("未选择提交复核的被审计单位！");
        return false;
    }

    for (var i = 0; i < s.length; i++) {
        if (s[i].complete == 10) {
            Framework.Message("项目有存在未上传底稿，不能进行提交复核!");
            return false;
        }
    }
};

this.AfterRender = function () {
    console.log("AfterRender ");
    var win = this.Top("[controltype='Window']");
    if (win) win.IsRefreshOpener = true;
};",
	"name":"质量复核",
	"otherChildren":[
		
	],
	"property":[
		{
			"isHide":false,
			"name":"BaseCode",
			"value":"qualityReview"
		},
		{
			"isHide":false,
			"name":"Name",
			"value":"质量复核"
		},
		{
			"isHide":false,
			"name":"IsReadOnly",
			"value":false
		},
		{
			"isHide":false,
			"name":"Description"
		},
		{
			"isHide":false,
			"name":"FormId",
			"value":23828
		},
		{
			"isHide":false,
			"name":"OrderBy",
			"value":"Sort"
		},
		{
			"isHide":false,
			"name":"IsSqlForm",
			"value":false
		},
		{
			"isHide":false,
			"name":"JavaScript",
			"value":"var registerJavaScript = function () {

 

this.BeforeLoad = function () {
    console.log("BeforeLoad 底稿复核");

    var thisfrm = this;
    var WorkFlowPassbtn = this.DownForCode("WorkFlowPass");
    var WorkFlowNotPassbtn = this.DownForCode("WorkFlowNotPass");
    var btn = this.DownForCode("WorkFlowSubmit");
    var SendaCommentbtn = this.DownForCode("SendaComment");
    var WorkFlowRemarksle = this.DownForCode("WorkFlowRemark");
    var Revision = this.DownForCode("Revision");
    Revision.SetVisible(true);

    if (WorkFlowPassbtn) WorkFlowPassbtn.SetTextValue("通过");
    if (WorkFlowNotPassbtn) WorkFlowNotPassbtn.SetTextValue("退回");
    if (btn) {
        btn.SetTextValue("提交复核")
    }
    var SubmitResponsebtn = this.DownForCode("SubmitResponse");

    var frm = this.DownForCode("compositionCustomer");
    var params = {};
    params.param = "projectId";

    var o = this.Opener;
    var pid;

    this.item = this.Opener.item;

    if (Framework.IsNullOrEmpty(this.item)) {
        var top1 = o.Top();
        if (top1.code == "approval5Independent") {
            this.item = top1.item;
        } else {
            if (top1.DownForCode) {
                var frm2 = top1.DownForCode("approval5Independent");
                if (frm2) {
                    this.item = frm2.item;
                }
            }
        }


    }

    if (Framework.IsNullOrEmpty(this.item) || !this.item.review) {//我的项目
        if (Framework.IsNullOrEmpty(this.item) || this.item.code == 5)// 已完成 当前项目所处于的审核状态  0表示没有处于审核中的
        {
            if ((o.GetSelected().manuscriptReviewState.id > 10 && o.GetSelected().manuscriptReviewState.id < 70 || this.OpenSelectRow.zReview > 0)) {
                thisfrm.prjState = 1;
            } else {
                if (o.GetSelected().manuscriptReviewState.id == 70) {
                    if (btn) btn.SetVisible(true);
                    if (SubmitResponsebtn) SubmitResponsebtn.SetVisible(true);
                    this.isHaveOper = "F";
                }


                thisfrm.prjState = 0;
            }

        } else {
            thisfrm.prjState = 1;
        }

        pid = o.GetSelected().prjId;
        if (Framework.IsNullOrEmpty(pid)) {
            pid = o.GetSelected().id;
        }
        this.projectId = o.GetSelected();
        var btnsac = this.DownForCode("SendaComment"); //下发意见 隐藏
        if (Framework.IsNotNullOrEmpty(btnsac))
            btnsac.SetVisible(true); //AfterRender 方法中获取不到this.Opener
        this.isReview = false; //不是从代办复核界面进入的

        if (this.OpenSelectRow.projectManagerId != AppContext.Profile.id || this.OpenSelectRow.zReview > 0) //大项目经理可见 提交复核 提交回复 按钮
        {
            if (btn) btn.SetVisible(true);
            if (this.OpenSelectRow.projectManagerId != AppContext.Profile.id) {
                if (SubmitResponsebtn) SubmitResponsebtn.SetVisible(true);
            }
        }


    } else {
        var s = this.OpenSelectRow;
        pid = s.prjId;
        this.curstate = s.wfstate;
        this.projectId = pid;
        this.isReview = true; //从代办复核界面进入的
        
        if (o.code == "manuscriptToReview1" || o.code == "manuscriptToReview11" || o.code == "theManuscriptBranchHasBeenCompleted" || o.code == "theGeneralInstituteHasBeenCompleted" || o.code == "theGeneralInstituteHasBeenCompletedIndependent") { //已完成
            // this.DownForCode("ReviewComments").SetVisible(true);

            
            if (SubmitResponsebtn)
                SubmitResponsebtn.SetVisible(true);

            // this.DownForCode("SubmitResponse").SetVisible(true);
            if (WorkFlowPassbtn) {
                WorkFlowPassbtn.SetVisible(true);
            }

            if (SendaCommentbtn)
                 SendaCommentbtn.SetVisible(true);

            if (WorkFlowNotPassbtn) {
                WorkFlowNotPassbtn.SetVisible(true);
            }
        }else{
            if (SubmitResponsebtn)
                SubmitResponsebtn.SetVisible(true); //代办进来 提交回复隐藏 隐藏
//从代办进来，下发过复核意见 就隐藏下发复核意见按钮
            var SendaCommentb = this.DownForCode("SendaComment");
            if (Framework.IsNullOrEmpty(s.xfstate) || s.xfstate == 10) {
                if (SendaCommentb)
                    SendaCommentb.SetVisible(false); //下发意见 显示
            } else {
                var reviewOpinionStateid = Framework.IsNullOrEmpty(s.reviewOpinionState.id) ? s.reviewOpinionState : s.reviewOpinionState.id;
                if (reviewOpinionStateid == 30 && s.whetherShow) {
                    if (SendaCommentb)
                        SendaCommentb.SetVisible(false);
                } else {
                    if (SendaCommentb)
                        SendaCommentb.SetVisible(true);
                }
            }
            
        }
        
        if (AppContext.Profile.id != s.actor_id) {//当前登录人 没有 复核权限
            if (WorkFlowPassbtn) {
                WorkFlowPassbtn.readonlyshow = false;
                WorkFlowPassbtn.SetVisible(true);
            }

            if (WorkFlowNotPassbtn) {
                WorkFlowNotPassbtn.readonlyshow = false;
                WorkFlowNotPassbtn.SetVisible(true);
            }
            // if (SendaCommentbtn)
            //     SendaCommentbtn.SetVisible(true);

            if (WorkFlowRemarksle)
                WorkFlowRemarksle.SetVisible(true);
        }
    }
    params.value = pid;

    if (thisfrm.prjState == 0) {


    } else {
        if (btn) {
            btn.SetVisible(true);
        }
    }

    var paraList = [];
    paraList.push(params);
    paraList.push({'param': "isReview", "value": this.isReview})//是否通过复核页面进来的
    frm.params = JSON.stringify(paraList);
    frm.Load();

};

this.GetWorkFlowParameter = function (parameter, action) {
    console.log("GetWorkFlowParameter ");
    var methis =this;

    //调用插入批次接口返回批次id,时间戳，entityType
    var c = this.DownForCode("compositionCustomer");
    var id = this.DownForCode("id");

    var s = c.GetCheckedNode();
    //    if (s.length == 0) {
    //       Framework.Message("至少选择一条数据操作！");
    //       return ;
    //  }

    var param = [];

    for (var i = 0; i < s.length; i++) {
        param.push(s[i].id);
    }

    var params = {};

    var pid;
    if (Framework.IsNullOrEmpty(this.projectId.id)) {
        pid = this.projectId;
    } else {
        pid = this.projectId.id;
    }

    params.projectId = pid;
    params.compositionCustomerId = JSON.stringify(param);

    Framework.AjaxRequest(methis, "DraftReviewBatch-saveDraftReviewBatch.do", 'get', params, false, function (result) {
        parameter.entityId = result.id;
        id.SetValue(result.id);
        parameter.timestamp = result.timestamp;
        parameter.entityType = result.entityType;
        if (Framework.IsFunction(action)) action(parameter);
    });
};

this.BeforeWorkFlowSubmit = function () {

    console.log("BeforeWorkFlowSubmit ");
    var param = {};
    if (Framework.IsNullOrEmpty(this.projectId.id)) {
        param.prjId = this.projectId;
    } else {
        param.prjId = this.projectId.id;
    }

    var c = this.DownForCode("compositionCustomer");

    var s = c.GetCheckedNode();
    if (s.length == 0) {
        Framework.Message("未选择提交复核的被审计单位！");
        return false;
    }

    for (var i = 0; i < s.length; i++) {
        if (s[i].complete == 10) {
            Framework.Message("项目有存在未上传底稿，不能进行提交复核!");
            return false;
        }
    }
};

this.AfterRender = function () {
    console.log("AfterRender ");
    var win = this.Top("[controltype='Window']");
    if (win) win.IsRefreshOpener = true;
};

 

};"
		},
		{
			"isHide":false,
			"name":"EntityType",
			"value":"DraftReviewBatch"
		},
		{
			"isHide":false,
			"name":"createurl",
			"value":"\"\""
		},
		{
			"container":"Window",
			"isHide":false,
			"name":"collapsible",
			"value":"true"
		},
		{
			"isHide":false,
			"name":"HelpPrompt",
			"value":""
		},
		{
			"isHide":false,
			"name":"style:background",
			"value":"#e9e9eb"
		},
		{
			"isHide":false,
			"name":"classgroup",
			"value":"bRadiusB"
		},
		{
			"container":"Window",
			"isHide":false,
			"name":"Width",
			"value":"100%"
		},
		{
			"container":"Window",
			"isHide":false,
			"name":"Height",
			"value":"100%"
		},
		{
			"container":"Window",
			"isHide":false,
			"name":"style:top",
			"value":"0"
		},
		{
			"container":"Window",
			"isHide":false,
			"name":"style:left",
			"value":"0"
		},
		{
			"isHide":false,
			"name":"IsShowRefresh",
			"value":"false"
		},
		{
			"isHide":false,
			"name":"IsShowBackButton",
			"value":"false"
		},
		{
			"isHide":false,
			"name":"modifyUrl",
			"value":"\"\""
		}
	],
	"sort":0
}
{"action":[{"code":"ReviewComments","name":"复核意见","property":[{"isHide":false,"name":"IconImg","value":"paperclip.png"},{"isHide":false,"name":"AuthorityRemark","value":"复核意见查看"},{"isHide":false,"name":"SchemaCode","value":"ReviewCommentsLiNew"},{"isHide":false,"name":"IsWindowOpen","value":"true"},{"isHide":false,"name":"OnClick","value":"OperatingFun"},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.OperatingFun&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;OperatingFun&nbsp;&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;frm&nbsp;=&nbsp;me.UpForCode(&quot;draftReviewBatch&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tabCode;\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(frm.curstate&nbsp;==&nbsp;30)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;二级复核&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(frm.curstate&nbsp;==&nbsp;40)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;项目合伙人复核&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(frm.curstate&nbsp;==&nbsp;50)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;分所独立复核&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(frm.curstate&nbsp;==&nbsp;60)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;总所独立复核&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!frm.isReview)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(frm.OpenSelectRow.reviewOpinionState30&nbsp;&&&nbsp;frm.OpenSelectRow.reviewOpinionState30.id&nbsp;&&&nbsp;frm.OpenSelectRow.reviewOpinionState30.id&nbsp;==&nbsp;20)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;二级复核&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(frm.OpenSelectRow.reviewOpinionState40&nbsp;&&&nbsp;frm.OpenSelectRow.reviewOpinionState40.id&nbsp;&&&nbsp;frm.OpenSelectRow.reviewOpinionState40.id&nbsp;==&nbsp;20)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;项目合伙人复核&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(frm.OpenSelectRow.reviewOpinionState50&nbsp;&&&nbsp;frm.OpenSelectRow.reviewOpinionState50.id&nbsp;&&&nbsp;frm.OpenSelectRow.reviewOpinionState50.id&nbsp;==&nbsp;20)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;分所独立复核&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(frm.OpenSelectRow.reviewOpinionState60&nbsp;&&&nbsp;frm.OpenSelectRow.reviewOpinionState60.id&nbsp;&&&nbsp;frm.OpenSelectRow.reviewOpinionState60.id&nbsp;==&nbsp;20)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;总所独立复核&quot;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;comtree&nbsp;=&nbsp;frm.DownForCode(&quot;compositionCustomer&quot;);\n\n&nbsp;&nbsp;&nbsp;&nbsp;//控制复核意见标签页的显示\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;p&nbsp;=&nbsp;this.UpForCode(&quot;draftReviewBatch&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(p.projectId.prjId))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(p.projectId.id))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.projectId&nbsp;=&nbsp;p.projectId;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.projectId&nbsp;=&nbsp;p.id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.projectId&nbsp;=&nbsp;p.projectId.prjId;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(opener,&nbsp;&quot;DraftReviewBatch-gainManuscriptReviewState.do&quot;,&nbsp;'get',&nbsp;params,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(result.indexOf(&quot;30/&quot;)&nbsp;==&nbsp;-1&nbsp;&&&nbsp;result.indexOf(&quot;40/&quot;)&nbsp;==&nbsp;-1&nbsp;&&&nbsp;result.indexOf(&quot;50/&quot;)&nbsp;==&nbsp;-1&nbsp;&&&nbsp;result.indexOf(&quot;60/&quot;)&nbsp;==&nbsp;-1)&nbsp;{//二级复核&nbsp;隐藏\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;复核流程未提交，无法查看复核意见！&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;UIForm-Web-Schema.json&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parameter.schemaType&nbsp;=&nbsp;&quot;Panel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parameter.schemaCode&nbsp;=&nbsp;me.schemacode;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parameter.openTabCode1=tabCode;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Framework.OpenForm(me,&nbsp;url,&nbsp;parameter,&nbsp;function&nbsp;(form)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.dosstates&nbsp;=&nbsp;result;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.openTabCode&nbsp;=&nbsp;tabCode;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.treeselected&nbsp;=&nbsp;comtree.GetSelected()\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNotNullOrEmpty(frm.isHaveOper))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.haveOper&nbsp;=&nbsp;frm.isHaveOper;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(form.Load)&nbsp;form.Load();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;});\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.dosstates&nbsp;=&nbsp;result;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.openTabCode&nbsp;=&nbsp;tabCode;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.treeselected&nbsp;=&nbsp;comtree.GetSelected();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNotNullOrEmpty(frm.isHaveOper))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.haveOper&nbsp;=&nbsp;frm.isHaveOper;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;Web-Page.html?schemaCode=&quot;&nbsp;+&nbsp;me.schemacode&nbsp;+&nbsp;&quot;&schemaType=Panel&tag=&quot;&nbsp;+&nbsp;Math.random();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.WindowOpen(url,&nbsp;me,&nbsp;parameter);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;});\n};\r\n \r\n};"}],"sort":0},{"code":"SubmitResponse","name":"提交回复","property":[{"isHide":false,"name":"AuthorityRemark","value":"提交回复复核意见"},{"isHide":false,"name":"OnClick","value":"OnClicka"},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.OnClicka&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;OnClicka&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;qr&nbsp;=&nbsp;this.UpForCode(&quot;draftReviewBatch&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;p;\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(qr.projectId.prjId))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;qr.projectId;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;qr.projectId.prjId;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;{};\n\n&nbsp;&nbsp;&nbsp;&nbsp;params.priId&nbsp;=&nbsp;p;\n&nbsp;&nbsp;&nbsp;&nbsp;params.reviewOpinionState&nbsp;=&nbsp;30;//已回复\n&nbsp;&nbsp;&nbsp;&nbsp;params.manuscriptReviewState&nbsp;=&nbsp;qr.curstate;\n&nbsp;&nbsp;&nbsp;&nbsp;params.reviewer&nbsp;=&nbsp;qr.OpenSelectRow.actor_id;\n\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;ReviewComments-checkAComment.do&quot;,&nbsp;'post',&nbsp;params,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;ReviewComments-sendAComment.do&quot;,&nbsp;'post',&nbsp;params,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;提交回复成功！&quot;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;提交回复失败，失败原因：&quot;&nbsp;+&nbsp;result);\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;false);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;有复核意见还没有填写回复意见！&quot;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;校验是否有回复信息失败，失败原因：&quot;&nbsp;+&nbsp;result);\n\n&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;false);\n};\r\n \r\n};"}],"sort":2},{"code":"ProjectInfo","name":"项目信息","property":[{"isHide":false,"name":"AuthorityRemark","value":"查看项目信息"},{"isHide":false,"name":"OnClick","value":"ProjectInfoOnClick"},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.ProjectInfoOnClick&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;console.log('项目信息')\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;qr&nbsp;=&nbsp;me.UpForCode(&quot;draftReviewBatch&quot;);\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(qr.projectId))&nbsp;return;\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;p&nbsp;=&nbsp;Framework.IsNullOrEmpty(qr.projectId.prjId)&nbsp;?&nbsp;qr.projectId&nbsp;:&nbsp;qr.projectId.prjId;\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;params.prjId&nbsp;=&nbsp;p;\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;financialReportProject;\n\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;Project-gainFinancialReportProject-Query.do&quot;,&nbsp;'get',&nbsp;params,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;financialReportProject&nbsp;=&nbsp;result;\n&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;financialReportProject&nbsp;=&nbsp;10;\n&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;false);\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;UIForm-Web-Schema.json&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaType&nbsp;=&nbsp;&quot;Panel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(financialReportProject&nbsp;==&nbsp;10)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaCode&nbsp;=&nbsp;&quot;ProjectManage&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.schemaCode&nbsp;=&nbsp;&quot;NonReportProjectManage&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;parameter.readOnly&nbsp;=&nbsp;true;\n\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.OpenForm(me,&nbsp;url,&nbsp;parameter,&nbsp;function&nbsp;(form)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.FinancialReportProject&nbsp;=&nbsp;financialReportProject;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.Draft&nbsp;=&nbsp;true;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//form.Pid=p;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.projectId&nbsp;=&nbsp;p;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(form.Load)&nbsp;form.Load();//p\n&nbsp;&nbsp;&nbsp;&nbsp;});\n};\r\n \r\n};"}],"sort":4},{"code":"SendaComment","name":"下发意见","property":[{"isHide":false,"name":"AuthorityRemark","value":"下发复核意见"},{"isHide":false,"name":"OnClick","value":"OnClicka"},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.OnClicka&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;OnClicka&quot;);\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;t&nbsp;=&nbsp;this.Top();\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;qr&nbsp;=&nbsp;t.DownForCode(&quot;draftReviewBatch&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;p;\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(qr.projectId.prjId))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;qr.projectId;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;p&nbsp;=&nbsp;qr.projectId.prjId;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;btn&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;params.priId&nbsp;=&nbsp;p;\n&nbsp;&nbsp;&nbsp;&nbsp;params.reviewOpinionState&nbsp;=&nbsp;20;//待回复\n&nbsp;&nbsp;&nbsp;&nbsp;params.manuscriptReviewState&nbsp;=&nbsp;qr.curstate;\n&nbsp;&nbsp;&nbsp;&nbsp;params.reviewer&nbsp;=&nbsp;qr.OpenSelectRow.actor_id;\n\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;ReviewComments-checkAComment.do&quot;,&nbsp;'get',&nbsp;params,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNotNullOrEmpty(qr.OpenSelectRow.allocations)&nbsp;&&&nbsp;qr.OpenSelectRow.allocations&nbsp;&gt;&nbsp;1)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Confirm(&quot;当前项目存在多位复核人复核，下发后将不能添加复核意见，是否确认下发？&quot;,&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Confirm(&quot;下发意见后，只有意见回复之后才能再次下发，确定要下发吗？&quot;,&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;ReviewComments-sendAComment.do&quot;,&nbsp;'get',&nbsp;params,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(result&nbsp;==&nbsp;0)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;请先添加复核意见！&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;下发意见成功！&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;t.Close();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;下发意见失败，失败原因：&quot;&nbsp;+&nbsp;result);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;false);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Confirm(&quot;下发意见后，只有意见回复之后才能再次下发，确定要下发吗？&quot;,&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(me,&nbsp;&quot;ReviewComments-sendAComment.do&quot;,&nbsp;'get',&nbsp;params,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(result&nbsp;==&nbsp;0)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;请先添加复核意见！&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;下发意见成功！&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;t.Close();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;下发意见失败，失败原因：&quot;&nbsp;+&nbsp;result);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;false);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;});\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;请先添加复核意见！&quot;)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;校验失败，失败原因：&quot;&nbsp;+&nbsp;result);\n\n&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;false);\n};\r\n \r\n};"}],"sort":3},{"code":"Back","name":"Back","property":[],"sort":1},{"code":"Refresh","name":"刷新","property":[{"isHide":false,"name":"OnClick","value":"OnClicka"},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.OnClicka&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;刷新OnClicka&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;panel&nbsp;=&nbsp;this.Top(&quot;[container='FormPanel']&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(panel))&nbsp;return;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;itemTree&nbsp;=&nbsp;panel.DownForCode('manuscriptItem');\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(itemTree))&nbsp;return;\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!itemTree.Load)&nbsp;return;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;node&nbsp;=itemTree.GetSelected();\n&nbsp;&nbsp;&nbsp;&nbsp;if(Framework.IsNotNullOrEmpty(node)){\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;itemTree.refresh=true;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;itemTree.defaultid&nbsp;=&nbsp;node.id;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;itemTree.Load();\n\n};\r\n \r\n};"}],"sort":5}],"authority":[],"children":[{"action":[],"authority":[],"children":[{"action":[],"authority":[],"children":[{"action":[],"authority":[],"children":[],"dataPermission":[],"isReference":false,"otherChildren":[],"property":[{"isHide":true,"name":"referenceFormId","value":23827}],"sort":0}],"code":"west","control":"West","dataPermission":[],"isReference":false,"name":"项目架构","otherChildren":[],"property":[{"isHide":false,"name":"width","value":"305"},{"isHide":false,"name":"style:border-radius","value":"0"},{"isHide":false,"name":"isTitle","value":"false"}],"sort":7},{"action":[],"authority":[],"children":[{"action":[],"authority":[],"children":[],"code":"centerTitle","control":"PanelTitle","dataPermission":[],"isReference":false,"name":"|  底稿目录","otherChildren":[],"property":[{"isHide":false,"name":"style:color","value":"#1f95d3"},{"isHide":false,"name":"style:margin-left","value":"25px"},{"isHide":false,"name":"style:font-weight","value":"normal"},{"isHide":false,"name":"style:margin-top","value":"10px"}],"sort":2},{"action":[],"authority":[],"children":[{"action":[],"authority":[],"children":[],"dataPermission":[],"isReference":false,"otherChildren":[],"property":[{"isHide":true,"name":"referenceFormId","value":23614}],"sort":0}],"code":"centerPanel","control":"Panel","dataPermission":[],"isReference":false,"javaScript":"","name":"树容器","otherChildren":[],"property":[{"isHide":false,"name":"Height","value":"95%"}],"sort":3}],"code":"center","control":"Center","dataPermission":[],"isReference":false,"name":"| 底稿目录","otherChildren":[],"property":[{"isHide":false,"name":"isTitle","value":"false"},{"isHide":false,"name":"style:border-radius","value":"0"},{"isHide":false,"name":"style:margin-top","value":"0"}],"sort":9},{"action":[],"authority":[],"children":[{"action":[],"authority":[],"children":[],"code":"workingPapers","control":"PanelTitle","dataPermission":[],"isReference":false,"name":"|  工作底稿","otherChildren":[],"property":[{"isHide":false,"name":"style:margin","value":"10px 0 0 35px"},{"isHide":false,"name":"style:color","value":"#1f95d3"},{"isHide":false,"name":"style:font-weight","value":"normal"}],"sort":4},{"action":[],"authority":[],"children":[{"action":[],"authority":[],"children":[],"dataPermission":[],"isReference":false,"otherChildren":[],"property":[{"isHide":true,"name":"referenceFormId","value":23911}],"sort":0}],"code":"gridPanel","control":"Panel","dataPermission":[],"isReference":false,"javaScript":"","name":"表格容器","otherChildren":[],"property":[{"isHide":false,"name":"Height","value":"95%"}],"sort":6},{"action":[],"authority":[],"children":[],"code":"btn_revision","control":"LinkButton","dataPermission":[],"isReference":false,"javaScript":"this.BeforeHandler&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;sdadasd&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;//debugger;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;t=this.Top();\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tree=t.DownForCode(&quot;manuscriptItemTree&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;node&nbsp;=tree.GetSelected();\n&nbsp;&nbsp;&nbsp;&nbsp;if(node&nbsp;&&&nbsp;node.delete)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;rightGrid&nbsp;=&nbsp;this.UpForCode(&quot;rightGrid&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;Revision=rightGrid.DownForCode(&quot;Revision&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Revision.OnClick();\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n};","name":"已删除底稿","otherChildren":[],"property":[{"isHide":false,"name":"IsLinkstyle","value":"true"},{"isHide":false,"name":"class","value":"papersBtn"},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.BeforeHandler&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;sdadasd&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;//debugger;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;t=this.Top();\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tree=t.DownForCode(&quot;manuscriptItemTree&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;node&nbsp;=tree.GetSelected();\n&nbsp;&nbsp;&nbsp;&nbsp;if(node&nbsp;&&&nbsp;node.delete)\n&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;rightGrid&nbsp;=&nbsp;this.UpForCode(&quot;rightGrid&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;Revision=rightGrid.DownForCode(&quot;Revision&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Revision.OnClick();\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n};\r\n \r\n};"}],"sort":5}],"code":"rightGrid","control":"East","dataPermission":[],"isReference":false,"name":"审计工作底稿","otherChildren":[],"property":[{"isHide":false,"name":"isTitle","value":"false"},{"isHide":false,"name":"style:border-left","value":"1px solid rgba(232,235,243,0.7)"},{"isHide":false,"name":"width","value":"55%"}],"sort":11}],"code":"mainPanel","control":"Alyout","dataPermission":[],"isReference":false,"name":"主Panel","otherChildren":[],"property":[{"isHide":false,"name":"class","value":"easyui-layout layout easyui-fluid dx_layout dx_review dx_notitle"},{"isHide":false,"name":"style:border-radius","value":"0"}],"sort":1},{"action":[],"authority":[],"children":[],"code":"id","control":"Hidden","dataPermission":[],"isReference":false,"javaScript":"","name":"Id","otherChildren":[],"property":[{"isHide":false,"name":"Length","value":16},{"isHide":false,"name":"Required","value":true},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"IsTransient","value":false}],"select":"Id","sort":0},{"action":[],"authority":[],"children":[],"code":"rightBuoy","control":"RightBuoy","dataPermission":[],"isReference":false,"javaScript":"this.OnClick&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;frm&nbsp;=&nbsp;me.UpForCode(&quot;draftReviewBatch&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tabCode;\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(frm.curstate&nbsp;==&nbsp;30)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;二级复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(frm.curstate&nbsp;==&nbsp;40)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;项目合伙人复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(frm.curstate&nbsp;==&nbsp;50)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;分所独立复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(frm.curstate&nbsp;==&nbsp;60)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;总所独立复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!frm.isReview)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState30&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState30.id&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState30.id&nbsp;==&nbsp;20\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;二级复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState40&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState40.id&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState40.id&nbsp;==&nbsp;20\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;项目合伙人复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState50&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState50.id&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState50.id&nbsp;==&nbsp;20\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;分所独立复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState60&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState60.id&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState60.id&nbsp;==&nbsp;20\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;总所独立复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;comtree&nbsp;=&nbsp;frm.DownForCode(&quot;compositionCustomer&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;//控制复核意见标签页的显示\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;p&nbsp;=&nbsp;this.UpForCode(&quot;draftReviewBatch&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(p.projectId.prjId))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(p.projectId.id))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.projectId&nbsp;=&nbsp;p.projectId;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.projectId&nbsp;=&nbsp;p.id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.projectId&nbsp;=&nbsp;p.projectId.prjId;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;'DraftReviewBatch-gainManuscriptReviewState.do'\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(opener,&nbsp;url,&nbsp;&quot;get&quot;,&nbsp;params,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(result.indexOf(&quot;30/&quot;)&nbsp;==&nbsp;-1)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//二级复核&nbsp;隐藏\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;复核流程未提交，无法查看复核意见！&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;UIForm-Web-Schema.json&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parameter.schemaType&nbsp;=&nbsp;&quot;Panel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parameter.schemaCode&nbsp;=&nbsp;me.schemacode;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;//&nbsp;parameter.openTabCode1=tabCode;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Framework.OpenForm(me,&nbsp;url,&nbsp;parameter,&nbsp;function&nbsp;(form)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.dosstates&nbsp;=&nbsp;result;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.openTabCode&nbsp;=&nbsp;tabCode;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.treeselected&nbsp;=&nbsp;comtree.GetSelected();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNotNullOrEmpty(frm.isHaveOper))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.haveOper&nbsp;=&nbsp;frm.isHaveOper;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(form.Load)&nbsp;form.Load();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;});\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.dosstates&nbsp;=&nbsp;result;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.openTabCode&nbsp;=&nbsp;tabCode;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.treeselected&nbsp;=&nbsp;comtree.GetSelected();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNotNullOrEmpty(frm.isHaveOper))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.haveOper&nbsp;=&nbsp;frm.isHaveOper;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;Web-Page.html?schemaCode=&quot;&nbsp;+&nbsp;me.schemacode&nbsp;+&nbsp;&quot;&schemaType=Panel&tag=&quot;&nbsp;+&nbsp;Math.random();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.WindowOpen(url,&nbsp;me,&nbsp;parameter);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;});\n}","name":"复核意见","otherChildren":[],"property":[{"isHide":false,"name":"value","value":"复核意见"},{"isHide":false,"name":"SchemaCode","value":"ReviewCommentsLiNew"},{"isHide":false,"name":"AuthorityRemark","value":"复核按钮悬浮"},{"isHide":false,"name":"IsWindowOpen","value":"true"},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.OnClick&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;me&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;frm&nbsp;=&nbsp;me.UpForCode(&quot;draftReviewBatch&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;tabCode;\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(frm.curstate&nbsp;==&nbsp;30)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;二级复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(frm.curstate&nbsp;==&nbsp;40)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;项目合伙人复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(frm.curstate&nbsp;==&nbsp;50)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;分所独立复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(frm.curstate&nbsp;==&nbsp;60)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;总所独立复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(!frm.isReview)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState30&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState30.id&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState30.id&nbsp;==&nbsp;20\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;二级复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState40&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState40.id&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState40.id&nbsp;==&nbsp;20\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;项目合伙人复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState50&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState50.id&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState50.id&nbsp;==&nbsp;20\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;分所独立复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;if&nbsp;(\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState60&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState60.id&nbsp;&&\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;frm.OpenSelectRow.reviewOpinionState60.id&nbsp;==&nbsp;20\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;tabCode&nbsp;=&nbsp;&quot;总所独立复核&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;comtree&nbsp;=&nbsp;frm.DownForCode(&quot;compositionCustomer&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;//控制复核意见标签页的显示\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;p&nbsp;=&nbsp;this.UpForCode(&quot;draftReviewBatch&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(p.projectId.prjId))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(p.projectId.id))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.projectId&nbsp;=&nbsp;p.projectId;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.projectId&nbsp;=&nbsp;p.id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params.projectId&nbsp;=&nbsp;p.projectId.prjId;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;'DraftReviewBatch-gainManuscriptReviewState.do'\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(opener,&nbsp;url,&nbsp;&quot;get&quot;,&nbsp;params,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(result.indexOf(&quot;30/&quot;)&nbsp;==&nbsp;-1)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//二级复核&nbsp;隐藏\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;复核流程未提交，无法查看复核意见！&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;UIForm-Web-Schema.json&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;var&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parameter.schemaType&nbsp;=&nbsp;&quot;Panel&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;parameter.schemaCode&nbsp;=&nbsp;me.schemacode;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;//&nbsp;parameter.openTabCode1=tabCode;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;Framework.OpenForm(me,&nbsp;url,&nbsp;parameter,&nbsp;function&nbsp;(form)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.dosstates&nbsp;=&nbsp;result;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.openTabCode&nbsp;=&nbsp;tabCode;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.treeselected&nbsp;=&nbsp;comtree.GetSelected();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNotNullOrEmpty(frm.isHaveOper))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;form.haveOper&nbsp;=&nbsp;frm.isHaveOper;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(form.Load)&nbsp;form.Load();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;});\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;parameter&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.dosstates&nbsp;=&nbsp;result;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.openTabCode&nbsp;=&nbsp;tabCode;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.treeselected&nbsp;=&nbsp;comtree.GetSelected();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNotNullOrEmpty(frm.isHaveOper))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.haveOper&nbsp;=&nbsp;frm.isHaveOper;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;url&nbsp;=&nbsp;&quot;Web-Page.html?schemaCode=&quot;&nbsp;+&nbsp;me.schemacode&nbsp;+&nbsp;&quot;&schemaType=Panel&tag=&quot;&nbsp;+&nbsp;Math.random();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.WindowOpen(url,&nbsp;me,&nbsp;parameter);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;});\n}\r\n \r\n};"}],"sort":13},{"action":[],"authority":[],"children":[],"code":"uuid","control":"Hidden","dataPermission":[],"isReference":false,"name":"uuid","otherChildren":[],"property":[],"sort":1000}],"code":"qualityReview","control":"FormPanel","dataPermission":[],"isReference":false,"javaScript":"this.BeforeLoad&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;BeforeLoad&nbsp;底稿复核&quot;);\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;thisfrm&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;WorkFlowPassbtn&nbsp;=&nbsp;this.DownForCode(&quot;WorkFlowPass&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;WorkFlowNotPassbtn&nbsp;=&nbsp;this.DownForCode(&quot;WorkFlowNotPass&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;btn&nbsp;=&nbsp;this.DownForCode(&quot;WorkFlowSubmit&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;SendaCommentbtn&nbsp;=&nbsp;this.DownForCode(&quot;SendaComment&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;WorkFlowRemarksle&nbsp;=&nbsp;this.DownForCode(&quot;WorkFlowRemark&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;Revision&nbsp;=&nbsp;this.DownForCode(&quot;Revision&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;Revision.SetVisible(true);\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(WorkFlowPassbtn)&nbsp;WorkFlowPassbtn.SetTextValue(&quot;通过&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(WorkFlowNotPassbtn)&nbsp;WorkFlowNotPassbtn.SetTextValue(&quot;退回&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(btn)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btn.SetTextValue(&quot;提交复核&quot;)\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;SubmitResponsebtn&nbsp;=&nbsp;this.DownForCode(&quot;SubmitResponse&quot;);\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;frm&nbsp;=&nbsp;this.DownForCode(&quot;compositionCustomer&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;params.param&nbsp;=&nbsp;&quot;projectId&quot;;\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;o&nbsp;=&nbsp;this.Opener;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;pid;\n\n&nbsp;&nbsp;&nbsp;&nbsp;this.item&nbsp;=&nbsp;this.Opener.item;\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(this.item))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;top1&nbsp;=&nbsp;o.Top();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(top1.code&nbsp;==&nbsp;&quot;approval5Independent&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.item&nbsp;=&nbsp;top1.item;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(top1.DownForCode)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;frm2&nbsp;=&nbsp;top1.DownForCode(&quot;approval5Independent&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(frm2)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.item&nbsp;=&nbsp;frm2.item;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(this.item)&nbsp;||&nbsp;!this.item.review)&nbsp;{//我的项目\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(this.item)&nbsp;||&nbsp;this.item.code&nbsp;==&nbsp;5)//&nbsp;已完成&nbsp;当前项目所处于的审核状态&nbsp;&nbsp;0表示没有处于审核中的\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((o.GetSelected().manuscriptReviewState.id&nbsp;&gt;&nbsp;10&nbsp;&&&nbsp;o.GetSelected().manuscriptReviewState.id&nbsp;&lt;&nbsp;70&nbsp;||&nbsp;this.OpenSelectRow.zReview&nbsp;&gt;&nbsp;0))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisfrm.prjState&nbsp;=&nbsp;1;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(o.GetSelected().manuscriptReviewState.id&nbsp;==&nbsp;70)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(btn)&nbsp;btn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SubmitResponsebtn)&nbsp;SubmitResponsebtn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.isHaveOper&nbsp;=&nbsp;&quot;F&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisfrm.prjState&nbsp;=&nbsp;0;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisfrm.prjState&nbsp;=&nbsp;1;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid&nbsp;=&nbsp;o.GetSelected().prjId;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(pid))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid&nbsp;=&nbsp;o.GetSelected().id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.projectId&nbsp;=&nbsp;o.GetSelected();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;btnsac&nbsp;=&nbsp;this.DownForCode(&quot;SendaComment&quot;);&nbsp;//下发意见&nbsp;隐藏\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNotNullOrEmpty(btnsac))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btnsac.SetVisible(true);&nbsp;//AfterRender&nbsp;方法中获取不到this.Opener\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.isReview&nbsp;=&nbsp;false;&nbsp;//不是从代办复核界面进入的\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(this.OpenSelectRow.projectManagerId&nbsp;!=&nbsp;AppContext.Profile.id&nbsp;||&nbsp;this.OpenSelectRow.zReview&nbsp;&gt;&nbsp;0)&nbsp;//大项目经理可见&nbsp;提交复核&nbsp;提交回复&nbsp;按钮\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(btn)&nbsp;btn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(this.OpenSelectRow.projectManagerId&nbsp;!=&nbsp;AppContext.Profile.id)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SubmitResponsebtn)&nbsp;SubmitResponsebtn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;s&nbsp;=&nbsp;this.OpenSelectRow;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid&nbsp;=&nbsp;s.prjId;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.curstate&nbsp;=&nbsp;s.wfstate;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.projectId&nbsp;=&nbsp;pid;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.isReview&nbsp;=&nbsp;true;&nbsp;//从代办复核界面进入的\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(o.code&nbsp;==&nbsp;&quot;manuscriptToReview1&quot;&nbsp;||&nbsp;o.code&nbsp;==&nbsp;&quot;manuscriptToReview11&quot;&nbsp;||&nbsp;o.code&nbsp;==&nbsp;&quot;theManuscriptBranchHasBeenCompleted&quot;&nbsp;||&nbsp;o.code&nbsp;==&nbsp;&quot;theGeneralInstituteHasBeenCompleted&quot;&nbsp;||&nbsp;o.code&nbsp;==&nbsp;&quot;theGeneralInstituteHasBeenCompletedIndependent&quot;)&nbsp;{&nbsp;//已完成\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;this.DownForCode(&quot;ReviewComments&quot;).SetVisible(true);\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SubmitResponsebtn)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SubmitResponsebtn.SetVisible(true);\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;this.DownForCode(&quot;SubmitResponse&quot;).SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(WorkFlowPassbtn)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkFlowPassbtn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SendaCommentbtn)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendaCommentbtn.SetVisible(true);\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(WorkFlowNotPassbtn)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkFlowNotPassbtn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SubmitResponsebtn)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SubmitResponsebtn.SetVisible(true);&nbsp;//代办进来&nbsp;提交回复隐藏&nbsp;隐藏\n//从代办进来，下发过复核意见&nbsp;就隐藏下发复核意见按钮\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;SendaCommentb&nbsp;=&nbsp;this.DownForCode(&quot;SendaComment&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(s.xfstate)&nbsp;||&nbsp;s.xfstate&nbsp;==&nbsp;10)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SendaCommentb)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendaCommentb.SetVisible(false);&nbsp;//下发意见&nbsp;显示\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;reviewOpinionStateid&nbsp;=&nbsp;Framework.IsNullOrEmpty(s.reviewOpinionState.id)&nbsp;?&nbsp;s.reviewOpinionState&nbsp;:&nbsp;s.reviewOpinionState.id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(reviewOpinionStateid&nbsp;==&nbsp;30&nbsp;&&&nbsp;s.whetherShow)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SendaCommentb)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendaCommentb.SetVisible(false);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SendaCommentb)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendaCommentb.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(AppContext.Profile.id&nbsp;!=&nbsp;s.actor_id)&nbsp;{//当前登录人&nbsp;没有&nbsp;复核权限\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(WorkFlowPassbtn)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkFlowPassbtn.readonlyshow&nbsp;=&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkFlowPassbtn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(WorkFlowNotPassbtn)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkFlowNotPassbtn.readonlyshow&nbsp;=&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkFlowNotPassbtn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;(SendaCommentbtn)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendaCommentbtn.SetVisible(true);\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(WorkFlowRemarksle)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkFlowRemarksle.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;params.value&nbsp;=&nbsp;pid;\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(thisfrm.prjState&nbsp;==&nbsp;0)&nbsp;{\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(btn)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;paraList&nbsp;=&nbsp;[];\n&nbsp;&nbsp;&nbsp;&nbsp;paraList.push(params);\n&nbsp;&nbsp;&nbsp;&nbsp;paraList.push({'param':&nbsp;&quot;isReview&quot;,&nbsp;&quot;value&quot;:&nbsp;this.isReview})//是否通过复核页面进来的\n&nbsp;&nbsp;&nbsp;&nbsp;frm.params&nbsp;=&nbsp;JSON.stringify(paraList);\n&nbsp;&nbsp;&nbsp;&nbsp;frm.Load();\n\n};\n\nthis.GetWorkFlowParameter&nbsp;=&nbsp;function&nbsp;(parameter,&nbsp;action)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;GetWorkFlowParameter&nbsp;&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;methis&nbsp;=this;\n\n&nbsp;&nbsp;&nbsp;&nbsp;//调用插入批次接口返回批次id,时间戳，entityType\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;c&nbsp;=&nbsp;this.DownForCode(&quot;compositionCustomer&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;id&nbsp;=&nbsp;this.DownForCode(&quot;id&quot;);\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;s&nbsp;=&nbsp;c.GetCheckedNode();\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(s.length&nbsp;==&nbsp;0)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;至少选择一条数据操作！&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;;\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;param&nbsp;=&nbsp;[];\n\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;s.length;&nbsp;i++)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param.push(s[i].id);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;{};\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;pid;\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(this.projectId.id))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid&nbsp;=&nbsp;this.projectId;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid&nbsp;=&nbsp;this.projectId.id;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;params.projectId&nbsp;=&nbsp;pid;\n&nbsp;&nbsp;&nbsp;&nbsp;params.compositionCustomerId&nbsp;=&nbsp;JSON.stringify(param);\n\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(methis,&nbsp;&quot;DraftReviewBatch-saveDraftReviewBatch.do&quot;,&nbsp;'get',&nbsp;params,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.entityId&nbsp;=&nbsp;result.id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id.SetValue(result.id);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.timestamp&nbsp;=&nbsp;result.timestamp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.entityType&nbsp;=&nbsp;result.entityType;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsFunction(action))&nbsp;action(parameter);\n&nbsp;&nbsp;&nbsp;&nbsp;});\n};\n\nthis.BeforeWorkFlowSubmit&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;BeforeWorkFlowSubmit&nbsp;&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;param&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(this.projectId.id))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param.prjId&nbsp;=&nbsp;this.projectId;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param.prjId&nbsp;=&nbsp;this.projectId.id;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;c&nbsp;=&nbsp;this.DownForCode(&quot;compositionCustomer&quot;);\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;s&nbsp;=&nbsp;c.GetCheckedNode();\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(s.length&nbsp;==&nbsp;0)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;未选择提交复核的被审计单位！&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;s.length;&nbsp;i++)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(s[i].complete&nbsp;==&nbsp;10)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;项目有存在未上传底稿，不能进行提交复核!&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n};\n\nthis.AfterRender&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;AfterRender&nbsp;&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;win&nbsp;=&nbsp;this.Top(&quot;[controltype='Window']&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(win)&nbsp;win.IsRefreshOpener&nbsp;=&nbsp;true;\n};","name":"质量复核","otherChildren":[],"property":[{"isHide":false,"name":"BaseCode","value":"qualityReview"},{"isHide":false,"name":"Name","value":"质量复核"},{"isHide":false,"name":"IsReadOnly","value":false},{"isHide":false,"name":"Description"},{"isHide":false,"name":"FormId","value":23828},{"isHide":false,"name":"OrderBy","value":"Sort"},{"isHide":false,"name":"IsSqlForm","value":false},{"isHide":false,"name":"JavaScript","value":"var registerJavaScript = function () {\r\n \r\nthis.BeforeLoad&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;BeforeLoad&nbsp;底稿复核&quot;);\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;thisfrm&nbsp;=&nbsp;this;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;WorkFlowPassbtn&nbsp;=&nbsp;this.DownForCode(&quot;WorkFlowPass&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;WorkFlowNotPassbtn&nbsp;=&nbsp;this.DownForCode(&quot;WorkFlowNotPass&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;btn&nbsp;=&nbsp;this.DownForCode(&quot;WorkFlowSubmit&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;SendaCommentbtn&nbsp;=&nbsp;this.DownForCode(&quot;SendaComment&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;WorkFlowRemarksle&nbsp;=&nbsp;this.DownForCode(&quot;WorkFlowRemark&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;Revision&nbsp;=&nbsp;this.DownForCode(&quot;Revision&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;Revision.SetVisible(true);\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(WorkFlowPassbtn)&nbsp;WorkFlowPassbtn.SetTextValue(&quot;通过&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(WorkFlowNotPassbtn)&nbsp;WorkFlowNotPassbtn.SetTextValue(&quot;退回&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(btn)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btn.SetTextValue(&quot;提交复核&quot;)\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;SubmitResponsebtn&nbsp;=&nbsp;this.DownForCode(&quot;SubmitResponse&quot;);\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;frm&nbsp;=&nbsp;this.DownForCode(&quot;compositionCustomer&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;params.param&nbsp;=&nbsp;&quot;projectId&quot;;\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;o&nbsp;=&nbsp;this.Opener;\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;pid;\n\n&nbsp;&nbsp;&nbsp;&nbsp;this.item&nbsp;=&nbsp;this.Opener.item;\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(this.item))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;top1&nbsp;=&nbsp;o.Top();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(top1.code&nbsp;==&nbsp;&quot;approval5Independent&quot;)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.item&nbsp;=&nbsp;top1.item;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(top1.DownForCode)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;frm2&nbsp;=&nbsp;top1.DownForCode(&quot;approval5Independent&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(frm2)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.item&nbsp;=&nbsp;frm2.item;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(this.item)&nbsp;||&nbsp;!this.item.review)&nbsp;{//我的项目\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(this.item)&nbsp;||&nbsp;this.item.code&nbsp;==&nbsp;5)//&nbsp;已完成&nbsp;当前项目所处于的审核状态&nbsp;&nbsp;0表示没有处于审核中的\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;((o.GetSelected().manuscriptReviewState.id&nbsp;&gt;&nbsp;10&nbsp;&&&nbsp;o.GetSelected().manuscriptReviewState.id&nbsp;&lt;&nbsp;70&nbsp;||&nbsp;this.OpenSelectRow.zReview&nbsp;&gt;&nbsp;0))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisfrm.prjState&nbsp;=&nbsp;1;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(o.GetSelected().manuscriptReviewState.id&nbsp;==&nbsp;70)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(btn)&nbsp;btn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SubmitResponsebtn)&nbsp;SubmitResponsebtn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.isHaveOper&nbsp;=&nbsp;&quot;F&quot;;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisfrm.prjState&nbsp;=&nbsp;0;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;thisfrm.prjState&nbsp;=&nbsp;1;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid&nbsp;=&nbsp;o.GetSelected().prjId;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(pid))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid&nbsp;=&nbsp;o.GetSelected().id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.projectId&nbsp;=&nbsp;o.GetSelected();\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;btnsac&nbsp;=&nbsp;this.DownForCode(&quot;SendaComment&quot;);&nbsp;//下发意见&nbsp;隐藏\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNotNullOrEmpty(btnsac))\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btnsac.SetVisible(true);&nbsp;//AfterRender&nbsp;方法中获取不到this.Opener\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.isReview&nbsp;=&nbsp;false;&nbsp;//不是从代办复核界面进入的\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(this.OpenSelectRow.projectManagerId&nbsp;!=&nbsp;AppContext.Profile.id&nbsp;||&nbsp;this.OpenSelectRow.zReview&nbsp;&gt;&nbsp;0)&nbsp;//大项目经理可见&nbsp;提交复核&nbsp;提交回复&nbsp;按钮\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(btn)&nbsp;btn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(this.OpenSelectRow.projectManagerId&nbsp;!=&nbsp;AppContext.Profile.id)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SubmitResponsebtn)&nbsp;SubmitResponsebtn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;s&nbsp;=&nbsp;this.OpenSelectRow;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid&nbsp;=&nbsp;s.prjId;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.curstate&nbsp;=&nbsp;s.wfstate;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.projectId&nbsp;=&nbsp;pid;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;this.isReview&nbsp;=&nbsp;true;&nbsp;//从代办复核界面进入的\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(o.code&nbsp;==&nbsp;&quot;manuscriptToReview1&quot;&nbsp;||&nbsp;o.code&nbsp;==&nbsp;&quot;manuscriptToReview11&quot;&nbsp;||&nbsp;o.code&nbsp;==&nbsp;&quot;theManuscriptBranchHasBeenCompleted&quot;&nbsp;||&nbsp;o.code&nbsp;==&nbsp;&quot;theGeneralInstituteHasBeenCompleted&quot;&nbsp;||&nbsp;o.code&nbsp;==&nbsp;&quot;theGeneralInstituteHasBeenCompletedIndependent&quot;)&nbsp;{&nbsp;//已完成\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;this.DownForCode(&quot;ReviewComments&quot;).SetVisible(true);\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SubmitResponsebtn)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SubmitResponsebtn.SetVisible(true);\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;this.DownForCode(&quot;SubmitResponse&quot;).SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(WorkFlowPassbtn)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkFlowPassbtn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SendaCommentbtn)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendaCommentbtn.SetVisible(true);\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(WorkFlowNotPassbtn)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkFlowNotPassbtn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}else{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SubmitResponsebtn)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SubmitResponsebtn.SetVisible(true);&nbsp;//代办进来&nbsp;提交回复隐藏&nbsp;隐藏\n//从代办进来，下发过复核意见&nbsp;就隐藏下发复核意见按钮\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;SendaCommentb&nbsp;=&nbsp;this.DownForCode(&quot;SendaComment&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(s.xfstate)&nbsp;||&nbsp;s.xfstate&nbsp;==&nbsp;10)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SendaCommentb)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendaCommentb.SetVisible(false);&nbsp;//下发意见&nbsp;显示\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;reviewOpinionStateid&nbsp;=&nbsp;Framework.IsNullOrEmpty(s.reviewOpinionState.id)&nbsp;?&nbsp;s.reviewOpinionState&nbsp;:&nbsp;s.reviewOpinionState.id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(reviewOpinionStateid&nbsp;==&nbsp;30&nbsp;&&&nbsp;s.whetherShow)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SendaCommentb)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendaCommentb.SetVisible(false);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(SendaCommentb)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendaCommentb.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(AppContext.Profile.id&nbsp;!=&nbsp;s.actor_id)&nbsp;{//当前登录人&nbsp;没有&nbsp;复核权限\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(WorkFlowPassbtn)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkFlowPassbtn.readonlyshow&nbsp;=&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkFlowPassbtn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(WorkFlowNotPassbtn)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkFlowNotPassbtn.readonlyshow&nbsp;=&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkFlowNotPassbtn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;if&nbsp;(SendaCommentbtn)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SendaCommentbtn.SetVisible(true);\n\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(WorkFlowRemarksle)\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WorkFlowRemarksle.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;params.value&nbsp;=&nbsp;pid;\n\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(thisfrm.prjState&nbsp;==&nbsp;0)&nbsp;{\n\n\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(btn)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;btn.SetVisible(true);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;paraList&nbsp;=&nbsp;[];\n&nbsp;&nbsp;&nbsp;&nbsp;paraList.push(params);\n&nbsp;&nbsp;&nbsp;&nbsp;paraList.push({'param':&nbsp;&quot;isReview&quot;,&nbsp;&quot;value&quot;:&nbsp;this.isReview})//是否通过复核页面进来的\n&nbsp;&nbsp;&nbsp;&nbsp;frm.params&nbsp;=&nbsp;JSON.stringify(paraList);\n&nbsp;&nbsp;&nbsp;&nbsp;frm.Load();\n\n};\n\nthis.GetWorkFlowParameter&nbsp;=&nbsp;function&nbsp;(parameter,&nbsp;action)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;GetWorkFlowParameter&nbsp;&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;methis&nbsp;=this;\n\n&nbsp;&nbsp;&nbsp;&nbsp;//调用插入批次接口返回批次id,时间戳，entityType\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;c&nbsp;=&nbsp;this.DownForCode(&quot;compositionCustomer&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;id&nbsp;=&nbsp;this.DownForCode(&quot;id&quot;);\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;s&nbsp;=&nbsp;c.GetCheckedNode();\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(s.length&nbsp;==&nbsp;0)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;至少选择一条数据操作！&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;;\n&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;param&nbsp;=&nbsp;[];\n\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;s.length;&nbsp;i++)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param.push(s[i].id);\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;params&nbsp;=&nbsp;{};\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;pid;\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(this.projectId.id))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid&nbsp;=&nbsp;this.projectId;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pid&nbsp;=&nbsp;this.projectId.id;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;params.projectId&nbsp;=&nbsp;pid;\n&nbsp;&nbsp;&nbsp;&nbsp;params.compositionCustomerId&nbsp;=&nbsp;JSON.stringify(param);\n\n&nbsp;&nbsp;&nbsp;&nbsp;Framework.AjaxRequest(methis,&nbsp;&quot;DraftReviewBatch-saveDraftReviewBatch.do&quot;,&nbsp;'get',&nbsp;params,&nbsp;false,&nbsp;function&nbsp;(result)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.entityId&nbsp;=&nbsp;result.id;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id.SetValue(result.id);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.timestamp&nbsp;=&nbsp;result.timestamp;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parameter.entityType&nbsp;=&nbsp;result.entityType;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsFunction(action))&nbsp;action(parameter);\n&nbsp;&nbsp;&nbsp;&nbsp;});\n};\n\nthis.BeforeWorkFlowSubmit&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;BeforeWorkFlowSubmit&nbsp;&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;param&nbsp;=&nbsp;{};\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(Framework.IsNullOrEmpty(this.projectId.id))&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param.prjId&nbsp;=&nbsp;this.projectId;\n&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;param.prjId&nbsp;=&nbsp;this.projectId.id;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;c&nbsp;=&nbsp;this.DownForCode(&quot;compositionCustomer&quot;);\n\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;s&nbsp;=&nbsp;c.GetCheckedNode();\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(s.length&nbsp;==&nbsp;0)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;未选择提交复核的被审计单位！&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;}\n\n&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(var&nbsp;i&nbsp;=&nbsp;0;&nbsp;i&nbsp;&lt;&nbsp;s.length;&nbsp;i++)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(s[i].complete&nbsp;==&nbsp;10)&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Framework.Message(&quot;项目有存在未上传底稿，不能进行提交复核!&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;false;\n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}\n&nbsp;&nbsp;&nbsp;&nbsp;}\n};\n\nthis.AfterRender&nbsp;=&nbsp;function&nbsp;()&nbsp;{\n&nbsp;&nbsp;&nbsp;&nbsp;console.log(&quot;AfterRender&nbsp;&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;var&nbsp;win&nbsp;=&nbsp;this.Top(&quot;[controltype='Window']&quot;);\n&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(win)&nbsp;win.IsRefreshOpener&nbsp;=&nbsp;true;\n};\r\n \r\n};"},{"isHide":false,"name":"EntityType","value":"DraftReviewBatch"},{"isHide":false,"name":"createurl","value":"\"\""},{"container":"Window","isHide":false,"name":"collapsible","value":"true"},{"isHide":false,"name":"HelpPrompt","value":""},{"isHide":false,"name":"style:background","value":"#e9e9eb"},{"isHide":false,"name":"classgroup","value":"bRadiusB"},{"container":"Window","isHide":false,"name":"Width","value":"100%"},{"container":"Window","isHide":false,"name":"Height","value":"100%"},{"container":"Window","isHide":false,"name":"style:top","value":"0"},{"container":"Window","isHide":false,"name":"style:left","value":"0"},{"isHide":false,"name":"IsShowRefresh","value":"false"},{"isHide":false,"name":"IsShowBackButton","value":"false"},{"isHide":false,"name":"modifyUrl","value":"\"\""}],"sort":0}
2020-04-24 20:55:30